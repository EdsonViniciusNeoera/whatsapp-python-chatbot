2025-10-05 17:31:33,021 - INFO - whatsapp_bot - WaSenderAPI client initialized successfully with retry support
2025-10-05 17:31:33,022 - INFO - whatsapp_bot - Gemini API client initialized successfully
2025-10-05 17:31:33,023 - WARNING - whatsapp_bot - Persona file not found at persona.json. Using default persona.
2025-10-05 17:31:33,023 - INFO - whatsapp_bot - Using persona 'Assistant'
2025-10-05 17:31:33,023 - INFO - whatsapp_bot - Gemini client initialized with model: gemini-2.0-flash
2025-10-05 17:31:33,025 - INFO - whatsapp_bot - ======================================================
2025-10-05 17:31:33,031 - INFO - whatsapp_bot -   WhatsApp Gemini Chatbot Starting
2025-10-05 17:31:33,031 - INFO - whatsapp_bot - ======================================================
2025-10-05 17:31:33,031 - INFO - whatsapp_bot - Persona: Assistant
2025-10-05 17:31:33,031 - INFO - whatsapp_bot - Gemini Model: gemini-2.0-flash
2025-10-05 17:31:33,032 - INFO - whatsapp_bot - Conversations Directory: conversations
2025-10-05 17:31:33,032 - INFO - whatsapp_bot - WaSender API Client: Initialized
2025-10-05 17:31:33,032 - INFO - whatsapp_bot - Gemini API Client: Initialized
2025-10-05 17:31:33,032 - INFO - whatsapp_bot - Starting Flask server on port 5001...
2025-10-05 17:31:33,032 - INFO - whatsapp_bot - ======================================================
2025-10-05 17:31:33,058 - INFO - werkzeug - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5001
 * Running on http://192.168.1.107:5001
2025-10-05 17:31:33,058 - INFO - werkzeug - [33mPress CTRL+C to quit[0m
2025-10-05 17:34:51,348 - ERROR - whatsapp_bot - Unhandled Exception: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
Traceback (most recent call last):
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 891, in dispatch_request
    self.raise_routing_exception(req)
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 500, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\werkzeug\routing\map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-10-05 17:34:51,449 - INFO - werkzeug - 127.0.0.1 - - [05/Oct/2025 17:34:51] "[35m[1mGET / HTTP/1.1[0m" 500 -
2025-10-05 17:34:51,542 - ERROR - whatsapp_bot - Unhandled Exception: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
Traceback (most recent call last):
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 891, in dispatch_request
    self.raise_routing_exception(req)
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 500, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\werkzeug\routing\map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-10-05 17:34:51,545 - INFO - werkzeug - 127.0.0.1 - - [05/Oct/2025 17:34:51] "[35m[1mGET /favicon.ico HTTP/1.1[0m" 500 -
2025-10-05 17:35:08,693 - ERROR - whatsapp_bot - Unhandled Exception: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
Traceback (most recent call last):
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 891, in dispatch_request
    self.raise_routing_exception(req)
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 500, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\werkzeug\routing\map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-10-05 17:35:08,699 - INFO - werkzeug - 192.168.1.107 - - [05/Oct/2025 17:35:08] "[35m[1mGET / HTTP/1.1[0m" 500 -
2025-10-05 17:35:08,826 - ERROR - whatsapp_bot - Unhandled Exception: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
Traceback (most recent call last):
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 891, in dispatch_request
    self.raise_routing_exception(req)
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 500, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\werkzeug\routing\map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-10-05 17:35:08,829 - INFO - werkzeug - 192.168.1.107 - - [05/Oct/2025 17:35:08] "[35m[1mGET /favicon.ico HTTP/1.1[0m" 500 -
2025-10-05 17:49:23,363 - INFO - whatsapp_bot - WaSenderAPI client initialized successfully with retry support
2025-10-05 17:49:23,363 - INFO - whatsapp_bot - Gemini API client initialized successfully
2025-10-05 17:49:23,364 - WARNING - whatsapp_bot - Persona file not found at persona.json. Using default persona.
2025-10-05 17:49:23,364 - INFO - whatsapp_bot - Using persona 'Assistant'
2025-10-05 17:49:23,365 - INFO - whatsapp_bot - Gemini client initialized with model: gemini-2.0-flash
2025-10-05 17:49:23,366 - INFO - whatsapp_bot - ======================================================
2025-10-05 17:49:23,366 - INFO - whatsapp_bot -   WhatsApp Gemini Chatbot Starting
2025-10-05 17:49:23,367 - INFO - whatsapp_bot - ======================================================
2025-10-05 17:49:23,367 - INFO - whatsapp_bot - Persona: Assistant
2025-10-05 17:49:23,367 - INFO - whatsapp_bot - Gemini Model: gemini-2.0-flash
2025-10-05 17:49:23,367 - INFO - whatsapp_bot - Conversations Directory: conversations
2025-10-05 17:49:23,367 - INFO - whatsapp_bot - WaSender API Client: Initialized
2025-10-05 17:49:23,367 - INFO - whatsapp_bot - Gemini API Client: Initialized
2025-10-05 17:49:23,368 - INFO - whatsapp_bot - Starting Flask server on port 5001...
2025-10-05 17:49:23,368 - INFO - whatsapp_bot - ======================================================
2025-10-05 17:49:23,382 - INFO - werkzeug - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5001
 * Running on http://192.168.1.107:5001
2025-10-05 17:49:23,383 - INFO - werkzeug - [33mPress CTRL+C to quit[0m
2025-10-05 17:49:31,495 - ERROR - whatsapp_bot - Unhandled Exception: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
Traceback (most recent call last):
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 891, in dispatch_request
    self.raise_routing_exception(req)
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 500, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\werkzeug\routing\map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-10-05 17:49:31,500 - INFO - werkzeug - 127.0.0.1 - - [05/Oct/2025 17:49:31] "[35m[1mGET / HTTP/1.1[0m" 500 -
2025-10-05 17:49:31,587 - ERROR - whatsapp_bot - Unhandled Exception: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
Traceback (most recent call last):
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 891, in dispatch_request
    self.raise_routing_exception(req)
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 500, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\werkzeug\routing\map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-10-05 17:49:31,590 - INFO - werkzeug - 127.0.0.1 - - [05/Oct/2025 17:49:31] "[35m[1mGET /favicon.ico HTTP/1.1[0m" 500 -
2025-10-05 17:51:16,810 - INFO - whatsapp_bot - WaSenderAPI client initialized successfully with retry support
2025-10-05 17:51:16,811 - INFO - whatsapp_bot - Gemini API client initialized successfully
2025-10-05 17:51:16,812 - WARNING - whatsapp_bot - Persona file not found at persona.json. Using default persona.
2025-10-05 17:51:16,813 - INFO - whatsapp_bot - Using persona 'Assistant'
2025-10-05 17:51:16,813 - INFO - whatsapp_bot - Gemini client initialized with model: gemini-2.0-flash
2025-10-05 17:51:16,814 - INFO - whatsapp_bot - ======================================================
2025-10-05 17:51:16,815 - INFO - whatsapp_bot -   WhatsApp Gemini Chatbot Starting
2025-10-05 17:51:16,815 - INFO - whatsapp_bot - ======================================================
2025-10-05 17:51:16,815 - INFO - whatsapp_bot - Persona: Assistant
2025-10-05 17:51:16,815 - INFO - whatsapp_bot - Gemini Model: gemini-2.0-flash
2025-10-05 17:51:16,815 - INFO - whatsapp_bot - Conversations Directory: conversations
2025-10-05 17:51:16,815 - INFO - whatsapp_bot - WaSender API Client: Initialized
2025-10-05 17:51:16,816 - INFO - whatsapp_bot - Gemini API Client: Initialized
2025-10-05 17:51:16,816 - INFO - whatsapp_bot - Starting Flask server on port 5001...
2025-10-05 17:51:16,816 - INFO - whatsapp_bot - ======================================================
2025-10-05 17:51:16,830 - INFO - werkzeug - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5001
 * Running on http://192.168.1.107:5001
2025-10-05 17:51:16,830 - INFO - werkzeug - [33mPress CTRL+C to quit[0m
2025-10-05 17:51:36,431 - INFO - werkzeug - 127.0.0.1 - - [05/Oct/2025 17:51:36] "GET / HTTP/1.1" 200 -
2025-10-05 17:51:36,510 - ERROR - whatsapp_bot - Unhandled Exception: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
Traceback (most recent call last):
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 891, in dispatch_request
    self.raise_routing_exception(req)
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 500, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\werkzeug\routing\map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-10-05 17:51:36,515 - INFO - werkzeug - 127.0.0.1 - - [05/Oct/2025 17:51:36] "[35m[1mGET /favicon.ico HTTP/1.1[0m" 500 -
2025-10-06 17:10:53,985 - INFO - whatsapp_bot - WaSenderAPI client initialized successfully with retry support
2025-10-06 17:10:53,986 - INFO - whatsapp_bot - Gemini API client initialized successfully
2025-10-06 17:10:53,987 - WARNING - whatsapp_bot - Persona file not found at persona.json. Using default persona.
2025-10-06 17:10:53,987 - INFO - whatsapp_bot - Using persona 'Assistant'
2025-10-06 17:10:53,987 - INFO - whatsapp_bot - Gemini client initialized with model: gemini-2.0-flash
2025-10-06 17:10:53,989 - INFO - whatsapp_bot - ======================================================
2025-10-06 17:10:53,989 - INFO - whatsapp_bot -   WhatsApp Gemini Chatbot Starting
2025-10-06 17:10:53,989 - INFO - whatsapp_bot - ======================================================
2025-10-06 17:10:53,990 - INFO - whatsapp_bot - Persona: Assistant
2025-10-06 17:10:53,990 - INFO - whatsapp_bot - Gemini Model: gemini-2.0-flash
2025-10-06 17:10:53,990 - INFO - whatsapp_bot - Conversations Directory: conversations
2025-10-06 17:10:53,990 - INFO - whatsapp_bot - WaSender API Client: Initialized
2025-10-06 17:10:53,990 - INFO - whatsapp_bot - Gemini API Client: Initialized
2025-10-06 17:10:53,990 - INFO - whatsapp_bot - Starting Flask server on port 5001...
2025-10-06 17:10:53,990 - INFO - whatsapp_bot - ======================================================
2025-10-06 17:10:54,023 - INFO - werkzeug - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5001
 * Running on http://192.168.1.107:5001
2025-10-06 17:10:54,024 - INFO - werkzeug - [33mPress CTRL+C to quit[0m
2025-10-06 17:14:46,300 - INFO - whatsapp_bot - WaSenderAPI client initialized successfully with retry support
2025-10-06 17:14:46,300 - INFO - whatsapp_bot - Gemini API client initialized successfully
2025-10-06 17:14:46,301 - WARNING - whatsapp_bot - Persona file not found at persona.json. Using default persona.
2025-10-06 17:14:46,301 - INFO - whatsapp_bot - Using persona 'Assistant'
2025-10-06 17:14:46,301 - INFO - whatsapp_bot - Gemini client initialized with model: gemini-2.0-flash
2025-10-06 17:14:46,303 - INFO - whatsapp_bot - ======================================================
2025-10-06 17:14:46,303 - INFO - whatsapp_bot -   WhatsApp Gemini Chatbot Starting
2025-10-06 17:14:46,303 - INFO - whatsapp_bot - ======================================================
2025-10-06 17:14:46,304 - INFO - whatsapp_bot - Persona: Assistant
2025-10-06 17:14:46,304 - INFO - whatsapp_bot - Gemini Model: gemini-2.0-flash
2025-10-06 17:14:46,304 - INFO - whatsapp_bot - Conversations Directory: conversations
2025-10-06 17:14:46,304 - INFO - whatsapp_bot - WaSender API Client: Initialized
2025-10-06 17:14:46,304 - INFO - whatsapp_bot - Gemini API Client: Initialized
2025-10-06 17:14:46,304 - INFO - whatsapp_bot - Starting Flask server on port 5001...
2025-10-06 17:14:46,304 - INFO - whatsapp_bot - ======================================================
2025-10-06 17:14:46,316 - INFO - werkzeug - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5001
 * Running on http://192.168.1.107:5001
2025-10-06 17:14:46,317 - INFO - werkzeug - [33mPress CTRL+C to quit[0m
2025-10-06 17:16:03,169 - ERROR - script - Exception on /webhook [POST]
Traceback (most recent call last):
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 920, in full_dispatch_request
    return self.finalize_request(rv)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 939, in finalize_request
    response = self.make_response(rv)
               ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 1212, in make_response
    raise TypeError(
TypeError: The view function for 'webhook' did not return a valid response. The function either returned None or ended without a return statement.
2025-10-06 17:16:03,194 - ERROR - whatsapp_bot - Unhandled Exception: 500 Internal Server Error: The server encountered an internal error and was unable to complete your request. Either the server is overloaded or there is an error in the application.
Traceback (most recent call last):
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 920, in full_dispatch_request
    return self.finalize_request(rv)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 939, in finalize_request
    response = self.make_response(rv)
               ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 1212, in make_response
    raise TypeError(
TypeError: The view function for 'webhook' did not return a valid response. The function either returned None or ended without a return statement.
2025-10-06 17:16:03,196 - INFO - werkzeug - 127.0.0.1 - - [06/Oct/2025 17:16:03] "[35m[1mPOST /webhook HTTP/1.1[0m" 500 -
2025-10-06 17:19:01,593 - ERROR - script - Exception on /webhook [POST]
Traceback (most recent call last):
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 920, in full_dispatch_request
    return self.finalize_request(rv)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 939, in finalize_request
    response = self.make_response(rv)
               ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 1212, in make_response
    raise TypeError(
TypeError: The view function for 'webhook' did not return a valid response. The function either returned None or ended without a return statement.
2025-10-06 17:19:01,594 - ERROR - whatsapp_bot - Unhandled Exception: 500 Internal Server Error: The server encountered an internal error and was unable to complete your request. Either the server is overloaded or there is an error in the application.
Traceback (most recent call last):
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 920, in full_dispatch_request
    return self.finalize_request(rv)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 939, in finalize_request
    response = self.make_response(rv)
               ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 1212, in make_response
    raise TypeError(
TypeError: The view function for 'webhook' did not return a valid response. The function either returned None or ended without a return statement.
2025-10-06 17:19:01,595 - INFO - werkzeug - 127.0.0.1 - - [06/Oct/2025 17:19:01] "[35m[1mPOST /webhook HTTP/1.1[0m" 500 -
2025-10-06 17:19:08,855 - ERROR - script - Exception on /webhook [POST]
Traceback (most recent call last):
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 920, in full_dispatch_request
    return self.finalize_request(rv)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 939, in finalize_request
    response = self.make_response(rv)
               ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 1212, in make_response
    raise TypeError(
TypeError: The view function for 'webhook' did not return a valid response. The function either returned None or ended without a return statement.
2025-10-06 17:19:08,857 - ERROR - whatsapp_bot - Unhandled Exception: 500 Internal Server Error: The server encountered an internal error and was unable to complete your request. Either the server is overloaded or there is an error in the application.
Traceback (most recent call last):
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 920, in full_dispatch_request
    return self.finalize_request(rv)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 939, in finalize_request
    response = self.make_response(rv)
               ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 1212, in make_response
    raise TypeError(
TypeError: The view function for 'webhook' did not return a valid response. The function either returned None or ended without a return statement.
2025-10-06 17:19:08,858 - INFO - werkzeug - 127.0.0.1 - - [06/Oct/2025 17:19:08] "[35m[1mPOST /webhook HTTP/1.1[0m" 500 -
2025-10-06 17:20:24,412 - ERROR - script - Exception on /webhook [POST]
Traceback (most recent call last):
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 920, in full_dispatch_request
    return self.finalize_request(rv)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 939, in finalize_request
    response = self.make_response(rv)
               ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 1212, in make_response
    raise TypeError(
TypeError: The view function for 'webhook' did not return a valid response. The function either returned None or ended without a return statement.
2025-10-06 17:20:24,414 - ERROR - whatsapp_bot - Unhandled Exception: 500 Internal Server Error: The server encountered an internal error and was unable to complete your request. Either the server is overloaded or there is an error in the application.
Traceback (most recent call last):
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 920, in full_dispatch_request
    return self.finalize_request(rv)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 939, in finalize_request
    response = self.make_response(rv)
               ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 1212, in make_response
    raise TypeError(
TypeError: The view function for 'webhook' did not return a valid response. The function either returned None or ended without a return statement.
2025-10-06 17:20:24,417 - INFO - werkzeug - 127.0.0.1 - - [06/Oct/2025 17:20:24] "[35m[1mPOST /webhook HTTP/1.1[0m" 500 -
2025-10-06 17:20:26,657 - ERROR - script - Exception on /webhook [POST]
Traceback (most recent call last):
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 920, in full_dispatch_request
    return self.finalize_request(rv)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 939, in finalize_request
    response = self.make_response(rv)
               ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 1212, in make_response
    raise TypeError(
TypeError: The view function for 'webhook' did not return a valid response. The function either returned None or ended without a return statement.
2025-10-06 17:20:26,659 - ERROR - whatsapp_bot - Unhandled Exception: 500 Internal Server Error: The server encountered an internal error and was unable to complete your request. Either the server is overloaded or there is an error in the application.
Traceback (most recent call last):
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 920, in full_dispatch_request
    return self.finalize_request(rv)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 939, in finalize_request
    response = self.make_response(rv)
               ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 1212, in make_response
    raise TypeError(
TypeError: The view function for 'webhook' did not return a valid response. The function either returned None or ended without a return statement.
2025-10-06 17:20:26,662 - INFO - werkzeug - 127.0.0.1 - - [06/Oct/2025 17:20:26] "[35m[1mPOST /webhook HTTP/1.1[0m" 500 -
2025-10-06 17:20:28,156 - ERROR - script - Exception on /webhook [POST]
Traceback (most recent call last):
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 920, in full_dispatch_request
    return self.finalize_request(rv)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 939, in finalize_request
    response = self.make_response(rv)
               ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 1212, in make_response
    raise TypeError(
TypeError: The view function for 'webhook' did not return a valid response. The function either returned None or ended without a return statement.
2025-10-06 17:20:28,158 - ERROR - whatsapp_bot - Unhandled Exception: 500 Internal Server Error: The server encountered an internal error and was unable to complete your request. Either the server is overloaded or there is an error in the application.
Traceback (most recent call last):
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 920, in full_dispatch_request
    return self.finalize_request(rv)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 939, in finalize_request
    response = self.make_response(rv)
               ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 1212, in make_response
    raise TypeError(
TypeError: The view function for 'webhook' did not return a valid response. The function either returned None or ended without a return statement.
2025-10-06 17:20:28,161 - INFO - werkzeug - 127.0.0.1 - - [06/Oct/2025 17:20:28] "[35m[1mPOST /webhook HTTP/1.1[0m" 500 -
2025-10-06 17:20:32,588 - ERROR - script - Exception on /webhook [POST]
Traceback (most recent call last):
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 920, in full_dispatch_request
    return self.finalize_request(rv)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 939, in finalize_request
    response = self.make_response(rv)
               ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 1212, in make_response
    raise TypeError(
TypeError: The view function for 'webhook' did not return a valid response. The function either returned None or ended without a return statement.
2025-10-06 17:20:32,591 - ERROR - whatsapp_bot - Unhandled Exception: 500 Internal Server Error: The server encountered an internal error and was unable to complete your request. Either the server is overloaded or there is an error in the application.
Traceback (most recent call last):
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 920, in full_dispatch_request
    return self.finalize_request(rv)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 939, in finalize_request
    response = self.make_response(rv)
               ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 1212, in make_response
    raise TypeError(
TypeError: The view function for 'webhook' did not return a valid response. The function either returned None or ended without a return statement.
2025-10-06 17:20:32,593 - INFO - werkzeug - 127.0.0.1 - - [06/Oct/2025 17:20:32] "[35m[1mPOST /webhook HTTP/1.1[0m" 500 -
2025-10-06 17:20:44,010 - ERROR - script - Exception on /webhook [POST]
Traceback (most recent call last):
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 920, in full_dispatch_request
    return self.finalize_request(rv)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 939, in finalize_request
    response = self.make_response(rv)
               ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 1212, in make_response
    raise TypeError(
TypeError: The view function for 'webhook' did not return a valid response. The function either returned None or ended without a return statement.
2025-10-06 17:20:44,012 - ERROR - whatsapp_bot - Unhandled Exception: 500 Internal Server Error: The server encountered an internal error and was unable to complete your request. Either the server is overloaded or there is an error in the application.
Traceback (most recent call last):
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 920, in full_dispatch_request
    return self.finalize_request(rv)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 939, in finalize_request
    response = self.make_response(rv)
               ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 1212, in make_response
    raise TypeError(
TypeError: The view function for 'webhook' did not return a valid response. The function either returned None or ended without a return statement.
2025-10-06 17:20:44,017 - INFO - werkzeug - 127.0.0.1 - - [06/Oct/2025 17:20:44] "[35m[1mPOST /webhook HTTP/1.1[0m" 500 -
2025-10-06 17:22:35,380 - ERROR - script - Exception on /webhook [POST]
Traceback (most recent call last):
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 920, in full_dispatch_request
    return self.finalize_request(rv)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 939, in finalize_request
    response = self.make_response(rv)
               ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 1212, in make_response
    raise TypeError(
TypeError: The view function for 'webhook' did not return a valid response. The function either returned None or ended without a return statement.
2025-10-06 17:22:35,382 - ERROR - whatsapp_bot - Unhandled Exception: 500 Internal Server Error: The server encountered an internal error and was unable to complete your request. Either the server is overloaded or there is an error in the application.
Traceback (most recent call last):
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 920, in full_dispatch_request
    return self.finalize_request(rv)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 939, in finalize_request
    response = self.make_response(rv)
               ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 1212, in make_response
    raise TypeError(
TypeError: The view function for 'webhook' did not return a valid response. The function either returned None or ended without a return statement.
2025-10-06 17:22:35,384 - INFO - werkzeug - 127.0.0.1 - - [06/Oct/2025 17:22:35] "[35m[1mPOST /webhook HTTP/1.1[0m" 500 -
2025-10-06 17:25:55,135 - INFO - whatsapp_bot - WaSenderAPI client initialized successfully with retry support
2025-10-06 17:25:55,136 - INFO - whatsapp_bot - Gemini API client initialized successfully
2025-10-06 17:25:55,137 - WARNING - whatsapp_bot - Persona file not found at persona.json. Using default persona.
2025-10-06 17:25:55,137 - INFO - whatsapp_bot - Using persona 'Assistant'
2025-10-06 17:25:55,138 - INFO - whatsapp_bot - Gemini client initialized with model: gemini-2.0-flash
2025-10-06 17:25:55,139 - INFO - whatsapp_bot - ======================================================
2025-10-06 17:25:55,140 - INFO - whatsapp_bot -   WhatsApp Gemini Chatbot Starting
2025-10-06 17:25:55,140 - INFO - whatsapp_bot - ======================================================
2025-10-06 17:25:55,140 - INFO - whatsapp_bot - Persona: Assistant
2025-10-06 17:25:55,140 - INFO - whatsapp_bot - Gemini Model: gemini-2.0-flash
2025-10-06 17:25:55,141 - INFO - whatsapp_bot - Conversations Directory: conversations
2025-10-06 17:25:55,141 - INFO - whatsapp_bot - WaSender API Client: Initialized
2025-10-06 17:25:55,141 - INFO - whatsapp_bot - Gemini API Client: Initialized
2025-10-06 17:25:55,141 - INFO - whatsapp_bot - Starting Flask server on port 5001...
2025-10-06 17:25:55,141 - INFO - whatsapp_bot - ======================================================
2025-10-06 17:25:55,157 - INFO - werkzeug - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5001
 * Running on http://192.168.1.107:5001
2025-10-06 17:25:55,158 - INFO - werkzeug - [33mPress CTRL+C to quit[0m
2025-10-06 17:28:26,523 - INFO - whatsapp_bot - WaSenderAPI client initialized successfully with retry support
2025-10-06 17:28:26,524 - INFO - whatsapp_bot - Gemini API client initialized successfully
2025-10-06 17:28:26,525 - WARNING - whatsapp_bot - Persona file not found at persona.json. Using default persona.
2025-10-06 17:28:26,526 - INFO - whatsapp_bot - Using persona 'Assistant'
2025-10-06 17:28:26,526 - INFO - whatsapp_bot - Gemini client initialized with model: gemini-2.0-flash
2025-10-06 17:28:26,528 - INFO - whatsapp_bot - ======================================================
2025-10-06 17:28:26,528 - INFO - whatsapp_bot -   WhatsApp Gemini Chatbot Starting
2025-10-06 17:28:26,529 - INFO - whatsapp_bot - ======================================================
2025-10-06 17:28:26,530 - INFO - whatsapp_bot - Persona: Assistant
2025-10-06 17:28:26,530 - INFO - whatsapp_bot - Gemini Model: gemini-2.0-flash
2025-10-06 17:28:26,530 - INFO - whatsapp_bot - Conversations Directory: conversations
2025-10-06 17:28:26,530 - INFO - whatsapp_bot - WaSender API Client: Initialized
2025-10-06 17:28:26,530 - INFO - whatsapp_bot - Gemini API Client: Initialized
2025-10-06 17:28:26,530 - INFO - whatsapp_bot - Starting Flask server on port 5001...
2025-10-06 17:28:26,530 - INFO - whatsapp_bot - ======================================================
2025-10-06 17:28:26,544 - INFO - werkzeug - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5001
 * Running on http://192.168.1.107:5001
2025-10-06 17:28:26,544 - INFO - werkzeug - [33mPress CTRL+C to quit[0m
2025-10-06 17:30:05,487 - INFO - whatsapp_bot - WaSenderAPI client initialized successfully with retry support
2025-10-06 17:30:05,487 - INFO - whatsapp_bot - Gemini API client initialized successfully
2025-10-06 17:30:05,489 - WARNING - whatsapp_bot - Persona file not found at persona.json. Using default persona.
2025-10-06 17:30:05,489 - INFO - whatsapp_bot - Using persona 'Assistant'
2025-10-06 17:30:05,489 - INFO - whatsapp_bot - Gemini client initialized with model: gemini-2.0-flash
2025-10-06 17:30:05,491 - INFO - whatsapp_bot - ======================================================
2025-10-06 17:30:05,491 - INFO - whatsapp_bot -   WhatsApp Gemini Chatbot Starting
2025-10-06 17:30:05,491 - INFO - whatsapp_bot - ======================================================
2025-10-06 17:30:05,491 - INFO - whatsapp_bot - Persona: Assistant
2025-10-06 17:30:05,492 - INFO - whatsapp_bot - Gemini Model: gemini-2.0-flash
2025-10-06 17:30:05,492 - INFO - whatsapp_bot - Conversations Directory: conversations
2025-10-06 17:30:05,492 - INFO - whatsapp_bot - WaSender API Client: Initialized
2025-10-06 17:30:05,492 - INFO - whatsapp_bot - Gemini API Client: Initialized
2025-10-06 17:30:05,492 - INFO - whatsapp_bot - Starting Flask server on port 5001...
2025-10-06 17:30:05,493 - INFO - whatsapp_bot - ======================================================
2025-10-06 17:30:05,511 - INFO - werkzeug - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5001
 * Running on http://192.168.1.107:5001
2025-10-06 17:30:05,511 - INFO - werkzeug - [33mPress CTRL+C to quit[0m
2025-10-06 17:30:54,454 - INFO - werkzeug - 127.0.0.1 - - [06/Oct/2025 17:30:54] "GET / HTTP/1.1" 200 -
2025-10-06 17:30:54,587 - ERROR - whatsapp_bot - Unhandled Exception: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
Traceback (most recent call last):
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 891, in dispatch_request
    self.raise_routing_exception(req)
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\app.py", line 500, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Edson Vinicius\AppData\Local\Programs\Python\Python312\Lib\site-packages\werkzeug\routing\map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-10-06 17:30:54,667 - INFO - werkzeug - 127.0.0.1 - - [06/Oct/2025 17:30:54] "[35m[1mGET /favicon.ico HTTP/1.1[0m" 500 -
2025-10-06 17:52:33,870 - INFO - whatsapp_bot - WaSenderAPI client initialized successfully with retry support
2025-10-06 17:52:33,871 - INFO - whatsapp_bot - Gemini API client initialized successfully
2025-10-06 17:52:33,872 - WARNING - whatsapp_bot - Persona file not found at persona.json. Using default persona.
2025-10-06 17:52:33,872 - INFO - whatsapp_bot - Using persona 'Assistant'
2025-10-06 17:52:33,872 - INFO - whatsapp_bot - Gemini client initialized with model: gemini-2.0-flash
2025-10-06 17:52:33,874 - INFO - whatsapp_bot - ======================================================
2025-10-06 17:52:33,874 - INFO - whatsapp_bot -   WhatsApp Gemini Chatbot Starting
2025-10-06 17:52:33,874 - INFO - whatsapp_bot - ======================================================
2025-10-06 17:52:33,875 - INFO - whatsapp_bot - Persona: Assistant
2025-10-06 17:52:33,875 - INFO - whatsapp_bot - Gemini Model: gemini-2.0-flash
2025-10-06 17:52:33,875 - INFO - whatsapp_bot - Conversations Directory: conversations
2025-10-06 17:52:33,875 - INFO - whatsapp_bot - WaSender API Client: Initialized
2025-10-06 17:52:33,875 - INFO - whatsapp_bot - Gemini API Client: Initialized
2025-10-06 17:52:33,875 - INFO - whatsapp_bot - Starting Flask server on port 5001...
2025-10-06 17:52:33,876 - INFO - whatsapp_bot - ======================================================
2025-10-06 17:52:33,888 - INFO - werkzeug - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5001
 * Running on http://192.168.1.107:5001
2025-10-06 17:52:33,889 - INFO - werkzeug - [33mPress CTRL+C to quit[0m
2025-10-06 17:53:16,163 - INFO - whatsapp_bot - WaSenderAPI client initialized successfully with retry support
2025-10-06 17:53:16,163 - INFO - whatsapp_bot - Gemini API client initialized successfully
2025-10-06 17:53:16,165 - WARNING - whatsapp_bot - Persona file not found at persona.json. Using default persona.
2025-10-06 17:53:16,165 - INFO - whatsapp_bot - Using persona 'Assistant'
2025-10-06 17:53:16,165 - INFO - whatsapp_bot - Gemini client initialized with model: gemini-2.0-flash
2025-10-06 17:53:16,167 - INFO - whatsapp_bot - ======================================================
2025-10-06 17:53:16,167 - INFO - whatsapp_bot -   WhatsApp Gemini Chatbot Starting
2025-10-06 17:53:16,167 - INFO - whatsapp_bot - ======================================================
2025-10-06 17:53:16,168 - INFO - whatsapp_bot - Persona: Assistant
2025-10-06 17:53:16,168 - INFO - whatsapp_bot - Gemini Model: gemini-2.0-flash
2025-10-06 17:53:16,168 - INFO - whatsapp_bot - Conversations Directory: conversations
2025-10-06 17:53:16,168 - INFO - whatsapp_bot - WaSender API Client: Initialized
2025-10-06 17:53:16,168 - INFO - whatsapp_bot - Gemini API Client: Initialized
2025-10-06 17:53:16,168 - INFO - whatsapp_bot - Starting Flask server on port 5001...
2025-10-06 17:53:16,168 - INFO - whatsapp_bot - ======================================================
2025-10-06 17:53:16,181 - INFO - werkzeug - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5001
 * Running on http://192.168.1.107:5001
2025-10-06 17:53:16,181 - INFO - werkzeug - [33mPress CTRL+C to quit[0m
2025-10-06 17:53:41,274 - INFO - werkzeug - 127.0.0.1 - - [06/Oct/2025 17:53:41] "POST /webhook HTTP/1.1" 200 -
2025-10-06 17:54:55,950 - INFO - werkzeug - 127.0.0.1 - - [06/Oct/2025 17:54:55] "POST /webhook HTTP/1.1" 200 -
2025-10-06 17:58:22,344 - INFO - whatsapp_bot - WaSenderAPI client initialized successfully with retry support
2025-10-06 17:58:22,345 - INFO - whatsapp_bot - Gemini API client initialized successfully
2025-10-06 17:58:22,347 - WARNING - whatsapp_bot - Persona file not found at persona.json. Using default persona.
2025-10-06 17:58:22,347 - INFO - whatsapp_bot - Using persona 'Assistant'
2025-10-06 17:58:22,348 - INFO - whatsapp_bot - Gemini client initialized with model: gemini-2.0-flash
2025-10-06 17:58:22,350 - INFO - whatsapp_bot - ======================================================
2025-10-06 17:58:22,350 - INFO - whatsapp_bot -   WhatsApp Gemini Chatbot Starting
2025-10-06 17:58:22,350 - INFO - whatsapp_bot - ======================================================
2025-10-06 17:58:22,351 - INFO - whatsapp_bot - Persona: Assistant
2025-10-06 17:58:22,351 - INFO - whatsapp_bot - Gemini Model: gemini-2.0-flash
2025-10-06 17:58:22,351 - INFO - whatsapp_bot - Conversations Directory: conversations
2025-10-06 17:58:22,351 - INFO - whatsapp_bot - WaSender API Client: Initialized
2025-10-06 17:58:22,351 - INFO - whatsapp_bot - Gemini API Client: Initialized
2025-10-06 17:58:22,351 - INFO - whatsapp_bot - Starting Flask server on port 5001...
2025-10-06 17:58:22,352 - INFO - whatsapp_bot - ======================================================
2025-10-06 17:58:22,374 - INFO - werkzeug - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5001
 * Running on http://192.168.1.107:5001
2025-10-06 17:58:22,375 - INFO - werkzeug - [33mPress CTRL+C to quit[0m
2025-10-06 18:29:43,285 - INFO - whatsapp_bot - WaSenderAPI client initialized successfully with retry support
2025-10-06 18:29:43,286 - INFO - whatsapp_bot - Gemini API client initialized successfully
2025-10-06 18:29:43,288 - WARNING - whatsapp_bot - Persona file not found at persona.json. Using default persona.
2025-10-06 18:29:43,288 - INFO - whatsapp_bot - Using persona 'Assistant'
2025-10-06 18:29:43,288 - INFO - whatsapp_bot - Gemini client initialized with model: gemini-2.0-flash
2025-10-06 18:29:43,290 - INFO - whatsapp_bot - ======================================================
2025-10-06 18:29:43,290 - INFO - whatsapp_bot -   WhatsApp Gemini Chatbot Starting
2025-10-06 18:29:43,290 - INFO - whatsapp_bot - ======================================================
2025-10-06 18:29:43,291 - INFO - whatsapp_bot - Persona: Assistant
2025-10-06 18:29:43,291 - INFO - whatsapp_bot - Gemini Model: gemini-2.0-flash
2025-10-06 18:29:43,291 - INFO - whatsapp_bot - Conversations Directory: conversations
2025-10-06 18:29:43,291 - INFO - whatsapp_bot - WaSender API Client: Initialized
2025-10-06 18:29:43,291 - INFO - whatsapp_bot - Gemini API Client: Initialized
2025-10-06 18:29:43,291 - INFO - whatsapp_bot - Starting Flask server on port 5001...
2025-10-06 18:29:43,292 - INFO - whatsapp_bot - ======================================================
2025-10-06 18:29:43,326 - INFO - werkzeug - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5001
 * Running on http://192.168.1.107:5001
2025-10-06 18:29:43,327 - INFO - werkzeug - [33mPress CTRL+C to quit[0m
2025-10-06 18:36:04,077 - INFO - whatsapp_bot - WaSenderAPI client initialized successfully with retry support
2025-10-06 18:36:04,078 - INFO - whatsapp_bot - Gemini API client initialized successfully
2025-10-06 18:36:04,080 - WARNING - whatsapp_bot - Persona file not found at persona.json. Using default persona.
2025-10-06 18:36:04,080 - INFO - whatsapp_bot - Using persona 'Assistant'
2025-10-06 18:36:04,080 - INFO - whatsapp_bot - Gemini client initialized with model: gemini-2.0-flash
2025-10-06 18:36:04,082 - INFO - whatsapp_bot - ======================================================
2025-10-06 18:36:04,082 - INFO - whatsapp_bot -   WhatsApp Gemini Chatbot Starting
2025-10-06 18:36:04,083 - INFO - whatsapp_bot - ======================================================
2025-10-06 18:36:04,083 - INFO - whatsapp_bot - Persona: Assistant
2025-10-06 18:36:04,083 - INFO - whatsapp_bot - Gemini Model: gemini-2.0-flash
2025-10-06 18:36:04,083 - INFO - whatsapp_bot - Conversations Directory: conversations
2025-10-06 18:36:04,083 - INFO - whatsapp_bot - WaSender API Client: Initialized
2025-10-06 18:36:04,083 - INFO - whatsapp_bot - Gemini API Client: Initialized
2025-10-06 18:36:04,083 - INFO - whatsapp_bot - Starting Flask server on port 5001...
2025-10-06 18:36:04,084 - INFO - whatsapp_bot - ======================================================
2025-10-06 18:36:04,098 - INFO - werkzeug - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5001
 * Running on http://192.168.1.107:5001
2025-10-06 18:36:04,098 - INFO - werkzeug - [33mPress CTRL+C to quit[0m
2025-10-06 18:36:12,590 - INFO - whatsapp_bot - WaSenderAPI client initialized successfully with retry support
2025-10-06 18:36:12,591 - INFO - whatsapp_bot - Gemini API client initialized successfully
2025-10-06 18:36:12,592 - WARNING - whatsapp_bot - Persona file not found at persona.json. Using default persona.
2025-10-06 18:36:12,593 - INFO - whatsapp_bot - Using persona 'Assistant'
2025-10-06 18:36:12,593 - INFO - whatsapp_bot - Gemini client initialized with model: gemini-2.0-flash
2025-10-06 18:36:12,595 - INFO - whatsapp_bot - ======================================================
2025-10-06 18:36:12,595 - INFO - whatsapp_bot -   WhatsApp Gemini Chatbot Starting
2025-10-06 18:36:12,596 - INFO - whatsapp_bot - ======================================================
2025-10-06 18:36:12,596 - INFO - whatsapp_bot - Persona: Assistant
2025-10-06 18:36:12,596 - INFO - whatsapp_bot - Gemini Model: gemini-2.0-flash
2025-10-06 18:36:12,597 - INFO - whatsapp_bot - Conversations Directory: conversations
2025-10-06 18:36:12,597 - INFO - whatsapp_bot - WaSender API Client: Initialized
2025-10-06 18:36:12,597 - INFO - whatsapp_bot - Gemini API Client: Initialized
2025-10-06 18:36:12,598 - INFO - whatsapp_bot - Starting Flask server on port 5001...
2025-10-06 18:36:12,598 - INFO - whatsapp_bot - ======================================================
2025-10-06 18:36:12,616 - INFO - werkzeug - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5001
 * Running on http://192.168.1.107:5001
2025-10-06 18:36:12,617 - INFO - werkzeug - [33mPress CTRL+C to quit[0m
2025-10-06 18:36:30,717 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-06 18:36:30,718 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': 'ec60833c987a921f4d33f360968db1f7a7f79bd15b2b82c3904f62d52642fc07', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': '3EB03FBFFAC15668B14BE9', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1759786590, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'extendedTextMessage': {'text': 's', 'contextInfo': {'ephemeralSettingTimestamp': '1759696911', 'disappearingMode': {'initiator': 'CHANGED_IN_CHAT', 'trigger': 'CHAT_SETTING', 'initiatedByMe': False}}, 'inviteLinkGroupTypeV2': 'DEFAULT'}, 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '7yydDzR4QCXTVg==', 'senderTimestamp': '1759693137', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': '/DoA8ECtFAcnNg==', 'recipientTimestamp': '1759694939'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'dnma5/3kUPQJ3KgvujX71bN4bujwpHSgEQZueq7q0C8=', 'limitSharingV2': {'trigger': 'UNKNOWN', 'initiatedByMe': False}}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB03FBFFAC15668B14BE9'}}, 'timestamp': 1759786590528}
2025-10-06 18:36:30,719 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-06 18:36:30,719 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-06 18:36:30,720 - INFO - werkzeug - 127.0.0.1 - - [06/Oct/2025 18:36:30] "POST /webhook HTTP/1.1" 200 -
2025-10-06 18:36:33,182 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-06 18:36:33,183 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': 'ec60833c987a921f4d33f360968db1f7a7f79bd15b2b82c3904f62d52642fc07', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': '3EB072E8B16268938A8D79', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1759786593, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'extendedTextMessage': {'text': 'hello', 'contextInfo': {'ephemeralSettingTimestamp': '1759696911', 'disappearingMode': {'initiator': 'CHANGED_IN_CHAT', 'trigger': 'CHAT_SETTING', 'initiatedByMe': False}}, 'inviteLinkGroupTypeV2': 'DEFAULT'}, 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '7yydDzR4QCXTVg==', 'senderTimestamp': '1759693137', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': '/DoA8ECtFAcnNg==', 'recipientTimestamp': '1759694939'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'CW4mVKBf8lA94usDLc3tuSw0UKD74qeM/aLQm+HWjS0=', 'limitSharingV2': {'trigger': 'UNKNOWN', 'initiatedByMe': False}}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB072E8B16268938A8D79'}}, 'timestamp': 1759786593086}
2025-10-06 18:36:33,184 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-06 18:36:33,185 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-06 18:36:33,185 - INFO - werkzeug - 127.0.0.1 - - [06/Oct/2025 18:36:33] "POST /webhook HTTP/1.1" 200 -
2025-10-06 18:53:06,257 - INFO - whatsapp_bot - WaSenderAPI client initialized successfully with retry support
2025-10-06 18:53:06,257 - INFO - whatsapp_bot - Gemini API client initialized successfully
2025-10-06 18:53:06,258 - WARNING - whatsapp_bot - Persona file not found at persona.json. Using default persona.
2025-10-06 18:53:06,258 - INFO - whatsapp_bot - Using persona 'Assistant'
2025-10-06 18:53:06,259 - INFO - whatsapp_bot - Gemini client initialized with model: gemini-2.0-flash
2025-10-06 18:53:06,260 - INFO - whatsapp_bot - ======================================================
2025-10-06 18:53:06,261 - INFO - whatsapp_bot -   WhatsApp Gemini Chatbot Starting
2025-10-06 18:53:06,261 - INFO - whatsapp_bot - ======================================================
2025-10-06 18:53:06,261 - INFO - whatsapp_bot - Persona: Assistant
2025-10-06 18:53:06,261 - INFO - whatsapp_bot - Gemini Model: gemini-2.0-flash
2025-10-06 18:53:06,261 - INFO - whatsapp_bot - Conversations Directory: conversations
2025-10-06 18:53:06,262 - INFO - whatsapp_bot - WaSender API Client: Initialized
2025-10-06 18:53:06,262 - INFO - whatsapp_bot - Gemini API Client: Initialized
2025-10-06 18:53:06,262 - INFO - whatsapp_bot - Starting Flask server on port 5001...
2025-10-06 18:53:06,262 - INFO - whatsapp_bot - ======================================================
2025-10-06 18:53:06,274 - INFO - werkzeug - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5001
 * Running on http://192.168.1.107:5001
2025-10-06 18:53:06,275 - INFO - werkzeug - [33mPress CTRL+C to quit[0m
2025-10-06 18:53:19,910 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-06 18:53:19,910 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': 'ec60833c987a921f4d33f360968db1f7a7f79bd15b2b82c3904f62d52642fc07', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': '3EB0CD51D53BE05CE49B71', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1759787599, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'extendedTextMessage': {'text': 'hello', 'contextInfo': {'ephemeralSettingTimestamp': '1759696911', 'disappearingMode': {'initiator': 'CHANGED_IN_CHAT', 'trigger': 'CHAT_SETTING', 'initiatedByMe': False}}, 'inviteLinkGroupTypeV2': 'DEFAULT'}, 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '7yydDzR4QCXTVg==', 'senderTimestamp': '1759693137', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': '/DoA8ECtFAcnNg==', 'recipientTimestamp': '1759694939'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'rBdk2f2MK7fIEe7TzF005RC/yC3vUFsMMuzPy4vrY5w=', 'limitSharingV2': {'trigger': 'UNKNOWN', 'initiatedByMe': False}}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB0CD51D53BE05CE49B71'}}, 'timestamp': 1759787599747}
2025-10-06 18:53:19,911 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-06 18:53:19,911 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-06 18:53:19,911 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': 'ec60833c987a921f4d33f360968db1f7a7f79bd15b2b82c3904f62d52642fc07', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': '3EB0CD51D53BE05CE49B71', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1759787599, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'extendedTextMessage': {'text': 'hello', 'contextInfo': {'ephemeralSettingTimestamp': '1759696911', 'disappearingMode': {'initiator': 'CHANGED_IN_CHAT', 'trigger': 'CHAT_SETTING', 'initiatedByMe': False}}, 'inviteLinkGroupTypeV2': 'DEFAULT'}, 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '7yydDzR4QCXTVg==', 'senderTimestamp': '1759693137', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': '/DoA8ECtFAcnNg==', 'recipientTimestamp': '1759694939'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'rBdk2f2MK7fIEe7TzF005RC/yC3vUFsMMuzPy4vrY5w=', 'limitSharingV2': {'trigger': 'UNKNOWN', 'initiatedByMe': False}}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB0CD51D53BE05CE49B71'}}, 'timestamp': 1759787599750}
2025-10-06 18:53:19,911 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-06 18:53:19,911 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': '3EB0CD51D53BE05CE49B71', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1759787599, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'extendedTextMessage': {'text': 'hello', 'contextInfo': {'ephemeralSettingTimestamp': '1759696911', 'disappearingMode': {'initiator': 'CHANGED_IN_CHAT', 'trigger': 'CHAT_SETTING', 'initiatedByMe': False}}, 'inviteLinkGroupTypeV2': 'DEFAULT'}, 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '7yydDzR4QCXTVg==', 'senderTimestamp': '1759693137', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': '/DoA8ECtFAcnNg==', 'recipientTimestamp': '1759694939'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'rBdk2f2MK7fIEe7TzF005RC/yC3vUFsMMuzPy4vrY5w=', 'limitSharingV2': {'trigger': 'UNKNOWN', 'initiatedByMe': False}}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB0CD51D53BE05CE49B71'}
2025-10-06 18:53:19,912 - INFO - werkzeug - 127.0.0.1 - - [06/Oct/2025 18:53:19] "POST /webhook HTTP/1.1" 200 -
2025-10-06 18:53:19,913 - INFO - whatsapp_bot - Sender number: 558186732159@s.whatsapp.net
2025-10-06 18:53:19,913 - INFO - whatsapp_bot - Message content object: {'extendedTextMessage': {'text': 'hello', 'contextInfo': {'ephemeralSettingTimestamp': '1759696911', 'disappearingMode': {'initiator': 'CHANGED_IN_CHAT', 'trigger': 'CHAT_SETTING', 'initiatedByMe': False}}, 'inviteLinkGroupTypeV2': 'DEFAULT'}, 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '7yydDzR4QCXTVg==', 'senderTimestamp': '1759693137', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': '/DoA8ECtFAcnNg==', 'recipientTimestamp': '1759694939'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'rBdk2f2MK7fIEe7TzF005RC/yC3vUFsMMuzPy4vrY5w=', 'limitSharingV2': {'trigger': 'UNKNOWN', 'initiatedByMe': False}}}
2025-10-06 18:53:19,914 - INFO - whatsapp_bot - Found extended text: hello
2025-10-06 18:53:19,914 - INFO - whatsapp_bot - Safe sender ID: 558186732159_s_whatsapp_net
2025-10-06 18:53:19,914 - INFO - whatsapp_bot - Processing text message: 'hello' from 558186732159@s.whatsapp.net
2025-10-06 18:53:19,914 - INFO - whatsapp_bot - Loaded conversation history for 558186732159_s_whatsapp_net
2025-10-06 18:53:19,915 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): hello...
2025-10-06 18:53:21,767 - INFO - whatsapp_bot - Sending 1 message chunks to 558186732159@s.whatsapp.net
2025-10-06 18:53:23,151 - INFO - whatsapp_bot - Text message sent to 558186732159@s.whatsapp.net.
2025-10-06 18:53:23,151 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558186732159@s.whatsapp.net
2025-10-06 18:53:23,153 - INFO - whatsapp_bot - Saved conversation history for 558186732159_s_whatsapp_net
2025-10-06 18:53:23,153 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-06 18:53:23,154 - INFO - werkzeug - 127.0.0.1 - - [06/Oct/2025 18:53:23] "POST /webhook HTTP/1.1" 200 -
2025-10-06 18:53:25,537 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-06 18:53:25,543 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-06 18:53:25,544 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-06 18:53:25,544 - INFO - werkzeug - 127.0.0.1 - - [06/Oct/2025 18:53:25] "POST /webhook HTTP/1.1" 200 -
2025-10-06 18:53:25,820 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-06 18:53:25,831 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB016680A9C2EA960C62D
2025-10-06 18:53:25,832 - INFO - werkzeug - 127.0.0.1 - - [06/Oct/2025 18:53:25] "POST /webhook HTTP/1.1" 200 -
2025-10-06 18:53:43,130 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-06 18:53:43,131 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': 'ec60833c987a921f4d33f360968db1f7a7f79bd15b2b82c3904f62d52642fc07', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': '3EB081736F00789D122D65', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1759787622, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'extendedTextMessage': {'text': 'hello', 'contextInfo': {'ephemeralSettingTimestamp': '1759696911', 'disappearingMode': {'initiator': 'CHANGED_IN_CHAT', 'trigger': 'CHAT_SETTING', 'initiatedByMe': False}}, 'inviteLinkGroupTypeV2': 'DEFAULT'}, 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '7yydDzR4QCXTVg==', 'senderTimestamp': '1759693137', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': '/DoA8ECtFAcnNg==', 'recipientTimestamp': '1759694939'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'cVzfVeWRy0XE60okxX27CXyLyCyRV3uIf5tbQ/nsURU=', 'limitSharingV2': {'trigger': 'UNKNOWN', 'initiatedByMe': False}}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB081736F00789D122D65'}}, 'timestamp': 1759787623008}
2025-10-06 18:53:43,131 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-06 18:53:43,132 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-06 18:53:43,132 - INFO - werkzeug - 127.0.0.1 - - [06/Oct/2025 18:53:43] "POST /webhook HTTP/1.1" 200 -
2025-10-06 18:53:43,174 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-06 18:53:43,176 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': 'ec60833c987a921f4d33f360968db1f7a7f79bd15b2b82c3904f62d52642fc07', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': '3EB081736F00789D122D65', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1759787622, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'extendedTextMessage': {'text': 'hello', 'contextInfo': {'ephemeralSettingTimestamp': '1759696911', 'disappearingMode': {'initiator': 'CHANGED_IN_CHAT', 'trigger': 'CHAT_SETTING', 'initiatedByMe': False}}, 'inviteLinkGroupTypeV2': 'DEFAULT'}, 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '7yydDzR4QCXTVg==', 'senderTimestamp': '1759693137', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': '/DoA8ECtFAcnNg==', 'recipientTimestamp': '1759694939'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'cVzfVeWRy0XE60okxX27CXyLyCyRV3uIf5tbQ/nsURU=', 'limitSharingV2': {'trigger': 'UNKNOWN', 'initiatedByMe': False}}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB081736F00789D122D65'}}, 'timestamp': 1759787623010}
2025-10-06 18:53:43,177 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': '3EB081736F00789D122D65', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1759787622, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'extendedTextMessage': {'text': 'hello', 'contextInfo': {'ephemeralSettingTimestamp': '1759696911', 'disappearingMode': {'initiator': 'CHANGED_IN_CHAT', 'trigger': 'CHAT_SETTING', 'initiatedByMe': False}}, 'inviteLinkGroupTypeV2': 'DEFAULT'}, 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '7yydDzR4QCXTVg==', 'senderTimestamp': '1759693137', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': '/DoA8ECtFAcnNg==', 'recipientTimestamp': '1759694939'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'cVzfVeWRy0XE60okxX27CXyLyCyRV3uIf5tbQ/nsURU=', 'limitSharingV2': {'trigger': 'UNKNOWN', 'initiatedByMe': False}}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB081736F00789D122D65'}
2025-10-06 18:53:43,177 - INFO - whatsapp_bot - Sender number: 558186732159@s.whatsapp.net
2025-10-06 18:53:43,178 - INFO - whatsapp_bot - Message content object: {'extendedTextMessage': {'text': 'hello', 'contextInfo': {'ephemeralSettingTimestamp': '1759696911', 'disappearingMode': {'initiator': 'CHANGED_IN_CHAT', 'trigger': 'CHAT_SETTING', 'initiatedByMe': False}}, 'inviteLinkGroupTypeV2': 'DEFAULT'}, 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '7yydDzR4QCXTVg==', 'senderTimestamp': '1759693137', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': '/DoA8ECtFAcnNg==', 'recipientTimestamp': '1759694939'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'cVzfVeWRy0XE60okxX27CXyLyCyRV3uIf5tbQ/nsURU=', 'limitSharingV2': {'trigger': 'UNKNOWN', 'initiatedByMe': False}}}
2025-10-06 18:53:43,178 - INFO - whatsapp_bot - Found extended text: hello
2025-10-06 18:53:43,178 - INFO - whatsapp_bot - Safe sender ID: 558186732159_s_whatsapp_net
2025-10-06 18:53:43,179 - INFO - whatsapp_bot - Processing text message: 'hello' from 558186732159@s.whatsapp.net
2025-10-06 18:53:43,191 - INFO - whatsapp_bot - Loaded conversation history for 558186732159_s_whatsapp_net
2025-10-06 18:53:43,191 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): hello...
2025-10-06 18:53:43,845 - INFO - whatsapp_bot - Sending 1 message chunks to 558186732159@s.whatsapp.net
2025-10-06 18:54:23,311 - INFO - whatsapp_bot - Text message sent to 558186732159@s.whatsapp.net.
2025-10-06 18:54:23,312 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558186732159@s.whatsapp.net
2025-10-06 18:54:23,313 - INFO - whatsapp_bot - Saved conversation history for 558186732159_s_whatsapp_net
2025-10-06 18:54:23,313 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-06 18:54:23,314 - INFO - werkzeug - 127.0.0.1 - - [06/Oct/2025 18:54:23] "POST /webhook HTTP/1.1" 200 -
2025-10-06 18:54:24,608 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-06 18:54:24,613 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-06 18:54:24,613 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-06 18:54:24,614 - INFO - werkzeug - 127.0.0.1 - - [06/Oct/2025 18:54:24] "POST /webhook HTTP/1.1" 200 -
2025-10-06 18:54:24,853 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-06 18:54:24,864 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB0A2B29EFBE682BC0FF4
2025-10-06 18:54:24,865 - INFO - werkzeug - 127.0.0.1 - - [06/Oct/2025 18:54:24] "POST /webhook HTTP/1.1" 200 -
2025-10-06 18:54:59,217 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-06 18:54:59,218 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': 'ec60833c987a921f4d33f360968db1f7a7f79bd15b2b82c3904f62d52642fc07', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': '3EB0CD0BFF68365FB4B6FC', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1759787698, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'extendedTextMessage': {'text': 'hello, how are you?', 'contextInfo': {'ephemeralSettingTimestamp': '1759696911', 'disappearingMode': {'initiator': 'CHANGED_IN_CHAT', 'trigger': 'CHAT_SETTING', 'initiatedByMe': False}}, 'inviteLinkGroupTypeV2': 'DEFAULT'}, 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '7yydDzR4QCXTVg==', 'senderTimestamp': '1759693137', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': '/DoA8ECtFAcnNg==', 'recipientTimestamp': '1759694939'}, 'deviceListMetadataVersion': 2, 'messageSecret': '6QTuo4I/E7b42ZFrq2yVRVFxQQpx/aD584iRNq0wwok=', 'limitSharingV2': {'trigger': 'UNKNOWN', 'initiatedByMe': False}}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB0CD0BFF68365FB4B6FC'}}, 'timestamp': 1759787699086}
2025-10-06 18:54:59,218 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-06 18:54:59,219 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': '3EB0CD0BFF68365FB4B6FC', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1759787698, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'extendedTextMessage': {'text': 'hello, how are you?', 'contextInfo': {'ephemeralSettingTimestamp': '1759696911', 'disappearingMode': {'initiator': 'CHANGED_IN_CHAT', 'trigger': 'CHAT_SETTING', 'initiatedByMe': False}}, 'inviteLinkGroupTypeV2': 'DEFAULT'}, 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '7yydDzR4QCXTVg==', 'senderTimestamp': '1759693137', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': '/DoA8ECtFAcnNg==', 'recipientTimestamp': '1759694939'}, 'deviceListMetadataVersion': 2, 'messageSecret': '6QTuo4I/E7b42ZFrq2yVRVFxQQpx/aD584iRNq0wwok=', 'limitSharingV2': {'trigger': 'UNKNOWN', 'initiatedByMe': False}}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB0CD0BFF68365FB4B6FC'}
2025-10-06 18:54:59,219 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': 'ec60833c987a921f4d33f360968db1f7a7f79bd15b2b82c3904f62d52642fc07', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': '3EB0CD0BFF68365FB4B6FC', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1759787698, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'extendedTextMessage': {'text': 'hello, how are you?', 'contextInfo': {'ephemeralSettingTimestamp': '1759696911', 'disappearingMode': {'initiator': 'CHANGED_IN_CHAT', 'trigger': 'CHAT_SETTING', 'initiatedByMe': False}}, 'inviteLinkGroupTypeV2': 'DEFAULT'}, 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '7yydDzR4QCXTVg==', 'senderTimestamp': '1759693137', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': '/DoA8ECtFAcnNg==', 'recipientTimestamp': '1759694939'}, 'deviceListMetadataVersion': 2, 'messageSecret': '6QTuo4I/E7b42ZFrq2yVRVFxQQpx/aD584iRNq0wwok=', 'limitSharingV2': {'trigger': 'UNKNOWN', 'initiatedByMe': False}}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB0CD0BFF68365FB4B6FC'}}, 'timestamp': 1759787699084}
2025-10-06 18:54:59,219 - INFO - whatsapp_bot - Sender number: 558186732159@s.whatsapp.net
2025-10-06 18:54:59,220 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-06 18:54:59,220 - INFO - whatsapp_bot - Message content object: {'extendedTextMessage': {'text': 'hello, how are you?', 'contextInfo': {'ephemeralSettingTimestamp': '1759696911', 'disappearingMode': {'initiator': 'CHANGED_IN_CHAT', 'trigger': 'CHAT_SETTING', 'initiatedByMe': False}}, 'inviteLinkGroupTypeV2': 'DEFAULT'}, 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '7yydDzR4QCXTVg==', 'senderTimestamp': '1759693137', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': '/DoA8ECtFAcnNg==', 'recipientTimestamp': '1759694939'}, 'deviceListMetadataVersion': 2, 'messageSecret': '6QTuo4I/E7b42ZFrq2yVRVFxQQpx/aD584iRNq0wwok=', 'limitSharingV2': {'trigger': 'UNKNOWN', 'initiatedByMe': False}}}
2025-10-06 18:54:59,220 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-06 18:54:59,220 - INFO - whatsapp_bot - Found extended text: hello, how are you?
2025-10-06 18:54:59,221 - INFO - werkzeug - 127.0.0.1 - - [06/Oct/2025 18:54:59] "POST /webhook HTTP/1.1" 200 -
2025-10-06 18:54:59,221 - INFO - whatsapp_bot - Safe sender ID: 558186732159_s_whatsapp_net
2025-10-06 18:54:59,222 - INFO - whatsapp_bot - Processing text message: 'hello, how are you?' from 558186732159@s.whatsapp.net
2025-10-06 18:54:59,232 - INFO - whatsapp_bot - Loaded conversation history for 558186732159_s_whatsapp_net
2025-10-06 18:54:59,232 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): hello, how are you?...
2025-10-06 18:55:00,040 - INFO - whatsapp_bot - Sending 1 message chunks to 558186732159@s.whatsapp.net
2025-10-06 18:55:24,496 - INFO - whatsapp_bot - Text message sent to 558186732159@s.whatsapp.net.
2025-10-06 18:55:24,496 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558186732159@s.whatsapp.net
2025-10-06 18:55:24,498 - INFO - whatsapp_bot - Saved conversation history for 558186732159_s_whatsapp_net
2025-10-06 18:55:24,498 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-06 18:55:24,498 - INFO - werkzeug - 127.0.0.1 - - [06/Oct/2025 18:55:24] "POST /webhook HTTP/1.1" 200 -
2025-10-06 18:55:25,914 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-06 18:55:25,920 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-06 18:55:25,920 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-06 18:55:25,921 - INFO - werkzeug - 127.0.0.1 - - [06/Oct/2025 18:55:25] "POST /webhook HTTP/1.1" 200 -
2025-10-06 18:55:26,154 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-06 18:55:26,165 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB0071C85C7C45FFFDFB7
2025-10-06 18:55:26,165 - INFO - werkzeug - 127.0.0.1 - - [06/Oct/2025 18:55:26] "POST /webhook HTTP/1.1" 200 -
2025-10-06 18:55:42,906 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-06 18:55:42,907 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-06 18:55:42,912 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-06 18:55:42,912 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-06 18:55:42,918 - INFO - werkzeug - 127.0.0.1 - - [06/Oct/2025 18:55:42] "POST /webhook HTTP/1.1" 200 -
2025-10-06 18:55:42,924 - INFO - whatsapp_bot - Sender number: 558199745545-1586862732@g.us
2025-10-06 18:55:42,931 - INFO - whatsapp_bot - Safe sender ID: 558199745545_1586862732_g_us
2025-10-06 18:55:42,931 - WARNING - whatsapp_bot - Message type 'unknown' not supported or no text content
2025-10-06 18:55:42,931 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-06 18:55:42,932 - INFO - werkzeug - 127.0.0.1 - - [06/Oct/2025 18:55:42] "POST /webhook HTTP/1.1" 200 -
2025-10-06 18:55:43,553 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-06 18:55:43,554 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': 'ec60833c987a921f4d33f360968db1f7a7f79bd15b2b82c3904f62d52642fc07', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': '3EB0FAD498A7BE4E3E1986', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1759787743, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'extendedTextMessage': {'text': 'Im fine, thank you', 'contextInfo': {'ephemeralSettingTimestamp': '1759696911', 'disappearingMode': {'initiator': 'CHANGED_IN_CHAT', 'trigger': 'CHAT_SETTING', 'initiatedByMe': False}}, 'inviteLinkGroupTypeV2': 'DEFAULT'}, 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '7yydDzR4QCXTVg==', 'senderTimestamp': '1759693137', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': '/DoA8ECtFAcnNg==', 'recipientTimestamp': '1759694939'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'XNTm5e+IYZ0lK8fxYteaUM6zxexLyMufMZn3hk6vOcQ=', 'limitSharingV2': {'trigger': 'UNKNOWN', 'initiatedByMe': False}}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB0FAD498A7BE4E3E1986'}}, 'timestamp': 1759787743491}
2025-10-06 18:55:43,554 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-06 18:55:43,554 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': '3EB0FAD498A7BE4E3E1986', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1759787743, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'extendedTextMessage': {'text': 'Im fine, thank you', 'contextInfo': {'ephemeralSettingTimestamp': '1759696911', 'disappearingMode': {'initiator': 'CHANGED_IN_CHAT', 'trigger': 'CHAT_SETTING', 'initiatedByMe': False}}, 'inviteLinkGroupTypeV2': 'DEFAULT'}, 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '7yydDzR4QCXTVg==', 'senderTimestamp': '1759693137', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': '/DoA8ECtFAcnNg==', 'recipientTimestamp': '1759694939'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'XNTm5e+IYZ0lK8fxYteaUM6zxexLyMufMZn3hk6vOcQ=', 'limitSharingV2': {'trigger': 'UNKNOWN', 'initiatedByMe': False}}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB0FAD498A7BE4E3E1986'}
2025-10-06 18:55:43,554 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': 'ec60833c987a921f4d33f360968db1f7a7f79bd15b2b82c3904f62d52642fc07', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': '3EB0FAD498A7BE4E3E1986', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1759787743, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'extendedTextMessage': {'text': 'Im fine, thank you', 'contextInfo': {'ephemeralSettingTimestamp': '1759696911', 'disappearingMode': {'initiator': 'CHANGED_IN_CHAT', 'trigger': 'CHAT_SETTING', 'initiatedByMe': False}}, 'inviteLinkGroupTypeV2': 'DEFAULT'}, 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '7yydDzR4QCXTVg==', 'senderTimestamp': '1759693137', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': '/DoA8ECtFAcnNg==', 'recipientTimestamp': '1759694939'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'XNTm5e+IYZ0lK8fxYteaUM6zxexLyMufMZn3hk6vOcQ=', 'limitSharingV2': {'trigger': 'UNKNOWN', 'initiatedByMe': False}}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB0FAD498A7BE4E3E1986'}}, 'timestamp': 1759787743490}
2025-10-06 18:55:43,555 - INFO - whatsapp_bot - Sender number: 558186732159@s.whatsapp.net
2025-10-06 18:55:43,555 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-06 18:55:43,555 - INFO - whatsapp_bot - Message content object: {'extendedTextMessage': {'text': 'Im fine, thank you', 'contextInfo': {'ephemeralSettingTimestamp': '1759696911', 'disappearingMode': {'initiator': 'CHANGED_IN_CHAT', 'trigger': 'CHAT_SETTING', 'initiatedByMe': False}}, 'inviteLinkGroupTypeV2': 'DEFAULT'}, 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '7yydDzR4QCXTVg==', 'senderTimestamp': '1759693137', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': '/DoA8ECtFAcnNg==', 'recipientTimestamp': '1759694939'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'XNTm5e+IYZ0lK8fxYteaUM6zxexLyMufMZn3hk6vOcQ=', 'limitSharingV2': {'trigger': 'UNKNOWN', 'initiatedByMe': False}}}
2025-10-06 18:55:43,556 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-06 18:55:43,556 - INFO - whatsapp_bot - Found extended text: Im fine, thank you
2025-10-06 18:55:43,557 - INFO - werkzeug - 127.0.0.1 - - [06/Oct/2025 18:55:43] "POST /webhook HTTP/1.1" 200 -
2025-10-06 18:55:43,557 - INFO - whatsapp_bot - Safe sender ID: 558186732159_s_whatsapp_net
2025-10-06 18:55:43,557 - INFO - whatsapp_bot - Processing text message: 'Im fine, thank you' from 558186732159@s.whatsapp.net
2025-10-06 18:55:43,569 - INFO - whatsapp_bot - Loaded conversation history for 558186732159_s_whatsapp_net
2025-10-06 18:55:43,570 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): Im fine, thank you...
2025-10-06 18:55:44,252 - INFO - whatsapp_bot - Sending 1 message chunks to 558186732159@s.whatsapp.net
2025-10-06 18:56:24,682 - INFO - whatsapp_bot - Text message sent to 558186732159@s.whatsapp.net.
2025-10-06 18:56:24,682 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558186732159@s.whatsapp.net
2025-10-06 18:56:24,685 - INFO - whatsapp_bot - Saved conversation history for 558186732159_s_whatsapp_net
2025-10-06 18:56:24,685 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-06 18:56:24,686 - INFO - werkzeug - 127.0.0.1 - - [06/Oct/2025 18:56:24] "POST /webhook HTTP/1.1" 200 -
2025-10-06 18:56:26,303 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-06 18:56:26,309 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-06 18:56:26,309 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-06 18:56:26,309 - INFO - werkzeug - 127.0.0.1 - - [06/Oct/2025 18:56:26] "POST /webhook HTTP/1.1" 200 -
2025-10-06 18:56:26,552 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-06 18:56:26,562 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB0F4EDF6990083E571FB
2025-10-06 18:56:26,562 - INFO - werkzeug - 127.0.0.1 - - [06/Oct/2025 18:56:26] "POST /webhook HTTP/1.1" 200 -
2025-10-06 18:56:42,989 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-06 18:56:42,990 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': 'ec60833c987a921f4d33f360968db1f7a7f79bd15b2b82c3904f62d52642fc07', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': '3EB0710C192F48A2B9F779', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1759787802, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'extendedTextMessage': {'text': 'Sim, tem uma coisa que eu estou em dvida', 'contextInfo': {'ephemeralSettingTimestamp': '1759696911', 'disappearingMode': {'initiator': 'CHANGED_IN_CHAT', 'trigger': 'CHAT_SETTING', 'initiatedByMe': False}}, 'inviteLinkGroupTypeV2': 'DEFAULT'}, 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '7yydDzR4QCXTVg==', 'senderTimestamp': '1759693137', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': '/DoA8ECtFAcnNg==', 'recipientTimestamp': '1759694939'}, 'deviceListMetadataVersion': 2, 'messageSecret': '0qoLZEXkjAEcWp63PYKCLrRxZI9Up7wrl2E7RdVO3YA=', 'limitSharingV2': {'trigger': 'UNKNOWN', 'initiatedByMe': False}}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB0710C192F48A2B9F779'}}, 'timestamp': 1759787802867}
2025-10-06 18:56:42,991 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': '3EB0710C192F48A2B9F779', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1759787802, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'extendedTextMessage': {'text': 'Sim, tem uma coisa que eu estou em dvida', 'contextInfo': {'ephemeralSettingTimestamp': '1759696911', 'disappearingMode': {'initiator': 'CHANGED_IN_CHAT', 'trigger': 'CHAT_SETTING', 'initiatedByMe': False}}, 'inviteLinkGroupTypeV2': 'DEFAULT'}, 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '7yydDzR4QCXTVg==', 'senderTimestamp': '1759693137', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': '/DoA8ECtFAcnNg==', 'recipientTimestamp': '1759694939'}, 'deviceListMetadataVersion': 2, 'messageSecret': '0qoLZEXkjAEcWp63PYKCLrRxZI9Up7wrl2E7RdVO3YA=', 'limitSharingV2': {'trigger': 'UNKNOWN', 'initiatedByMe': False}}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB0710C192F48A2B9F779'}
2025-10-06 18:56:42,991 - INFO - whatsapp_bot - Sender number: 558186732159@s.whatsapp.net
2025-10-06 18:56:42,991 - INFO - whatsapp_bot - Message content object: {'extendedTextMessage': {'text': 'Sim, tem uma coisa que eu estou em dvida', 'contextInfo': {'ephemeralSettingTimestamp': '1759696911', 'disappearingMode': {'initiator': 'CHANGED_IN_CHAT', 'trigger': 'CHAT_SETTING', 'initiatedByMe': False}}, 'inviteLinkGroupTypeV2': 'DEFAULT'}, 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '7yydDzR4QCXTVg==', 'senderTimestamp': '1759693137', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': '/DoA8ECtFAcnNg==', 'recipientTimestamp': '1759694939'}, 'deviceListMetadataVersion': 2, 'messageSecret': '0qoLZEXkjAEcWp63PYKCLrRxZI9Up7wrl2E7RdVO3YA=', 'limitSharingV2': {'trigger': 'UNKNOWN', 'initiatedByMe': False}}}
2025-10-06 18:56:42,992 - INFO - whatsapp_bot - Found extended text: Sim, tem uma coisa que eu estou em dvida
2025-10-06 18:56:42,993 - INFO - whatsapp_bot - Safe sender ID: 558186732159_s_whatsapp_net
2025-10-06 18:56:42,993 - INFO - whatsapp_bot - Processing text message: 'Sim, tem uma coisa que eu estou em dvida' from 558186732159@s.whatsapp.net
2025-10-06 18:56:42,996 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-06 18:56:42,996 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': 'ec60833c987a921f4d33f360968db1f7a7f79bd15b2b82c3904f62d52642fc07', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': '3EB0710C192F48A2B9F779', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1759787802, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'extendedTextMessage': {'text': 'Sim, tem uma coisa que eu estou em dvida', 'contextInfo': {'ephemeralSettingTimestamp': '1759696911', 'disappearingMode': {'initiator': 'CHANGED_IN_CHAT', 'trigger': 'CHAT_SETTING', 'initiatedByMe': False}}, 'inviteLinkGroupTypeV2': 'DEFAULT'}, 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '7yydDzR4QCXTVg==', 'senderTimestamp': '1759693137', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': '/DoA8ECtFAcnNg==', 'recipientTimestamp': '1759694939'}, 'deviceListMetadataVersion': 2, 'messageSecret': '0qoLZEXkjAEcWp63PYKCLrRxZI9Up7wrl2E7RdVO3YA=', 'limitSharingV2': {'trigger': 'UNKNOWN', 'initiatedByMe': False}}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB0710C192F48A2B9F779'}}, 'timestamp': 1759787802865}
2025-10-06 18:56:42,997 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-06 18:56:42,997 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-06 18:56:42,997 - INFO - werkzeug - 127.0.0.1 - - [06/Oct/2025 18:56:42] "POST /webhook HTTP/1.1" 200 -
2025-10-06 18:56:43,006 - INFO - whatsapp_bot - Loaded conversation history for 558186732159_s_whatsapp_net
2025-10-06 18:56:43,007 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): Sim, tem uma coisa que eu estou em dvida...
2025-10-06 18:56:43,777 - INFO - whatsapp_bot - Sending 1 message chunks to 558186732159@s.whatsapp.net
2025-10-06 18:56:43,777 - INFO - whatsapp_bot - Sending chunk 1/1: Tranquilo! Pode mandar sua dvida! 
 Ficarei feliz...
2025-10-06 18:58:08,539 - INFO - whatsapp_bot - Text message sent to 558186732159@s.whatsapp.net.
2025-10-06 18:58:08,540 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558186732159@s.whatsapp.net
2025-10-06 18:58:08,541 - INFO - whatsapp_bot - Saved conversation history for 558186732159_s_whatsapp_net
2025-10-06 18:58:08,542 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-06 18:58:08,542 - INFO - werkzeug - 127.0.0.1 - - [06/Oct/2025 18:58:08] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:13:19,362 - INFO - whatsapp_bot - WaSenderAPI client initialized successfully with retry support
2025-10-07 16:13:19,363 - INFO - whatsapp_bot - Gemini API client initialized successfully
2025-10-07 16:13:19,363 - WARNING - whatsapp_bot - Persona file not found at persona.json. Using default persona.
2025-10-07 16:13:19,364 - INFO - whatsapp_bot - Using persona 'Assistant'
2025-10-07 16:13:19,364 - INFO - whatsapp_bot - Gemini client initialized with model: gemini-2.0-flash
2025-10-07 16:13:19,365 - INFO - whatsapp_bot - ======================================================
2025-10-07 16:13:19,365 - INFO - whatsapp_bot -   WhatsApp Gemini Chatbot Starting
2025-10-07 16:13:19,365 - INFO - whatsapp_bot - ======================================================
2025-10-07 16:13:19,365 - INFO - whatsapp_bot - Persona: Assistant
2025-10-07 16:13:19,365 - INFO - whatsapp_bot - Gemini Model: gemini-2.0-flash
2025-10-07 16:13:19,365 - INFO - whatsapp_bot - Conversations Directory: conversations
2025-10-07 16:13:19,365 - INFO - whatsapp_bot - WaSender API Client: Initialized
2025-10-07 16:13:19,365 - INFO - whatsapp_bot - Gemini API Client: Initialized
2025-10-07 16:13:19,365 - INFO - whatsapp_bot - Starting Flask server on port 5001...
2025-10-07 16:13:19,365 - INFO - whatsapp_bot - ======================================================
2025-10-07 16:13:19,377 - INFO - werkzeug - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5001
 * Running on http://192.168.68.119:5001
2025-10-07 16:13:19,377 - INFO - werkzeug - [33mPress CTRL+C to quit[0m
2025-10-07 16:14:25,027 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:14:25,028 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC9CF982CE345720117F2FCA2A42176A', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1759864460, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Hello', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'RUP9KjP5+5plywtEBYHPNtRnntlVkYRAlgWt3yBGwi8='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC9CF982CE345720117F2FCA2A42176A'}}, 'timestamp': 1759864461031}
2025-10-07 16:14:25,028 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:14:25,028 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC9CF982CE345720117F2FCA2A42176A', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1759864460, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Hello', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'RUP9KjP5+5plywtEBYHPNtRnntlVkYRAlgWt3yBGwi8='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC9CF982CE345720117F2FCA2A42176A'}
2025-10-07 16:14:25,029 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC9CF982CE345720117F2FCA2A42176A', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1759864460, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Hello', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'RUP9KjP5+5plywtEBYHPNtRnntlVkYRAlgWt3yBGwi8='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC9CF982CE345720117F2FCA2A42176A'}}, 'timestamp': 1759864461030}
2025-10-07 16:14:25,029 - INFO - whatsapp_bot - Sender number: 558199045078@s.whatsapp.net
2025-10-07 16:14:25,029 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-07 16:14:25,029 - INFO - whatsapp_bot - Message content object: {'conversation': 'Hello', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'RUP9KjP5+5plywtEBYHPNtRnntlVkYRAlgWt3yBGwi8='}}
2025-10-07 16:14:25,029 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-07 16:14:25,030 - INFO - whatsapp_bot - Found conversation text: Hello
2025-10-07 16:14:25,030 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:14:25] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:14:25,030 - INFO - whatsapp_bot - Safe sender ID: 558199045078_s_whatsapp_net
2025-10-07 16:14:25,030 - INFO - whatsapp_bot - Processing text message: 'Hello' from 558199045078@s.whatsapp.net
2025-10-07 16:14:25,031 - INFO - whatsapp_bot - Loaded conversation history for 558199045078_s_whatsapp_net
2025-10-07 16:14:25,031 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): Hello...
2025-10-07 16:14:25,987 - INFO - whatsapp_bot - Gemini reply: Hey there! 
 How can I help you today?
2025-10-07 16:14:25,988 - INFO - whatsapp_bot - Sending 1 message chunks to 558199045078@s.whatsapp.net
2025-10-07 16:14:25,988 - INFO - whatsapp_bot - Sending chunk 1/1: Hey there! 
 How can I help you today?...
2025-10-07 16:14:27,010 - INFO - whatsapp_bot - Text message sent to 558199045078@s.whatsapp.net.
2025-10-07 16:14:27,010 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558199045078@s.whatsapp.net
2025-10-07 16:14:27,011 - INFO - whatsapp_bot - Saved conversation history for 558199045078_s_whatsapp_net
2025-10-07 16:14:27,011 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-07 16:14:27,012 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:14:27] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:14:49,983 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:14:49,983 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'ACFD6C54254611EE4D5F8016ED8BFE9D', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1759864485, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Hello', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': '2abHmHrUEcSTMZxZpe4wa3DQmsgAWLKja+1lVv0V668='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'ACFD6C54254611EE4D5F8016ED8BFE9D'}}, 'timestamp': 1759864486016}
2025-10-07 16:14:49,984 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-07 16:14:49,984 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-07 16:14:49,984 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:14:49] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:14:49,987 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:14:49,987 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'ACFD6C54254611EE4D5F8016ED8BFE9D', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1759864485, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Hello', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': '2abHmHrUEcSTMZxZpe4wa3DQmsgAWLKja+1lVv0V668='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'ACFD6C54254611EE4D5F8016ED8BFE9D'}}, 'timestamp': 1759864486018}
2025-10-07 16:14:49,987 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'ACFD6C54254611EE4D5F8016ED8BFE9D', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1759864485, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Hello', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': '2abHmHrUEcSTMZxZpe4wa3DQmsgAWLKja+1lVv0V668='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'ACFD6C54254611EE4D5F8016ED8BFE9D'}
2025-10-07 16:14:49,988 - INFO - whatsapp_bot - Sender number: 558199045078@s.whatsapp.net
2025-10-07 16:14:49,988 - INFO - whatsapp_bot - Message content object: {'conversation': 'Hello', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': '2abHmHrUEcSTMZxZpe4wa3DQmsgAWLKja+1lVv0V668='}}
2025-10-07 16:14:49,988 - INFO - whatsapp_bot - Found conversation text: Hello
2025-10-07 16:14:49,988 - INFO - whatsapp_bot - Safe sender ID: 558199045078_s_whatsapp_net
2025-10-07 16:14:49,988 - INFO - whatsapp_bot - Processing text message: 'Hello' from 558199045078@s.whatsapp.net
2025-10-07 16:14:49,996 - INFO - whatsapp_bot - Loaded conversation history for 558199045078_s_whatsapp_net
2025-10-07 16:14:49,997 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): Hello...
2025-10-07 16:14:50,877 - INFO - whatsapp_bot - Sending 1 message chunks to 558199045078@s.whatsapp.net
2025-10-07 16:17:40,157 - INFO - whatsapp_bot - WaSenderAPI client initialized successfully with retry support
2025-10-07 16:17:40,157 - INFO - whatsapp_bot - Gemini API client initialized successfully
2025-10-07 16:17:40,158 - WARNING - whatsapp_bot - Persona file not found at persona.json. Using default persona.
2025-10-07 16:17:40,158 - INFO - whatsapp_bot - Using persona 'Assistant'
2025-10-07 16:17:40,158 - INFO - whatsapp_bot - Gemini client initialized with model: gemini-2.0-flash
2025-10-07 16:17:40,159 - INFO - whatsapp_bot - ======================================================
2025-10-07 16:17:40,159 - INFO - whatsapp_bot -   WhatsApp Gemini Chatbot Starting
2025-10-07 16:17:40,159 - INFO - whatsapp_bot - ======================================================
2025-10-07 16:17:40,159 - INFO - whatsapp_bot - Persona: Assistant
2025-10-07 16:17:40,159 - INFO - whatsapp_bot - Gemini Model: gemini-2.0-flash
2025-10-07 16:17:40,160 - INFO - whatsapp_bot - Conversations Directory: conversations
2025-10-07 16:17:40,160 - INFO - whatsapp_bot - WaSender API Client: Initialized
2025-10-07 16:17:40,160 - INFO - whatsapp_bot - Gemini API Client: Initialized
2025-10-07 16:17:40,160 - INFO - whatsapp_bot - Starting Flask server on port 5001...
2025-10-07 16:17:40,160 - INFO - whatsapp_bot - ======================================================
2025-10-07 16:17:40,168 - INFO - werkzeug - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5001
 * Running on http://192.168.68.119:5001
2025-10-07 16:17:40,168 - INFO - werkzeug - [33mPress CTRL+C to quit[0m
2025-10-07 16:18:26,940 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:18:26,941 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC0B522C98798F445DA42E4B6ACE9612', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1759864702, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Hello', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'j9eQlGCyoHl91QioQFIL180fYL0Yf2U7rKStwwm8yJ8='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC0B522C98798F445DA42E4B6ACE9612'}}, 'timestamp': 1759864702953}
2025-10-07 16:18:26,942 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-07 16:18:26,942 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-07 16:18:26,942 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:18:26] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:18:26,944 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:18:26,944 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC0B522C98798F445DA42E4B6ACE9612', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1759864702, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Hello', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'j9eQlGCyoHl91QioQFIL180fYL0Yf2U7rKStwwm8yJ8='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC0B522C98798F445DA42E4B6ACE9612'}}, 'timestamp': 1759864702955}
2025-10-07 16:18:26,945 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC0B522C98798F445DA42E4B6ACE9612', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1759864702, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Hello', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'j9eQlGCyoHl91QioQFIL180fYL0Yf2U7rKStwwm8yJ8='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC0B522C98798F445DA42E4B6ACE9612'}
2025-10-07 16:18:26,945 - INFO - whatsapp_bot - Sender number: 558199045078@s.whatsapp.net
2025-10-07 16:18:26,945 - INFO - whatsapp_bot - Message content object: {'conversation': 'Hello', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'j9eQlGCyoHl91QioQFIL180fYL0Yf2U7rKStwwm8yJ8='}}
2025-10-07 16:18:26,945 - INFO - whatsapp_bot - Found conversation text: Hello
2025-10-07 16:18:26,946 - INFO - whatsapp_bot - Safe sender ID: 558199045078_s_whatsapp_net
2025-10-07 16:18:26,946 - INFO - whatsapp_bot - Processing text message: 'Hello' from 558199045078@s.whatsapp.net
2025-10-07 16:18:26,946 - INFO - whatsapp_bot - Loaded conversation history for 558199045078_s_whatsapp_net
2025-10-07 16:18:26,946 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): Hello...
2025-10-07 16:18:28,376 - INFO - whatsapp_bot - Gemini reply: Hi! What can I do for you? 😊
2025-10-07 16:18:28,376 - INFO - whatsapp_bot - Sending 1 message chunks to 558199045078@s.whatsapp.net
2025-10-07 16:18:28,376 - INFO - whatsapp_bot - Sending chunk 1/1: Hi! What can I do for you? 😊...
2025-10-07 16:18:28,973 - INFO - whatsapp_bot - Text message sent to 558199045078@s.whatsapp.net.
2025-10-07 16:18:28,973 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558199045078@s.whatsapp.net
2025-10-07 16:18:28,974 - INFO - whatsapp_bot - Saved conversation history for 558199045078_s_whatsapp_net
2025-10-07 16:18:28,974 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-07 16:18:28,975 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:18:28] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:18:38,754 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:18:38,754 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC8DCAF227251D97E1112A05EBD9C92F', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1759864714, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Hello', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'xIVAq4thKUO/OecYB9Xt0L2Z1uwHmI2y98a1csedcyg='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC8DCAF227251D97E1112A05EBD9C92F'}}, 'timestamp': 1759864714786}
2025-10-07 16:18:38,754 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:18:38,755 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-07 16:18:38,755 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC8DCAF227251D97E1112A05EBD9C92F', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1759864714, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Hello', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'xIVAq4thKUO/OecYB9Xt0L2Z1uwHmI2y98a1csedcyg='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC8DCAF227251D97E1112A05EBD9C92F'}}, 'timestamp': 1759864714789}
2025-10-07 16:18:38,755 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-07 16:18:38,755 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC8DCAF227251D97E1112A05EBD9C92F', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1759864714, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Hello', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'xIVAq4thKUO/OecYB9Xt0L2Z1uwHmI2y98a1csedcyg='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC8DCAF227251D97E1112A05EBD9C92F'}
2025-10-07 16:18:38,755 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:18:38] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:18:38,755 - INFO - whatsapp_bot - Sender number: 558199045078@s.whatsapp.net
2025-10-07 16:18:38,756 - INFO - whatsapp_bot - Message content object: {'conversation': 'Hello', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'xIVAq4thKUO/OecYB9Xt0L2Z1uwHmI2y98a1csedcyg='}}
2025-10-07 16:18:38,756 - INFO - whatsapp_bot - Found conversation text: Hello
2025-10-07 16:18:38,756 - INFO - whatsapp_bot - Safe sender ID: 558199045078_s_whatsapp_net
2025-10-07 16:18:38,756 - INFO - whatsapp_bot - Processing text message: 'Hello' from 558199045078@s.whatsapp.net
2025-10-07 16:18:38,763 - INFO - whatsapp_bot - Loaded conversation history for 558199045078_s_whatsapp_net
2025-10-07 16:18:38,763 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): Hello...
2025-10-07 16:18:39,839 - INFO - whatsapp_bot - Gemini reply: Hey! How can I help? 😄
2025-10-07 16:18:39,840 - INFO - whatsapp_bot - Sending 1 message chunks to 558199045078@s.whatsapp.net
2025-10-07 16:18:39,840 - INFO - whatsapp_bot - Sending chunk 1/1: Hey! How can I help? 😄...
2025-10-07 16:22:08,406 - INFO - whatsapp_bot - WaSenderAPI client initialized successfully with retry support
2025-10-07 16:22:08,406 - INFO - whatsapp_bot - Gemini API client initialized successfully
2025-10-07 16:22:08,407 - WARNING - whatsapp_bot - Persona file not found at persona.json. Using default persona.
2025-10-07 16:22:08,407 - INFO - whatsapp_bot - Using persona 'Assistant'
2025-10-07 16:22:08,407 - INFO - whatsapp_bot - Gemini client initialized with model: gemini-2.0-flash
2025-10-07 16:22:08,408 - INFO - whatsapp_bot - ======================================================
2025-10-07 16:22:08,408 - INFO - whatsapp_bot -   WhatsApp Gemini Chatbot Starting
2025-10-07 16:22:08,408 - INFO - whatsapp_bot - ======================================================
2025-10-07 16:22:08,408 - INFO - whatsapp_bot - Persona: Assistant
2025-10-07 16:22:08,409 - INFO - whatsapp_bot - Gemini Model: gemini-2.0-flash
2025-10-07 16:22:08,409 - INFO - whatsapp_bot - Conversations Directory: conversations
2025-10-07 16:22:08,409 - INFO - whatsapp_bot - WaSender API Client: Initialized
2025-10-07 16:22:08,409 - INFO - whatsapp_bot - Gemini API Client: Initialized
2025-10-07 16:22:08,409 - INFO - whatsapp_bot - Starting Flask server on port 5001...
2025-10-07 16:22:08,409 - INFO - whatsapp_bot - ======================================================
2025-10-07 16:22:08,417 - INFO - werkzeug - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5001
 * Running on http://192.168.68.119:5001
2025-10-07 16:22:08,417 - INFO - werkzeug - [33mPress CTRL+C to quit[0m
2025-10-07 16:22:31,319 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:22:31,320 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC06DB4775417D0A5430BA96D4B0F034', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1759864947, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Hello', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'BfC6AO5zPHLIi8kwWbbu9G8ooOunvMLXd8NnxyUx02U='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC06DB4775417D0A5430BA96D4B0F034'}}, 'timestamp': 1759864947332}
2025-10-07 16:22:31,320 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:22:31,320 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC06DB4775417D0A5430BA96D4B0F034', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1759864947, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Hello', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'BfC6AO5zPHLIi8kwWbbu9G8ooOunvMLXd8NnxyUx02U='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC06DB4775417D0A5430BA96D4B0F034'}
2025-10-07 16:22:31,320 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC06DB4775417D0A5430BA96D4B0F034', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1759864947, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Hello', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'BfC6AO5zPHLIi8kwWbbu9G8ooOunvMLXd8NnxyUx02U='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC06DB4775417D0A5430BA96D4B0F034'}}, 'timestamp': 1759864947330}
2025-10-07 16:22:31,321 - INFO - whatsapp_bot - Sender number: 558199045078@s.whatsapp.net
2025-10-07 16:22:31,321 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-07 16:22:31,321 - INFO - whatsapp_bot - Message content object: {'conversation': 'Hello', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'BfC6AO5zPHLIi8kwWbbu9G8ooOunvMLXd8NnxyUx02U='}}
2025-10-07 16:22:31,321 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-07 16:22:31,321 - INFO - whatsapp_bot - Found conversation text: Hello
2025-10-07 16:22:31,322 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:22:31] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:22:31,322 - INFO - whatsapp_bot - Safe sender ID: 558199045078_s_whatsapp_net
2025-10-07 16:22:31,322 - INFO - whatsapp_bot - Processing text message: 'Hello' from 558199045078@s.whatsapp.net
2025-10-07 16:22:31,322 - INFO - whatsapp_bot - Loaded conversation history for 558199045078_s_whatsapp_net
2025-10-07 16:22:31,323 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): Hello...
2025-10-07 16:22:32,419 - INFO - whatsapp_bot - Sending 1 message chunks to 558199045078@s.whatsapp.net
2025-10-07 16:22:33,090 - INFO - whatsapp_bot - Text message sent to 558199045078@s.whatsapp.net.
2025-10-07 16:22:33,091 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558199045078@s.whatsapp.net
2025-10-07 16:22:33,092 - INFO - whatsapp_bot - Saved conversation history for 558199045078_s_whatsapp_net
2025-10-07 16:22:33,092 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-07 16:22:33,092 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:22:33] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:22:35,029 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:22:35,033 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-07 16:22:35,033 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-07 16:22:35,033 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:22:35] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:22:35,168 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:22:35,175 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB0F9A84387B2815649A2
2025-10-07 16:22:35,175 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:22:35] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:22:50,548 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:22:50,549 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC81A5852BB2449D4912A934FF062F6F', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1759864966, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Qual seu nome', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'MNjN+OiaezfybJaprwhVG1B1MTKxNIMeGYEKtEH9rgM='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC81A5852BB2449D4912A934FF062F6F'}}, 'timestamp': 1759864966578}
2025-10-07 16:22:50,549 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:22:50,549 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-07 16:22:50,549 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC81A5852BB2449D4912A934FF062F6F', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1759864966, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Qual seu nome', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'MNjN+OiaezfybJaprwhVG1B1MTKxNIMeGYEKtEH9rgM='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC81A5852BB2449D4912A934FF062F6F'}}, 'timestamp': 1759864966580}
2025-10-07 16:22:50,549 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-07 16:22:50,550 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC81A5852BB2449D4912A934FF062F6F', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1759864966, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Qual seu nome', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'MNjN+OiaezfybJaprwhVG1B1MTKxNIMeGYEKtEH9rgM='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC81A5852BB2449D4912A934FF062F6F'}
2025-10-07 16:22:50,550 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:22:50] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:22:50,550 - INFO - whatsapp_bot - Sender number: 558199045078@s.whatsapp.net
2025-10-07 16:22:50,551 - INFO - whatsapp_bot - Message content object: {'conversation': 'Qual seu nome', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'MNjN+OiaezfybJaprwhVG1B1MTKxNIMeGYEKtEH9rgM='}}
2025-10-07 16:22:50,551 - INFO - whatsapp_bot - Found conversation text: Qual seu nome
2025-10-07 16:22:50,551 - INFO - whatsapp_bot - Safe sender ID: 558199045078_s_whatsapp_net
2025-10-07 16:22:50,551 - INFO - whatsapp_bot - Processing text message: 'Qual seu nome' from 558199045078@s.whatsapp.net
2025-10-07 16:22:50,559 - INFO - whatsapp_bot - Loaded conversation history for 558199045078_s_whatsapp_net
2025-10-07 16:22:50,560 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): Qual seu nome...
2025-10-07 16:22:51,365 - INFO - whatsapp_bot - Sending 1 message chunks to 558199045078@s.whatsapp.net
2025-10-07 16:22:51,365 - INFO - whatsapp_bot - Sending chunk 1/1: Eu sou um modelo de linguagem grande, treinado pel...
2025-10-07 16:23:33,526 - INFO - whatsapp_bot - Text message sent to 558199045078@s.whatsapp.net.
2025-10-07 16:23:33,527 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558199045078@s.whatsapp.net
2025-10-07 16:23:33,528 - INFO - whatsapp_bot - Saved conversation history for 558199045078_s_whatsapp_net
2025-10-07 16:23:33,528 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-07 16:23:33,528 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:23:33] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:23:35,237 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:23:35,241 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-07 16:23:35,241 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-07 16:23:35,241 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:23:35] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:23:35,463 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:23:35,470 - INFO - whatsapp_bot - Sender number: 120363167775174375@newsletter
2025-10-07 16:23:35,473 - INFO - whatsapp_bot - Safe sender ID: 120363167775174375_newsletter
2025-10-07 16:23:35,474 - WARNING - whatsapp_bot - Message type 'unknown' not supported or no text content
2025-10-07 16:23:35,474 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-07 16:23:35,474 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:23:35] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:23:35,475 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:23:35,475 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC56B480B3CC3DC68822252CB857A820', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1759864993, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Me fala teu nome', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'i/sIlXY+AA84tMdZN6O/QMtrwO9xhVs6WRK4j1EVQM4='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC56B480B3CC3DC68822252CB857A820'}}, 'timestamp': 1759865011496}
2025-10-07 16:23:35,476 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:23:35,476 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC56B480B3CC3DC68822252CB857A820', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1759864993, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Me fala teu nome', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'i/sIlXY+AA84tMdZN6O/QMtrwO9xhVs6WRK4j1EVQM4='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC56B480B3CC3DC68822252CB857A820'}
2025-10-07 16:23:35,476 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC56B480B3CC3DC68822252CB857A820', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1759864993, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Me fala teu nome', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'i/sIlXY+AA84tMdZN6O/QMtrwO9xhVs6WRK4j1EVQM4='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC56B480B3CC3DC68822252CB857A820'}}, 'timestamp': 1759865011493}
2025-10-07 16:23:35,476 - INFO - whatsapp_bot - Sender number: 558199045078@s.whatsapp.net
2025-10-07 16:23:35,476 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-07 16:23:35,477 - INFO - whatsapp_bot - Message content object: {'conversation': 'Me fala teu nome', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'i/sIlXY+AA84tMdZN6O/QMtrwO9xhVs6WRK4j1EVQM4='}}
2025-10-07 16:23:35,477 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-07 16:23:35,477 - INFO - whatsapp_bot - Found conversation text: Me fala teu nome
2025-10-07 16:23:35,477 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:23:35] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:23:35,477 - INFO - whatsapp_bot - Safe sender ID: 558199045078_s_whatsapp_net
2025-10-07 16:23:35,478 - INFO - whatsapp_bot - Processing text message: 'Me fala teu nome' from 558199045078@s.whatsapp.net
2025-10-07 16:23:35,481 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:23:35,485 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-07 16:23:35,485 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-07 16:23:35,485 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:23:35] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:23:35,487 - INFO - whatsapp_bot - Loaded conversation history for 558199045078_s_whatsapp_net
2025-10-07 16:23:35,487 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): Me fala teu nome...
2025-10-07 16:23:35,530 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:23:35,536 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB0324607142D154CE31A
2025-10-07 16:23:35,537 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:23:35] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:23:36,277 - INFO - whatsapp_bot - Sending 1 message chunks to 558199045078@s.whatsapp.net
2025-10-07 16:23:36,277 - INFO - whatsapp_bot - Sending chunk 1/1: Eu no tenho um nome. 
 Sou um modelo de linguagem...
2025-10-07 16:24:02,389 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:24:02,390 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'ACC1A702A66E54D7D71D52B87B56219B', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1759865038, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Entende de c#', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'CTGlKG6xhm+X1FJiQoPr+Wbm1vAGtjzQm/5/U0zwAS0='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'ACC1A702A66E54D7D71D52B87B56219B'}}, 'timestamp': 1759865038427}
2025-10-07 16:24:02,390 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:24:02,390 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'ACC1A702A66E54D7D71D52B87B56219B', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1759865038, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Entende de c#', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'CTGlKG6xhm+X1FJiQoPr+Wbm1vAGtjzQm/5/U0zwAS0='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'ACC1A702A66E54D7D71D52B87B56219B'}
2025-10-07 16:24:02,390 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'ACC1A702A66E54D7D71D52B87B56219B', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1759865038, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Entende de c#', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'CTGlKG6xhm+X1FJiQoPr+Wbm1vAGtjzQm/5/U0zwAS0='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'ACC1A702A66E54D7D71D52B87B56219B'}}, 'timestamp': 1759865038424}
2025-10-07 16:24:02,390 - INFO - whatsapp_bot - Sender number: 558199045078@s.whatsapp.net
2025-10-07 16:24:02,390 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-07 16:24:02,390 - INFO - whatsapp_bot - Message content object: {'conversation': 'Entende de c#', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'CTGlKG6xhm+X1FJiQoPr+Wbm1vAGtjzQm/5/U0zwAS0='}}
2025-10-07 16:24:02,390 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-07 16:24:02,391 - INFO - whatsapp_bot - Found conversation text: Entende de c#
2025-10-07 16:24:02,391 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:24:02] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:24:02,391 - INFO - whatsapp_bot - Safe sender ID: 558199045078_s_whatsapp_net
2025-10-07 16:24:02,392 - INFO - whatsapp_bot - Processing text message: 'Entende de c#' from 558199045078@s.whatsapp.net
2025-10-07 16:24:02,392 - INFO - whatsapp_bot - Loaded conversation history for 558199045078_s_whatsapp_net
2025-10-07 16:24:02,392 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): Entende de c#...
2025-10-07 16:24:07,009 - INFO - whatsapp_bot - Gemini reply: Sim, entendo de C#. 
 Posso te ajudar com algo relacionado?
2025-10-07 16:24:07,009 - INFO - whatsapp_bot - Sending 1 message chunks to 558199045078@s.whatsapp.net
2025-10-07 16:24:07,009 - INFO - whatsapp_bot - Sending chunk 1/1: Sim, entendo de C#. 
 Posso te ajudar com algo rel...
2025-10-07 16:24:34,398 - INFO - whatsapp_bot - Text message sent to 558199045078@s.whatsapp.net.
2025-10-07 16:24:34,398 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558199045078@s.whatsapp.net
2025-10-07 16:24:34,399 - INFO - whatsapp_bot - Saved conversation history for 558199045078_s_whatsapp_net
2025-10-07 16:24:34,399 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-07 16:24:34,399 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:24:34] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:24:35,875 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:24:35,876 - INFO - whatsapp_bot - Received webhook data: {'event': 'message.sent', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'jid': '558199045078@s.whatsapp.net', 'msgId': 6132744, 'success': True, 'result': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB08E7E74A1EEA9E84A74'}, 'message': {'extendedTextMessage': {'text': 'Sim, entendo de C#. \n Posso te ajudar com algo relacionado?'}}, 'messageTimestamp': '1759865071', 'status': 'PENDING'}}, 'timestamp': 1759865071969}
2025-10-07 16:24:35,876 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-07 16:24:35,876 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-07 16:24:35,876 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:24:35] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:24:36,115 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:24:36,116 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB08E7E74A1EEA9E84A74', 'msgId': 6132744}, 'message': {'extendedTextMessage': {'text': 'Sim, entendo de C#. \n Posso te ajudar com algo relacionado?'}}, 'messageTimestamp': {'low': 1759865071, 'high': 0, 'unsigned': True}, 'status': 1, 'remoteJid': '558199045078@s.whatsapp.net', 'id': '3EB08E7E74A1EEA9E84A74'}}, 'timestamp': 1759865072135}
2025-10-07 16:24:36,116 - INFO - whatsapp_bot - Processing message info: {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB08E7E74A1EEA9E84A74', 'msgId': 6132744}, 'message': {'extendedTextMessage': {'text': 'Sim, entendo de C#. \n Posso te ajudar com algo relacionado?'}}, 'messageTimestamp': {'low': 1759865071, 'high': 0, 'unsigned': True}, 'status': 1, 'remoteJid': '558199045078@s.whatsapp.net', 'id': '3EB08E7E74A1EEA9E84A74'}
2025-10-07 16:24:36,116 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB08E7E74A1EEA9E84A74
2025-10-07 16:24:36,117 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:24:36] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:24:58,908 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:24:58,908 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'ACA269C6D1B2062201457B8AC7C79D13', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1759865094, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Crie um hello Word', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'F2XO6x9uhnBUp0BjwyY8Nw2rLNk9BL70+QJVJAdI63w='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'ACA269C6D1B2062201457B8AC7C79D13'}}, 'timestamp': 1759865094945}
2025-10-07 16:24:58,908 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-07 16:24:58,908 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-07 16:24:58,909 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:24:58] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:24:58,910 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:24:58,911 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'ACA269C6D1B2062201457B8AC7C79D13', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1759865094, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Crie um hello Word', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'F2XO6x9uhnBUp0BjwyY8Nw2rLNk9BL70+QJVJAdI63w='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'ACA269C6D1B2062201457B8AC7C79D13'}}, 'timestamp': 1759865094947}
2025-10-07 16:24:58,911 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'ACA269C6D1B2062201457B8AC7C79D13', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1759865094, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Crie um hello Word', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'F2XO6x9uhnBUp0BjwyY8Nw2rLNk9BL70+QJVJAdI63w='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'ACA269C6D1B2062201457B8AC7C79D13'}
2025-10-07 16:24:58,911 - INFO - whatsapp_bot - Sender number: 558199045078@s.whatsapp.net
2025-10-07 16:24:58,911 - INFO - whatsapp_bot - Message content object: {'conversation': 'Crie um hello Word', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'F2XO6x9uhnBUp0BjwyY8Nw2rLNk9BL70+QJVJAdI63w='}}
2025-10-07 16:24:58,912 - INFO - whatsapp_bot - Found conversation text: Crie um hello Word
2025-10-07 16:24:58,912 - INFO - whatsapp_bot - Safe sender ID: 558199045078_s_whatsapp_net
2025-10-07 16:24:58,912 - INFO - whatsapp_bot - Processing text message: 'Crie um hello Word' from 558199045078@s.whatsapp.net
2025-10-07 16:24:58,921 - INFO - whatsapp_bot - Loaded conversation history for 558199045078_s_whatsapp_net
2025-10-07 16:24:58,921 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): Crie um hello Word...
2025-10-07 16:25:00,240 - INFO - whatsapp_bot - Sending 5 message chunks to 558199045078@s.whatsapp.net
2025-10-07 16:25:00,240 - INFO - whatsapp_bot - Sending chunk 1/5: ```csharp
 using System;
...
2025-10-07 16:25:17,835 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:25:17,835 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199745545@s.whatsapp.net', 'fromMe': True, 'id': 'ACCADE3D207BF7100E8625C93C945BA0'}, 'messageTimestamp': 1759865113, 'pushName': 'Pedro Henrique', 'broadcast': False, 'status': 2, 'message': {'extendedTextMessage': {'text': 'Pai', 'previewType': 'NONE', 'contextInfo': {'entryPointConversionSource': 'global_search_new_chat', 'entryPointConversionApp': 'whatsapp', 'entryPointConversionDelaySeconds': 1}, 'inviteLinkGroupTypeV2': 'DEFAULT'}}, 'remoteJid': '558199745545@s.whatsapp.net', 'id': 'ACCADE3D207BF7100E8625C93C945BA0'}}, 'timestamp': 1759865113877}
2025-10-07 16:25:17,835 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558199745545@s.whatsapp.net', 'fromMe': True, 'id': 'ACCADE3D207BF7100E8625C93C945BA0'}, 'messageTimestamp': 1759865113, 'pushName': 'Pedro Henrique', 'broadcast': False, 'status': 2, 'message': {'extendedTextMessage': {'text': 'Pai', 'previewType': 'NONE', 'contextInfo': {'entryPointConversionSource': 'global_search_new_chat', 'entryPointConversionApp': 'whatsapp', 'entryPointConversionDelaySeconds': 1}, 'inviteLinkGroupTypeV2': 'DEFAULT'}}, 'remoteJid': '558199745545@s.whatsapp.net', 'id': 'ACCADE3D207BF7100E8625C93C945BA0'}
2025-10-07 16:25:17,836 - INFO - whatsapp_bot - Ignoring self-sent message: ACCADE3D207BF7100E8625C93C945BA0
2025-10-07 16:25:17,836 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:25:17] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:25:22,157 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:25:22,158 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199745545@s.whatsapp.net', 'fromMe': True, 'id': 'AC81A9643B6D0E847CA04C4C94EE2324'}, 'messageTimestamp': 1759865118, 'pushName': 'Pedro Henrique', 'broadcast': False, 'status': 2, 'message': {'conversation': 'Traz o celular da otica'}, 'remoteJid': '558199745545@s.whatsapp.net', 'id': 'AC81A9643B6D0E847CA04C4C94EE2324'}}, 'timestamp': 1759865118262}
2025-10-07 16:25:22,158 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558199745545@s.whatsapp.net', 'fromMe': True, 'id': 'AC81A9643B6D0E847CA04C4C94EE2324'}, 'messageTimestamp': 1759865118, 'pushName': 'Pedro Henrique', 'broadcast': False, 'status': 2, 'message': {'conversation': 'Traz o celular da otica'}, 'remoteJid': '558199745545@s.whatsapp.net', 'id': 'AC81A9643B6D0E847CA04C4C94EE2324'}
2025-10-07 16:25:22,158 - INFO - whatsapp_bot - Ignoring self-sent message: AC81A9643B6D0E847CA04C4C94EE2324
2025-10-07 16:25:22,159 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:25:22] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:25:25,642 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:25:25,643 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199745545@s.whatsapp.net', 'fromMe': True, 'id': 'AC412C18618A45BD8DEF283F1ADAD971'}, 'messageTimestamp': 1759865121, 'pushName': 'Pedro Henrique', 'broadcast': False, 'status': 2, 'message': {'conversation': 'Esta tudo funcionando'}, 'remoteJid': '558199745545@s.whatsapp.net', 'id': 'AC412C18618A45BD8DEF283F1ADAD971'}}, 'timestamp': 1759865121746}
2025-10-07 16:25:25,643 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558199745545@s.whatsapp.net', 'fromMe': True, 'id': 'AC412C18618A45BD8DEF283F1ADAD971'}, 'messageTimestamp': 1759865121, 'pushName': 'Pedro Henrique', 'broadcast': False, 'status': 2, 'message': {'conversation': 'Esta tudo funcionando'}, 'remoteJid': '558199745545@s.whatsapp.net', 'id': 'AC412C18618A45BD8DEF283F1ADAD971'}
2025-10-07 16:25:25,643 - INFO - whatsapp_bot - Ignoring self-sent message: AC412C18618A45BD8DEF283F1ADAD971
2025-10-07 16:25:25,643 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:25:25] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:25:34,409 - INFO - whatsapp_bot - Text message sent to 558199045078@s.whatsapp.net.
2025-10-07 16:25:34,409 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558199045078@s.whatsapp.net
2025-10-07 16:25:34,409 - INFO - whatsapp_bot - Waiting 5.0 seconds before next chunk...
2025-10-07 16:25:34,904 - ERROR - whatsapp_bot - WaSenderAPI Error sending text to 558199045078@s.whatsapp.net: You are on a free trial. You can send 1 message every 1 minute. (Status: 429)
2025-10-07 16:25:34,905 - ERROR - whatsapp_bot - Failed to send message chunk 1 to 558199045078@s.whatsapp.net
2025-10-07 16:25:34,906 - INFO - whatsapp_bot - Saved conversation history for 558199045078_s_whatsapp_net
2025-10-07 16:25:34,906 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-07 16:25:34,907 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:25:34] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:25:36,826 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:25:36,826 - INFO - whatsapp_bot - Received webhook data: {'event': 'message.sent', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'jid': '558199045078@s.whatsapp.net', 'msgId': 6132828, 'success': True, 'result': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB038D5F1B98175B0F06A'}, 'message': {'extendedTextMessage': {'text': '```csharp\n using System;'}}, 'messageTimestamp': '1759865132', 'status': 'PENDING'}}, 'timestamp': 1759865132843}
2025-10-07 16:25:36,827 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-07 16:25:36,827 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-07 16:25:36,827 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:25:36] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:25:36,960 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:25:36,961 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB038D5F1B98175B0F06A', 'msgId': 6132828}, 'message': {'extendedTextMessage': {'text': '```csharp\n using System;'}}, 'messageTimestamp': {'low': 1759865132, 'high': 0, 'unsigned': True}, 'status': 1, 'remoteJid': '558199045078@s.whatsapp.net', 'id': '3EB038D5F1B98175B0F06A'}}, 'timestamp': 1759865133004}
2025-10-07 16:25:36,961 - INFO - whatsapp_bot - Processing message info: {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB038D5F1B98175B0F06A', 'msgId': 6132828}, 'message': {'extendedTextMessage': {'text': '```csharp\n using System;'}}, 'messageTimestamp': {'low': 1759865132, 'high': 0, 'unsigned': True}, 'status': 1, 'remoteJid': '558199045078@s.whatsapp.net', 'id': '3EB038D5F1B98175B0F06A'}
2025-10-07 16:25:36,961 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB038D5F1B98175B0F06A
2025-10-07 16:25:36,962 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:25:36] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:25:39,430 - INFO - whatsapp_bot - Sending chunk 2/5: 
 public class Program
 {...
2025-10-07 16:26:12,409 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:26:12,410 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199745545@s.whatsapp.net', 'fromMe': True, 'id': 'AC7ECAF449B222E04B508F62E1DBDCEA'}, 'messageTimestamp': 1759865168, 'pushName': 'Pedro Henrique', 'broadcast': False, 'status': 2, 'message': {'conversation': 'Mas precisa do celular da otica, do senhor pagar as coisas que precisam ser pagas e treinar o bot para responder o que  necessario'}, 'remoteJid': '558199745545@s.whatsapp.net', 'id': 'AC7ECAF449B222E04B508F62E1DBDCEA'}}, 'timestamp': 1759865168442}
2025-10-07 16:26:12,410 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558199745545@s.whatsapp.net', 'fromMe': True, 'id': 'AC7ECAF449B222E04B508F62E1DBDCEA'}, 'messageTimestamp': 1759865168, 'pushName': 'Pedro Henrique', 'broadcast': False, 'status': 2, 'message': {'conversation': 'Mas precisa do celular da otica, do senhor pagar as coisas que precisam ser pagas e treinar o bot para responder o que  necessario'}, 'remoteJid': '558199745545@s.whatsapp.net', 'id': 'AC7ECAF449B222E04B508F62E1DBDCEA'}
2025-10-07 16:26:12,410 - INFO - whatsapp_bot - Ignoring self-sent message: AC7ECAF449B222E04B508F62E1DBDCEA
2025-10-07 16:26:12,410 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:26:12] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:38:35,031 - INFO - whatsapp_bot - WaSenderAPI client initialized successfully with retry support
2025-10-07 16:38:35,031 - INFO - whatsapp_bot - Gemini API client initialized successfully
2025-10-07 16:38:35,032 - WARNING - whatsapp_bot - Persona file not found at persona.json. Using default persona.
2025-10-07 16:38:35,032 - INFO - whatsapp_bot - Using persona 'Assistant'
2025-10-07 16:38:35,032 - INFO - whatsapp_bot - Gemini client initialized with model: gemini-2.0-flash
2025-10-07 16:38:35,033 - INFO - whatsapp_bot - ======================================================
2025-10-07 16:38:35,033 - INFO - whatsapp_bot -   WhatsApp Gemini Chatbot Starting
2025-10-07 16:38:35,033 - INFO - whatsapp_bot - ======================================================
2025-10-07 16:38:35,034 - INFO - whatsapp_bot - Persona: Assistant
2025-10-07 16:38:35,034 - INFO - whatsapp_bot - Gemini Model: gemini-2.0-flash
2025-10-07 16:38:35,034 - INFO - whatsapp_bot - Conversations Directory: conversations
2025-10-07 16:38:35,034 - INFO - whatsapp_bot - WaSender API Client: Initialized
2025-10-07 16:38:35,034 - INFO - whatsapp_bot - Gemini API Client: Initialized
2025-10-07 16:38:35,034 - INFO - whatsapp_bot - Starting Flask server on port 5001...
2025-10-07 16:38:35,034 - INFO - whatsapp_bot - ======================================================
2025-10-07 16:38:35,041 - INFO - werkzeug - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5001
 * Running on http://192.168.68.119:5001
2025-10-07 16:38:35,041 - INFO - werkzeug - [33mPress CTRL+C to quit[0m
2025-10-07 16:38:42,177 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:38:42,177 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558198667732@s.whatsapp.net', 'fromMe': False, 'id': 'AC1025C245C5E81BC2784789AD92A3B2', 'senderLid': '77498524155905@lid'}, 'messageTimestamp': 1759865918, 'pushName': 'Hugo Leonardo', 'broadcast': False, 'message': {'extendedTextMessage': {'text': 'Ol', 'previewType': 'NONE', 'contextInfo': {'entryPointConversionSource': 'global_search_new_chat', 'entryPointConversionApp': 'whatsapp', 'entryPointConversionDelaySeconds': 17}, 'inviteLinkGroupTypeV2': 'DEFAULT'}, 'messageContextInfo': {'deviceListMetadata': {'senderTimestamp': '1759796505', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'hSNnjUdvaSvu7psB76J0KTROrMgh2alU6r5tMZmY0W4='}}, 'remoteJid': '558198667732@s.whatsapp.net', 'id': 'AC1025C245C5E81BC2784789AD92A3B2'}}, 'timestamp': 1759865918222}
2025-10-07 16:38:42,178 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:38:42,178 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558198667732@s.whatsapp.net', 'fromMe': False, 'id': 'AC1025C245C5E81BC2784789AD92A3B2', 'senderLid': '77498524155905@lid'}, 'messageTimestamp': 1759865918, 'pushName': 'Hugo Leonardo', 'broadcast': False, 'message': {'extendedTextMessage': {'text': 'Ol', 'previewType': 'NONE', 'contextInfo': {'entryPointConversionSource': 'global_search_new_chat', 'entryPointConversionApp': 'whatsapp', 'entryPointConversionDelaySeconds': 17}, 'inviteLinkGroupTypeV2': 'DEFAULT'}, 'messageContextInfo': {'deviceListMetadata': {'senderTimestamp': '1759796505', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'hSNnjUdvaSvu7psB76J0KTROrMgh2alU6r5tMZmY0W4='}}, 'remoteJid': '558198667732@s.whatsapp.net', 'id': 'AC1025C245C5E81BC2784789AD92A3B2'}
2025-10-07 16:38:42,178 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558198667732@s.whatsapp.net', 'fromMe': False, 'id': 'AC1025C245C5E81BC2784789AD92A3B2', 'senderLid': '77498524155905@lid'}, 'messageTimestamp': 1759865918, 'pushName': 'Hugo Leonardo', 'broadcast': False, 'message': {'extendedTextMessage': {'text': 'Ol', 'previewType': 'NONE', 'contextInfo': {'entryPointConversionSource': 'global_search_new_chat', 'entryPointConversionApp': 'whatsapp', 'entryPointConversionDelaySeconds': 17}, 'inviteLinkGroupTypeV2': 'DEFAULT'}, 'messageContextInfo': {'deviceListMetadata': {'senderTimestamp': '1759796505', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'hSNnjUdvaSvu7psB76J0KTROrMgh2alU6r5tMZmY0W4='}}, 'remoteJid': '558198667732@s.whatsapp.net', 'id': 'AC1025C245C5E81BC2784789AD92A3B2'}}, 'timestamp': 1759865918218}
2025-10-07 16:38:42,178 - INFO - whatsapp_bot - Sender number: 558198667732@s.whatsapp.net
2025-10-07 16:38:42,179 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-07 16:38:42,179 - INFO - whatsapp_bot - Message content object: {'extendedTextMessage': {'text': 'Ol', 'previewType': 'NONE', 'contextInfo': {'entryPointConversionSource': 'global_search_new_chat', 'entryPointConversionApp': 'whatsapp', 'entryPointConversionDelaySeconds': 17}, 'inviteLinkGroupTypeV2': 'DEFAULT'}, 'messageContextInfo': {'deviceListMetadata': {'senderTimestamp': '1759796505', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'hSNnjUdvaSvu7psB76J0KTROrMgh2alU6r5tMZmY0W4='}}
2025-10-07 16:38:42,179 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-07 16:38:42,179 - INFO - whatsapp_bot - Found extended text: Ol
2025-10-07 16:38:42,180 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:38:42] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:38:42,180 - INFO - whatsapp_bot - Safe sender ID: 558198667732_s_whatsapp_net
2025-10-07 16:38:42,180 - INFO - whatsapp_bot - Processing text message: 'Ol' from 558198667732@s.whatsapp.net
2025-10-07 16:38:42,180 - INFO - whatsapp_bot - Loaded conversation history for 558198667732_s_whatsapp_net
2025-10-07 16:38:42,180 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): Ol...
2025-10-07 16:38:43,875 - INFO - whatsapp_bot - Sending 1 message chunks to 558198667732@s.whatsapp.net
2025-10-07 16:38:44,678 - INFO - whatsapp_bot - Text message sent to 558198667732@s.whatsapp.net.
2025-10-07 16:38:44,678 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558198667732@s.whatsapp.net
2025-10-07 16:38:44,679 - INFO - whatsapp_bot - Saved conversation history for 558198667732_s_whatsapp_net
2025-10-07 16:38:44,679 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-07 16:38:44,680 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:38:44] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:38:45,898 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:38:45,898 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'ACC418FDD5D44C4A59E8AA0BB3B25A53', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1759865921, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Oi', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'BVF9HJXbBW0+Y+RCcBbcc9ldhchk5yjHxcPuuKu3bt4='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'ACC418FDD5D44C4A59E8AA0BB3B25A53'}}, 'timestamp': 1759865922015}
2025-10-07 16:38:45,898 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'ACC418FDD5D44C4A59E8AA0BB3B25A53', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1759865921, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Oi', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'BVF9HJXbBW0+Y+RCcBbcc9ldhchk5yjHxcPuuKu3bt4='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'ACC418FDD5D44C4A59E8AA0BB3B25A53'}
2025-10-07 16:38:45,898 - INFO - whatsapp_bot - Sender number: 558199045078@s.whatsapp.net
2025-10-07 16:38:45,898 - INFO - whatsapp_bot - Message content object: {'conversation': 'Oi', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'BVF9HJXbBW0+Y+RCcBbcc9ldhchk5yjHxcPuuKu3bt4='}}
2025-10-07 16:38:45,899 - INFO - whatsapp_bot - Found conversation text: Oi
2025-10-07 16:38:45,899 - INFO - whatsapp_bot - Safe sender ID: 558199045078_s_whatsapp_net
2025-10-07 16:38:45,899 - INFO - whatsapp_bot - Processing text message: 'Oi' from 558199045078@s.whatsapp.net
2025-10-07 16:38:45,901 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:38:45,901 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'ACC418FDD5D44C4A59E8AA0BB3B25A53', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1759865921, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Oi', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'BVF9HJXbBW0+Y+RCcBbcc9ldhchk5yjHxcPuuKu3bt4='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'ACC418FDD5D44C4A59E8AA0BB3B25A53'}}, 'timestamp': 1759865922014}
2025-10-07 16:38:45,901 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-07 16:38:45,901 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-07 16:38:45,901 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:38:45] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:38:45,908 - INFO - whatsapp_bot - Loaded conversation history for 558199045078_s_whatsapp_net
2025-10-07 16:38:45,908 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): Oi...
2025-10-07 16:38:46,476 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:38:46,479 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-07 16:38:46,479 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-07 16:38:46,479 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:38:46] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:38:46,655 - INFO - whatsapp_bot - Sending 1 message chunks to 558199045078@s.whatsapp.net
2025-10-07 16:38:47,058 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:38:47,064 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB033D4FD48C5D8272D91
2025-10-07 16:38:47,064 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:38:47] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:39:22,899 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:39:22,900 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC39A42F10CB9AF47DE685ED1A1BE35A', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1759865958, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Oi', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': '1wqM3po+ImLg5W6qClKdqz9VPwoZ/NLvsUG0mde7CuY='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC39A42F10CB9AF47DE685ED1A1BE35A'}}, 'timestamp': 1759865958949}
2025-10-07 16:39:22,900 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:39:22,900 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC39A42F10CB9AF47DE685ED1A1BE35A', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1759865958, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Oi', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': '1wqM3po+ImLg5W6qClKdqz9VPwoZ/NLvsUG0mde7CuY='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC39A42F10CB9AF47DE685ED1A1BE35A'}
2025-10-07 16:39:22,900 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC39A42F10CB9AF47DE685ED1A1BE35A', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1759865958, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Oi', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': '1wqM3po+ImLg5W6qClKdqz9VPwoZ/NLvsUG0mde7CuY='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC39A42F10CB9AF47DE685ED1A1BE35A'}}, 'timestamp': 1759865958947}
2025-10-07 16:39:22,900 - INFO - whatsapp_bot - Sender number: 558199045078@s.whatsapp.net
2025-10-07 16:39:22,901 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-07 16:39:22,901 - INFO - whatsapp_bot - Message content object: {'conversation': 'Oi', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': '1wqM3po+ImLg5W6qClKdqz9VPwoZ/NLvsUG0mde7CuY='}}
2025-10-07 16:39:22,901 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-07 16:39:22,901 - INFO - whatsapp_bot - Found conversation text: Oi
2025-10-07 16:39:22,901 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:39:22] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:39:22,901 - INFO - whatsapp_bot - Safe sender ID: 558199045078_s_whatsapp_net
2025-10-07 16:39:22,902 - INFO - whatsapp_bot - Processing text message: 'Oi' from 558199045078@s.whatsapp.net
2025-10-07 16:39:22,902 - INFO - whatsapp_bot - Loaded conversation history for 558199045078_s_whatsapp_net
2025-10-07 16:39:22,902 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): Oi...
2025-10-07 16:39:22,949 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:39:22,949 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558198667732@s.whatsapp.net', 'fromMe': False, 'id': 'AC3272C5224ECDC9C6F0E4DD812EC56F', 'senderLid': '77498524155905@lid'}, 'messageTimestamp': 1759865958, 'pushName': 'Hugo Leonardo', 'broadcast': False, 'message': {'conversation': 'Conhece recipe pe', 'messageContextInfo': {'deviceListMetadata': {'senderTimestamp': '1759796505', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': '8imSw8zcf4iMNG+LaXtVRb6am8dgPPzLSLzee/XMFqU='}}, 'remoteJid': '558198667732@s.whatsapp.net', 'id': 'AC3272C5224ECDC9C6F0E4DD812EC56F'}}, 'timestamp': 1759865958993}
2025-10-07 16:39:22,949 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-07 16:39:22,949 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-07 16:39:22,949 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:39:22] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:39:22,958 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:39:22,958 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558198667732@s.whatsapp.net', 'fromMe': False, 'id': 'AC3272C5224ECDC9C6F0E4DD812EC56F', 'senderLid': '77498524155905@lid'}, 'messageTimestamp': 1759865958, 'pushName': 'Hugo Leonardo', 'broadcast': False, 'message': {'conversation': 'Conhece recipe pe', 'messageContextInfo': {'deviceListMetadata': {'senderTimestamp': '1759796505', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': '8imSw8zcf4iMNG+LaXtVRb6am8dgPPzLSLzee/XMFqU='}}, 'remoteJid': '558198667732@s.whatsapp.net', 'id': 'AC3272C5224ECDC9C6F0E4DD812EC56F'}}, 'timestamp': 1759865958995}
2025-10-07 16:39:22,958 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558198667732@s.whatsapp.net', 'fromMe': False, 'id': 'AC3272C5224ECDC9C6F0E4DD812EC56F', 'senderLid': '77498524155905@lid'}, 'messageTimestamp': 1759865958, 'pushName': 'Hugo Leonardo', 'broadcast': False, 'message': {'conversation': 'Conhece recipe pe', 'messageContextInfo': {'deviceListMetadata': {'senderTimestamp': '1759796505', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': '8imSw8zcf4iMNG+LaXtVRb6am8dgPPzLSLzee/XMFqU='}}, 'remoteJid': '558198667732@s.whatsapp.net', 'id': 'AC3272C5224ECDC9C6F0E4DD812EC56F'}
2025-10-07 16:39:22,958 - INFO - whatsapp_bot - Sender number: 558198667732@s.whatsapp.net
2025-10-07 16:39:22,958 - INFO - whatsapp_bot - Message content object: {'conversation': 'Conhece recipe pe', 'messageContextInfo': {'deviceListMetadata': {'senderTimestamp': '1759796505', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': '8imSw8zcf4iMNG+LaXtVRb6am8dgPPzLSLzee/XMFqU='}}
2025-10-07 16:39:22,959 - INFO - whatsapp_bot - Found conversation text: Conhece recipe pe
2025-10-07 16:39:22,959 - INFO - whatsapp_bot - Safe sender ID: 558198667732_s_whatsapp_net
2025-10-07 16:39:22,959 - INFO - whatsapp_bot - Processing text message: 'Conhece recipe pe' from 558198667732@s.whatsapp.net
2025-10-07 16:39:22,967 - INFO - whatsapp_bot - Loaded conversation history for 558198667732_s_whatsapp_net
2025-10-07 16:39:22,967 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): Conhece recipe pe...
2025-10-07 16:39:23,635 - INFO - whatsapp_bot - Sending 1 message chunks to 558199045078@s.whatsapp.net
2025-10-07 16:39:24,388 - INFO - whatsapp_bot - Sending 1 message chunks to 558198667732@s.whatsapp.net
2025-10-07 16:39:44,859 - INFO - whatsapp_bot - Text message sent to 558198667732@s.whatsapp.net.
2025-10-07 16:39:44,860 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558198667732@s.whatsapp.net
2025-10-07 16:39:44,860 - INFO - whatsapp_bot - Saved conversation history for 558198667732_s_whatsapp_net
2025-10-07 16:39:44,861 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-07 16:39:44,861 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:39:44] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:39:47,055 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:39:47,058 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-07 16:39:47,058 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-07 16:39:47,059 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:39:47] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:39:47,479 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:39:47,486 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB0A36BBE98CB88DCA538
2025-10-07 16:39:47,487 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:39:47] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:40:06,489 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:40:06,489 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'ACE79855DB8F35DD0763F953FDDC4C27', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1759866002, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Oi', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'Q70QR5v70wezLM5hYa4oFAfF2Jq3UNwmcj2egO1QAvw='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'ACE79855DB8F35DD0763F953FDDC4C27'}}, 'timestamp': 1759866002456}
2025-10-07 16:40:06,490 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-07 16:40:06,490 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-07 16:40:06,490 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:40:06] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:40:06,499 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:40:06,500 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'ACE79855DB8F35DD0763F953FDDC4C27', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1759866002, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Oi', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'Q70QR5v70wezLM5hYa4oFAfF2Jq3UNwmcj2egO1QAvw='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'ACE79855DB8F35DD0763F953FDDC4C27'}}, 'timestamp': 1759866002460}
2025-10-07 16:40:06,500 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'ACE79855DB8F35DD0763F953FDDC4C27', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1759866002, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Oi', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'Q70QR5v70wezLM5hYa4oFAfF2Jq3UNwmcj2egO1QAvw='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'ACE79855DB8F35DD0763F953FDDC4C27'}
2025-10-07 16:40:06,501 - INFO - whatsapp_bot - Sender number: 558199045078@s.whatsapp.net
2025-10-07 16:40:06,501 - INFO - whatsapp_bot - Message content object: {'conversation': 'Oi', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': '7yydDzR4QCXTVg==', 'recipientTimestamp': '1759693137'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'Q70QR5v70wezLM5hYa4oFAfF2Jq3UNwmcj2egO1QAvw='}}
2025-10-07 16:40:06,501 - INFO - whatsapp_bot - Found conversation text: Oi
2025-10-07 16:40:06,501 - INFO - whatsapp_bot - Safe sender ID: 558199045078_s_whatsapp_net
2025-10-07 16:40:06,501 - INFO - whatsapp_bot - Processing text message: 'Oi' from 558199045078@s.whatsapp.net
2025-10-07 16:40:06,502 - INFO - whatsapp_bot - Loaded conversation history for 558199045078_s_whatsapp_net
2025-10-07 16:40:06,502 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): Oi...
2025-10-07 16:40:07,251 - INFO - whatsapp_bot - Sending 1 message chunks to 558199045078@s.whatsapp.net
2025-10-07 16:40:45,446 - INFO - whatsapp_bot - Text message sent to 558199045078@s.whatsapp.net.
2025-10-07 16:40:45,446 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558199045078@s.whatsapp.net
2025-10-07 16:40:45,447 - INFO - whatsapp_bot - Saved conversation history for 558199045078_s_whatsapp_net
2025-10-07 16:40:45,447 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-07 16:40:45,448 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:40:45] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:40:47,011 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:40:47,014 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-07 16:40:47,014 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-07 16:40:47,014 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:40:47] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:40:47,160 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:40:47,167 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB04D12BE2E9F72860233
2025-10-07 16:40:47,167 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:40:47] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:41:46,298 - INFO - whatsapp_bot - Text message sent to 558199045078@s.whatsapp.net.
2025-10-07 16:41:46,298 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558199045078@s.whatsapp.net
2025-10-07 16:41:46,311 - INFO - whatsapp_bot - Saved conversation history for 558199045078_s_whatsapp_net
2025-10-07 16:41:46,311 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-07 16:41:46,311 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:41:46] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:41:46,339 - ERROR - whatsapp_bot - WaSenderAPI Error sending text to 558199045078@s.whatsapp.net: You are on a free trial. You can send 1 message every 1 minute. (Status: 429)
2025-10-07 16:41:46,341 - ERROR - whatsapp_bot - Failed to send message chunk 1 to 558199045078@s.whatsapp.net
2025-10-07 16:41:46,354 - INFO - whatsapp_bot - Saved conversation history for 558199045078_s_whatsapp_net
2025-10-07 16:41:46,354 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-07 16:41:46,355 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:41:46] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:41:47,688 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:41:47,691 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-07 16:41:47,691 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-07 16:41:47,691 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:41:47] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:41:47,820 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:41:47,827 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB08393E3471AF79A416D
2025-10-07 16:41:47,827 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:41:47] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:43:16,156 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:43:16,156 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558198114176@s.whatsapp.net', 'fromMe': True, 'id': 'ACCE4B8364AB3033743D2E5EC5DA8071'}, 'messageTimestamp': 1759866191, 'pushName': 'Pedro Henrique', 'broadcast': False, 'status': 2, 'message': {'conversation': 'KAKAKAKAKAKAKAK'}, 'remoteJid': '558198114176@s.whatsapp.net', 'id': 'ACCE4B8364AB3033743D2E5EC5DA8071'}}, 'timestamp': 1759866192068}
2025-10-07 16:43:16,156 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558198114176@s.whatsapp.net', 'fromMe': True, 'id': 'ACCE4B8364AB3033743D2E5EC5DA8071'}, 'messageTimestamp': 1759866191, 'pushName': 'Pedro Henrique', 'broadcast': False, 'status': 2, 'message': {'conversation': 'KAKAKAKAKAKAKAK'}, 'remoteJid': '558198114176@s.whatsapp.net', 'id': 'ACCE4B8364AB3033743D2E5EC5DA8071'}
2025-10-07 16:43:16,157 - INFO - whatsapp_bot - Ignoring self-sent message: ACCE4B8364AB3033743D2E5EC5DA8071
2025-10-07 16:43:16,157 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:43:16] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:43:17,931 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:43:17,931 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558198114176@s.whatsapp.net', 'fromMe': True, 'id': 'AC96EEA96B2A22F02E00F8F6043C11B5'}, 'messageTimestamp': 1759866193, 'pushName': 'Pedro Henrique', 'broadcast': False, 'status': 2, 'message': {'conversation': 'QUE????'}, 'remoteJid': '558198114176@s.whatsapp.net', 'id': 'AC96EEA96B2A22F02E00F8F6043C11B5'}}, 'timestamp': 1759866194054}
2025-10-07 16:43:17,931 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558198114176@s.whatsapp.net', 'fromMe': True, 'id': 'AC96EEA96B2A22F02E00F8F6043C11B5'}, 'messageTimestamp': 1759866193, 'pushName': 'Pedro Henrique', 'broadcast': False, 'status': 2, 'message': {'conversation': 'QUE????'}, 'remoteJid': '558198114176@s.whatsapp.net', 'id': 'AC96EEA96B2A22F02E00F8F6043C11B5'}
2025-10-07 16:43:17,931 - INFO - whatsapp_bot - Ignoring self-sent message: AC96EEA96B2A22F02E00F8F6043C11B5
2025-10-07 16:43:17,932 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:43:17] "POST /webhook HTTP/1.1" 200 -
2025-10-07 16:43:21,903 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-07 16:43:21,904 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558198114176@s.whatsapp.net', 'fromMe': True, 'id': 'AC5D3522C41DFAFC70C37061A1FB7764'}, 'messageTimestamp': 1759866197, 'pushName': 'Pedro Henrique', 'broadcast': False, 'status': 2, 'message': {'stickerMessage': {'url': 'https://mmg.whatsapp.net/v/t62.15575-24/562118927_3711525452474916_8544318471569322399_n.enc?ccb=11-4&oh=01_Q5Aa2gEyF9V6Nzlw7sHtHF7tbCdQItNyiJWO2h49siFVDi2_yg&oe=690CEEC8&_nc_sid=5e03e0&mms3=true', 'fileSha256': 'sK5KJxTEHyzOpl6DQPbH/JO5JJGPhgh1sPd8QV06A5g=', 'fileEncSha256': 'SSzoiVUfxaePMlWRINiKYLqg3R/4Q3Y/tOeFZsa43W0=', 'mediaKey': 'yQyE0YvjchMhcYgI8H+AaUP2Mzq8XtU/UTmKf1o0fco=', 'mimetype': 'image/webp', 'directPath': '/v/t62.15575-24/562118927_3711525452474916_8544318471569322399_n.enc?ccb=11-4&oh=01_Q5Aa2gEyF9V6Nzlw7sHtHF7tbCdQItNyiJWO2h49siFVDi2_yg&oe=690CEEC8&_nc_sid=5e03e0', 'fileLength': '5404', 'mediaKeyTimestamp': '1759866196', 'isAnimated': False, 'stickerSentTs': '1759866196694', 'isAvatar': False, 'isAiSticker': False, 'isLottie': False}}, 'remoteJid': '558198114176@s.whatsapp.net', 'id': 'AC5D3522C41DFAFC70C37061A1FB7764'}}, 'timestamp': 1759866198026}
2025-10-07 16:43:21,904 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558198114176@s.whatsapp.net', 'fromMe': True, 'id': 'AC5D3522C41DFAFC70C37061A1FB7764'}, 'messageTimestamp': 1759866197, 'pushName': 'Pedro Henrique', 'broadcast': False, 'status': 2, 'message': {'stickerMessage': {'url': 'https://mmg.whatsapp.net/v/t62.15575-24/562118927_3711525452474916_8544318471569322399_n.enc?ccb=11-4&oh=01_Q5Aa2gEyF9V6Nzlw7sHtHF7tbCdQItNyiJWO2h49siFVDi2_yg&oe=690CEEC8&_nc_sid=5e03e0&mms3=true', 'fileSha256': 'sK5KJxTEHyzOpl6DQPbH/JO5JJGPhgh1sPd8QV06A5g=', 'fileEncSha256': 'SSzoiVUfxaePMlWRINiKYLqg3R/4Q3Y/tOeFZsa43W0=', 'mediaKey': 'yQyE0YvjchMhcYgI8H+AaUP2Mzq8XtU/UTmKf1o0fco=', 'mimetype': 'image/webp', 'directPath': '/v/t62.15575-24/562118927_3711525452474916_8544318471569322399_n.enc?ccb=11-4&oh=01_Q5Aa2gEyF9V6Nzlw7sHtHF7tbCdQItNyiJWO2h49siFVDi2_yg&oe=690CEEC8&_nc_sid=5e03e0', 'fileLength': '5404', 'mediaKeyTimestamp': '1759866196', 'isAnimated': False, 'stickerSentTs': '1759866196694', 'isAvatar': False, 'isAiSticker': False, 'isLottie': False}}, 'remoteJid': '558198114176@s.whatsapp.net', 'id': 'AC5D3522C41DFAFC70C37061A1FB7764'}
2025-10-07 16:43:21,904 - INFO - whatsapp_bot - Ignoring self-sent message: AC5D3522C41DFAFC70C37061A1FB7764
2025-10-07 16:43:21,905 - INFO - werkzeug - 127.0.0.1 - - [07/Oct/2025 16:43:21] "POST /webhook HTTP/1.1" 200 -
2025-10-14 16:07:18,160 - INFO - whatsapp_bot - WaSenderAPI client initialized successfully with retry support
2025-10-14 16:07:18,161 - INFO - whatsapp_bot - Gemini API client initialized successfully
2025-10-14 16:07:18,161 - WARNING - whatsapp_bot - Persona file not found at persona.json. Using default persona.
2025-10-14 16:07:18,161 - INFO - whatsapp_bot - Using persona 'Assistant'
2025-10-14 16:07:18,162 - INFO - whatsapp_bot - Gemini client initialized with model: gemini-2.0-flash
2025-10-14 16:07:18,162 - INFO - whatsapp_bot - ======================================================
2025-10-14 16:07:18,163 - INFO - whatsapp_bot -   WhatsApp Gemini Chatbot Starting
2025-10-14 16:07:18,163 - INFO - whatsapp_bot - ======================================================
2025-10-14 16:07:18,163 - INFO - whatsapp_bot - Persona: Assistant
2025-10-14 16:07:18,163 - INFO - whatsapp_bot - Gemini Model: gemini-2.0-flash
2025-10-14 16:07:18,163 - INFO - whatsapp_bot - Conversations Directory: conversations
2025-10-14 16:07:18,163 - INFO - whatsapp_bot - WaSender API Client: Initialized
2025-10-14 16:07:18,163 - INFO - whatsapp_bot - Gemini API Client: Initialized
2025-10-14 16:07:18,163 - INFO - whatsapp_bot - Starting Flask server on port 5001...
2025-10-14 16:07:18,163 - INFO - whatsapp_bot - ======================================================
2025-10-14 16:07:18,186 - INFO - werkzeug - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5001
 * Running on http://192.168.68.119:5001
2025-10-14 16:07:18,187 - INFO - werkzeug - [33mPress CTRL+C to quit[0m
2025-10-14 16:10:24,568 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 16:10:24,569 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'ACF2FFB1435FD378A99499B13ADD626E', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1760469005, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'extendedTextMessage': {'text': 'Boa tarde', 'previewType': 'NONE', 'contextInfo': {'entryPointConversionSource': 'contact_card', 'entryPointConversionApp': 'whatsapp', 'entryPointConversionDelaySeconds': 9}, 'inviteLinkGroupTypeV2': 'DEFAULT'}, 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': '3AcoF2Sxs1Q2gAif7JdRL6YSWgJ63zaUiGKkOika2wE='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'ACF2FFB1435FD378A99499B13ADD626E'}}, 'timestamp': 1760469006071}
2025-10-14 16:10:24,569 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-14 16:10:24,569 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 16:10:24,570 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 16:10:24] "POST /webhook HTTP/1.1" 200 -
2025-10-14 16:10:24,575 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 16:10:24,575 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'ACF2FFB1435FD378A99499B13ADD626E', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1760469005, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'extendedTextMessage': {'text': 'Boa tarde', 'previewType': 'NONE', 'contextInfo': {'entryPointConversionSource': 'contact_card', 'entryPointConversionApp': 'whatsapp', 'entryPointConversionDelaySeconds': 9}, 'inviteLinkGroupTypeV2': 'DEFAULT'}, 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': '3AcoF2Sxs1Q2gAif7JdRL6YSWgJ63zaUiGKkOika2wE='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'ACF2FFB1435FD378A99499B13ADD626E'}}, 'timestamp': 1760469006072}
2025-10-14 16:10:24,576 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'ACF2FFB1435FD378A99499B13ADD626E', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1760469005, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'extendedTextMessage': {'text': 'Boa tarde', 'previewType': 'NONE', 'contextInfo': {'entryPointConversionSource': 'contact_card', 'entryPointConversionApp': 'whatsapp', 'entryPointConversionDelaySeconds': 9}, 'inviteLinkGroupTypeV2': 'DEFAULT'}, 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': '3AcoF2Sxs1Q2gAif7JdRL6YSWgJ63zaUiGKkOika2wE='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'ACF2FFB1435FD378A99499B13ADD626E'}
2025-10-14 16:10:24,576 - INFO - whatsapp_bot - Sender number: 558199045078@s.whatsapp.net
2025-10-14 16:10:24,576 - INFO - whatsapp_bot - Message content object: {'extendedTextMessage': {'text': 'Boa tarde', 'previewType': 'NONE', 'contextInfo': {'entryPointConversionSource': 'contact_card', 'entryPointConversionApp': 'whatsapp', 'entryPointConversionDelaySeconds': 9}, 'inviteLinkGroupTypeV2': 'DEFAULT'}, 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': '3AcoF2Sxs1Q2gAif7JdRL6YSWgJ63zaUiGKkOika2wE='}}
2025-10-14 16:10:24,576 - INFO - whatsapp_bot - Found extended text: Boa tarde
2025-10-14 16:10:24,577 - INFO - whatsapp_bot - Safe sender ID: 558199045078_s_whatsapp_net
2025-10-14 16:10:24,577 - INFO - whatsapp_bot - Processing text message: 'Boa tarde' from 558199045078@s.whatsapp.net
2025-10-14 16:10:24,587 - INFO - whatsapp_bot - Loaded conversation history for 558199045078_s_whatsapp_net
2025-10-14 16:10:24,588 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): Boa tarde...
2025-10-14 16:10:25,526 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 16:10:25,626 - INFO - whatsapp_bot - Ignoring self-sent message: A5841F91D5F5B461AC33DF1401E33F66
2025-10-14 16:10:25,627 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 16:10:25] "POST /webhook HTTP/1.1" 200 -
2025-10-14 16:10:25,709 - INFO - whatsapp_bot - Sending 1 message chunks to 558199045078@s.whatsapp.net
2025-10-14 16:10:26,492 - INFO - whatsapp_bot - Text message sent to 558199045078@s.whatsapp.net.
2025-10-14 16:10:26,492 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558199045078@s.whatsapp.net
2025-10-14 16:10:26,494 - INFO - whatsapp_bot - Saved conversation history for 558199045078_s_whatsapp_net
2025-10-14 16:10:26,494 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 16:10:26,494 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 16:10:26] "POST /webhook HTTP/1.1" 200 -
2025-10-14 16:10:28,212 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 16:10:28,215 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-14 16:10:28,215 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 16:10:28,215 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 16:10:28] "POST /webhook HTTP/1.1" 200 -
2025-10-14 16:10:28,365 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 16:10:28,372 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB09C0B7A1633B3D58EEE
2025-10-14 16:10:28,372 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 16:10:28] "POST /webhook HTTP/1.1" 200 -
2025-10-14 16:10:43,327 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 16:10:43,327 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB05B2B3B4E0BB9B2D949'}, 'messageTimestamp': 1760469024, 'pushName': 'GGDISK tica', 'broadcast': False, 'status': 2, 'message': {'conversation': 'BOA TARDE'}, 'verifiedBizName': 'GGDISK tica', 'remoteJid': '558199045078@s.whatsapp.net', 'id': '3EB05B2B3B4E0BB9B2D949'}}, 'timestamp': 1760469024890}
2025-10-14 16:10:43,328 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB05B2B3B4E0BB9B2D949'}, 'messageTimestamp': 1760469024, 'pushName': 'GGDISK tica', 'broadcast': False, 'status': 2, 'message': {'conversation': 'BOA TARDE'}, 'verifiedBizName': 'GGDISK tica', 'remoteJid': '558199045078@s.whatsapp.net', 'id': '3EB05B2B3B4E0BB9B2D949'}
2025-10-14 16:10:43,328 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB05B2B3B4E0BB9B2D949
2025-10-14 16:10:43,328 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 16:10:43] "POST /webhook HTTP/1.1" 200 -
2025-10-14 16:10:50,756 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 16:10:50,756 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB09CBDA7C93EBB9C852D'}, 'messageTimestamp': 1760469032, 'pushName': 'GGDISK tica', 'broadcast': False, 'status': 2, 'message': {'conversation': 'Tudo bem'}, 'verifiedBizName': 'GGDISK tica', 'remoteJid': '558199045078@s.whatsapp.net', 'id': '3EB09CBDA7C93EBB9C852D'}}, 'timestamp': 1760469032321}
2025-10-14 16:10:50,756 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB09CBDA7C93EBB9C852D'}, 'messageTimestamp': 1760469032, 'pushName': 'GGDISK tica', 'broadcast': False, 'status': 2, 'message': {'conversation': 'Tudo bem'}, 'verifiedBizName': 'GGDISK tica', 'remoteJid': '558199045078@s.whatsapp.net', 'id': '3EB09CBDA7C93EBB9C852D'}
2025-10-14 16:10:50,757 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB09CBDA7C93EBB9C852D
2025-10-14 16:10:50,757 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 16:10:50] "POST /webhook HTTP/1.1" 200 -
2025-10-14 16:10:57,894 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 16:10:57,895 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB0B081073837A87C8A53'}, 'messageTimestamp': 1760469039, 'pushName': 'GGDISK tica', 'broadcast': False, 'status': 2, 'message': {'conversation': 'segue os testes'}, 'verifiedBizName': 'GGDISK tica', 'remoteJid': '558199045078@s.whatsapp.net', 'id': '3EB0B081073837A87C8A53'}}, 'timestamp': 1760469039463}
2025-10-14 16:10:57,895 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB0B081073837A87C8A53'}, 'messageTimestamp': 1760469039, 'pushName': 'GGDISK tica', 'broadcast': False, 'status': 2, 'message': {'conversation': 'segue os testes'}, 'verifiedBizName': 'GGDISK tica', 'remoteJid': '558199045078@s.whatsapp.net', 'id': '3EB0B081073837A87C8A53'}
2025-10-14 16:10:57,895 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB0B081073837A87C8A53
2025-10-14 16:10:57,895 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 16:10:57] "POST /webhook HTTP/1.1" 200 -
2025-10-14 16:12:23,753 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 16:12:23,754 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC6ED77888559BE689D100A2E7DFED2D', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1760469125, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Que teste?', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': '8RljNU0wulUyMlpAe/7oAWbNeRa6GLd0Y3O5yiqXhYc='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC6ED77888559BE689D100A2E7DFED2D'}}, 'timestamp': 1760469125297}
2025-10-14 16:12:23,754 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 16:12:23,754 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC6ED77888559BE689D100A2E7DFED2D', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1760469125, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Que teste?', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': '8RljNU0wulUyMlpAe/7oAWbNeRa6GLd0Y3O5yiqXhYc='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC6ED77888559BE689D100A2E7DFED2D'}
2025-10-14 16:12:23,754 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC6ED77888559BE689D100A2E7DFED2D', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1760469125, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Que teste?', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': '8RljNU0wulUyMlpAe/7oAWbNeRa6GLd0Y3O5yiqXhYc='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC6ED77888559BE689D100A2E7DFED2D'}}, 'timestamp': 1760469125295}
2025-10-14 16:12:23,754 - INFO - whatsapp_bot - Sender number: 558199045078@s.whatsapp.net
2025-10-14 16:12:23,755 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-14 16:12:23,755 - INFO - whatsapp_bot - Message content object: {'conversation': 'Que teste?', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': '8RljNU0wulUyMlpAe/7oAWbNeRa6GLd0Y3O5yiqXhYc='}}
2025-10-14 16:12:23,755 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 16:12:23,755 - INFO - whatsapp_bot - Found conversation text: Que teste?
2025-10-14 16:12:23,755 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 16:12:23] "POST /webhook HTTP/1.1" 200 -
2025-10-14 16:12:23,755 - INFO - whatsapp_bot - Safe sender ID: 558199045078_s_whatsapp_net
2025-10-14 16:12:23,756 - INFO - whatsapp_bot - Processing text message: 'Que teste?' from 558199045078@s.whatsapp.net
2025-10-14 16:12:23,764 - INFO - whatsapp_bot - Loaded conversation history for 558199045078_s_whatsapp_net
2025-10-14 16:12:23,764 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): Que teste?...
2025-10-14 16:12:24,729 - INFO - whatsapp_bot - Sending 1 message chunks to 558199045078@s.whatsapp.net
2025-10-14 16:12:24,729 - INFO - whatsapp_bot - Sending chunk 1/1: Que tipo de teste voc quer saber? 
 Pode ser test...
2025-10-14 16:12:25,301 - INFO - whatsapp_bot - Text message sent to 558199045078@s.whatsapp.net.
2025-10-14 16:12:25,301 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558199045078@s.whatsapp.net
2025-10-14 16:12:25,302 - INFO - whatsapp_bot - Saved conversation history for 558199045078_s_whatsapp_net
2025-10-14 16:12:25,303 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 16:12:25,303 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 16:12:25] "POST /webhook HTTP/1.1" 200 -
2025-10-14 16:12:26,917 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 16:12:26,921 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-14 16:12:26,921 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 16:12:26,921 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 16:12:26] "POST /webhook HTTP/1.1" 200 -
2025-10-14 16:12:27,073 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 16:12:27,079 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB083BF2676FE6C88C0F7
2025-10-14 16:12:27,079 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 16:12:27] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:10:20,761 - INFO - whatsapp_bot - WaSenderAPI client initialized successfully with retry support
2025-10-14 17:10:20,761 - INFO - whatsapp_bot - Gemini API client initialized successfully
2025-10-14 17:10:20,763 - INFO - whatsapp_bot - Successfully loaded persona: Pedro
2025-10-14 17:10:20,763 - INFO - whatsapp_bot - Using persona 'Pedro'
2025-10-14 17:10:20,763 - INFO - whatsapp_bot - Gemini client initialized with model: gemini-2.0-flash
2025-10-14 17:10:20,764 - INFO - whatsapp_bot - ======================================================
2025-10-14 17:10:20,764 - INFO - whatsapp_bot -   WhatsApp Gemini Chatbot Starting
2025-10-14 17:10:20,765 - INFO - whatsapp_bot - ======================================================
2025-10-14 17:10:20,765 - INFO - whatsapp_bot - Persona: Pedro
2025-10-14 17:10:20,765 - INFO - whatsapp_bot - Gemini Model: gemini-2.0-flash
2025-10-14 17:10:20,765 - INFO - whatsapp_bot - Conversations Directory: conversations
2025-10-14 17:10:20,765 - INFO - whatsapp_bot - WaSender API Client: Initialized
2025-10-14 17:10:20,765 - INFO - whatsapp_bot - Gemini API Client: Initialized
2025-10-14 17:10:20,765 - INFO - whatsapp_bot - Starting Flask server on port 5001...
2025-10-14 17:10:20,765 - INFO - whatsapp_bot - ======================================================
2025-10-14 17:10:20,773 - INFO - werkzeug - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5001
 * Running on http://192.168.68.119:5001
2025-10-14 17:10:20,773 - INFO - werkzeug - [33mPress CTRL+C to quit[0m
2025-10-14 17:10:44,754 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:10:44,755 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC2E307727D33919C60851DA5298BA41', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1760472626, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Qual seu nome', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'OQ+Tk8PypDJbvE5oYX05q3aERLtROzurn3YBZyIUb7U='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC2E307727D33919C60851DA5298BA41'}}, 'timestamp': 1760472626347}
2025-10-14 17:10:44,755 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-14 17:10:44,755 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 17:10:44,756 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:10:44] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:10:44,760 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:10:44,760 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC2E307727D33919C60851DA5298BA41', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1760472626, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Qual seu nome', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'OQ+Tk8PypDJbvE5oYX05q3aERLtROzurn3YBZyIUb7U='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC2E307727D33919C60851DA5298BA41'}}, 'timestamp': 1760472626348}
2025-10-14 17:10:44,760 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC2E307727D33919C60851DA5298BA41', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1760472626, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Qual seu nome', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'OQ+Tk8PypDJbvE5oYX05q3aERLtROzurn3YBZyIUb7U='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC2E307727D33919C60851DA5298BA41'}
2025-10-14 17:10:44,761 - INFO - whatsapp_bot - Sender number: 558199045078@s.whatsapp.net
2025-10-14 17:10:44,761 - INFO - whatsapp_bot - Message content object: {'conversation': 'Qual seu nome', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'OQ+Tk8PypDJbvE5oYX05q3aERLtROzurn3YBZyIUb7U='}}
2025-10-14 17:10:44,761 - INFO - whatsapp_bot - Found conversation text: Qual seu nome
2025-10-14 17:10:44,761 - INFO - whatsapp_bot - Safe sender ID: 558199045078_s_whatsapp_net
2025-10-14 17:10:44,761 - INFO - whatsapp_bot - Processing text message: 'Qual seu nome' from 558199045078@s.whatsapp.net
2025-10-14 17:10:44,770 - INFO - whatsapp_bot - Loaded conversation history for 558199045078_s_whatsapp_net
2025-10-14 17:10:44,770 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): Qual seu nome...
2025-10-14 17:10:45,984 - INFO - whatsapp_bot - Sending 1 message chunks to 558199045078@s.whatsapp.net
2025-10-14 17:10:45,985 - INFO - whatsapp_bot - Sending chunk 1/1: Eu sou um modelo de linguagem grande, treinado pel...
2025-10-14 17:10:46,731 - INFO - whatsapp_bot - Text message sent to 558199045078@s.whatsapp.net.
2025-10-14 17:10:46,732 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558199045078@s.whatsapp.net
2025-10-14 17:10:46,733 - INFO - whatsapp_bot - Saved conversation history for 558199045078_s_whatsapp_net
2025-10-14 17:10:46,733 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 17:10:46,733 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:10:46] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:10:48,452 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:10:48,455 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-14 17:10:48,455 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 17:10:48,456 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:10:48] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:10:48,614 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:10:48,622 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB0F7253157E68D783BFD
2025-10-14 17:10:48,622 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:10:48] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:11:02,386 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:11:02,386 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'ACD1C6D38FC2B048B436DA4BD400537C', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1760472643, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Ggdiskotica', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': '/vBiGGySGfgFHXiKPZEbVNb6Tmvxh/erodiRLPNa1+E='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'ACD1C6D38FC2B048B436DA4BD400537C'}}, 'timestamp': 1760472644026}
2025-10-14 17:11:02,386 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:11:02,387 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-14 17:11:02,387 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'ACD1C6D38FC2B048B436DA4BD400537C', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1760472643, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Ggdiskotica', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': '/vBiGGySGfgFHXiKPZEbVNb6Tmvxh/erodiRLPNa1+E='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'ACD1C6D38FC2B048B436DA4BD400537C'}}, 'timestamp': 1760472644028}
2025-10-14 17:11:02,387 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 17:11:02,387 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'ACD1C6D38FC2B048B436DA4BD400537C', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1760472643, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Ggdiskotica', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': '/vBiGGySGfgFHXiKPZEbVNb6Tmvxh/erodiRLPNa1+E='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'ACD1C6D38FC2B048B436DA4BD400537C'}
2025-10-14 17:11:02,387 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:11:02] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:11:02,387 - INFO - whatsapp_bot - Sender number: 558199045078@s.whatsapp.net
2025-10-14 17:11:02,388 - INFO - whatsapp_bot - Message content object: {'conversation': 'Ggdiskotica', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': '/vBiGGySGfgFHXiKPZEbVNb6Tmvxh/erodiRLPNa1+E='}}
2025-10-14 17:11:02,388 - INFO - whatsapp_bot - Found conversation text: Ggdiskotica
2025-10-14 17:11:02,388 - INFO - whatsapp_bot - Safe sender ID: 558199045078_s_whatsapp_net
2025-10-14 17:11:02,388 - INFO - whatsapp_bot - Processing text message: 'Ggdiskotica' from 558199045078@s.whatsapp.net
2025-10-14 17:11:02,395 - INFO - whatsapp_bot - Loaded conversation history for 558199045078_s_whatsapp_net
2025-10-14 17:11:02,396 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): Ggdiskotica...
2025-10-14 17:11:03,622 - INFO - whatsapp_bot - Gemini reply: Voc quis dizer GGDISK tica? Se sim, sou Pedro, o atendente virtual da GGDISK tica. Estou aqui para ajudar com qualquer dvida ou problema relacionado aos nossos servios. Como posso te ajudar hoje?
2025-10-14 17:11:03,623 - INFO - whatsapp_bot - Sending 1 message chunks to 558199045078@s.whatsapp.net
2025-10-14 17:11:03,623 - INFO - whatsapp_bot - Sending chunk 1/1: Voc quis dizer GGDISK tica? Se sim, sou Pedro, o...
2025-10-14 17:11:04,198 - INFO - whatsapp_bot - Text message sent to 558199045078@s.whatsapp.net.
2025-10-14 17:11:04,198 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558199045078@s.whatsapp.net
2025-10-14 17:11:04,200 - INFO - whatsapp_bot - Saved conversation history for 558199045078_s_whatsapp_net
2025-10-14 17:11:04,200 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 17:11:04,200 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:11:04] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:11:06,686 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:11:06,686 - INFO - whatsapp_bot - Received webhook data: {'event': 'message.sent', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'jid': '558199045078@s.whatsapp.net', 'msgId': 6968478, 'success': True, 'result': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB07BC68DDD0E12373429'}, 'message': {'extendedTextMessage': {'text': 'Voc quis dizer GGDISK tica? Se sim, sou Pedro, o atendente virtual da GGDISK tica. Estou aqui\npara ajudar com qualquer dvida ou problema relacionado aos nossos servios. Como posso te ajudar\nhoje?'}}, 'messageTimestamp': '1760472648', 'status': 'PENDING'}}, 'timestamp': 1760472648382}
2025-10-14 17:11:06,687 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-14 17:11:06,687 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 17:11:06,687 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:11:06] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:11:06,841 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:11:06,841 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB07BC68DDD0E12373429', 'msgId': 6968478}, 'message': {'extendedTextMessage': {'text': 'Voc quis dizer GGDISK tica? Se sim, sou Pedro, o atendente virtual da GGDISK tica. Estou aqui\npara ajudar com qualquer dvida ou problema relacionado aos nossos servios. Como posso te ajudar\nhoje?'}}, 'messageTimestamp': {'low': 1760472648, 'high': 0, 'unsigned': True}, 'status': 1, 'remoteJid': '558199045078@s.whatsapp.net', 'id': '3EB07BC68DDD0E12373429'}}, 'timestamp': 1760472648540}
2025-10-14 17:11:06,842 - INFO - whatsapp_bot - Processing message info: {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB07BC68DDD0E12373429', 'msgId': 6968478}, 'message': {'extendedTextMessage': {'text': 'Voc quis dizer GGDISK tica? Se sim, sou Pedro, o atendente virtual da GGDISK tica. Estou aqui\npara ajudar com qualquer dvida ou problema relacionado aos nossos servios. Como posso te ajudar\nhoje?'}}, 'messageTimestamp': {'low': 1760472648, 'high': 0, 'unsigned': True}, 'status': 1, 'remoteJid': '558199045078@s.whatsapp.net', 'id': '3EB07BC68DDD0E12373429'}
2025-10-14 17:11:06,842 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB07BC68DDD0E12373429
2025-10-14 17:11:06,842 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:11:06] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:17:01,726 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:17:01,726 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC550FFE8AD33738D5B0F3C6819B7352', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1760473003, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Sim', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': '/532RjMJQRyxdlUTC96JgYKdWee55G1tVG/YwIaotxk='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC550FFE8AD33738D5B0F3C6819B7352'}}, 'timestamp': 1760473003337}
2025-10-14 17:17:01,726 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC550FFE8AD33738D5B0F3C6819B7352', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1760473003, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Sim', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': '/532RjMJQRyxdlUTC96JgYKdWee55G1tVG/YwIaotxk='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC550FFE8AD33738D5B0F3C6819B7352'}
2025-10-14 17:17:01,727 - INFO - whatsapp_bot - Sender number: 558199045078@s.whatsapp.net
2025-10-14 17:17:01,727 - INFO - whatsapp_bot - Message content object: {'conversation': 'Sim', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': '/532RjMJQRyxdlUTC96JgYKdWee55G1tVG/YwIaotxk='}}
2025-10-14 17:17:01,727 - INFO - whatsapp_bot - Found conversation text: Sim
2025-10-14 17:17:01,727 - INFO - whatsapp_bot - Safe sender ID: 558199045078_s_whatsapp_net
2025-10-14 17:17:01,727 - INFO - whatsapp_bot - Processing text message: 'Sim' from 558199045078@s.whatsapp.net
2025-10-14 17:17:01,730 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:17:01,730 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC550FFE8AD33738D5B0F3C6819B7352', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1760473003, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Sim', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': '/532RjMJQRyxdlUTC96JgYKdWee55G1tVG/YwIaotxk='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC550FFE8AD33738D5B0F3C6819B7352'}}, 'timestamp': 1760473003336}
2025-10-14 17:17:01,730 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-14 17:17:01,730 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 17:17:01,730 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:17:01] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:17:01,737 - INFO - whatsapp_bot - Loaded conversation history for 558199045078_s_whatsapp_net
2025-10-14 17:17:01,737 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): Sim...
2025-10-14 17:17:02,935 - INFO - whatsapp_bot - Sending 1 message chunks to 558199045078@s.whatsapp.net
2025-10-14 17:17:02,935 - INFO - whatsapp_bot - Sending chunk 1/1: timo! Em que posso te ajudar em relao  GGDISK ...
2025-10-14 17:17:03,592 - INFO - whatsapp_bot - Text message sent to 558199045078@s.whatsapp.net.
2025-10-14 17:17:03,593 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558199045078@s.whatsapp.net
2025-10-14 17:17:03,594 - INFO - whatsapp_bot - Saved conversation history for 558199045078_s_whatsapp_net
2025-10-14 17:17:03,594 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 17:17:03,594 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:17:03] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:17:05,119 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:17:05,122 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-14 17:17:05,122 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 17:17:05,122 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:17:05] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:17:05,280 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:17:05,286 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB040874449AAE6F6BB3B
2025-10-14 17:17:05,286 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:17:05] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:17:11,003 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:17:11,004 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': 'ACECF4CC2A212F6080D2584F682508CD', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1760473011, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'extendedTextMessage': {'text': 'Oi', 'previewType': 'NONE', 'contextInfo': {'entryPointConversionSource': 'global_search_new_chat', 'entryPointConversionApp': 'whatsapp', 'entryPointConversionDelaySeconds': 4051}, 'inviteLinkGroupTypeV2': 'DEFAULT'}, 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': '7jWnDXz4+s8BgEi6MpKs+GsVOPW5tQEzhVVBt+VqIgs='}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': 'ACECF4CC2A212F6080D2584F682508CD'}}, 'timestamp': 1760473012654}
2025-10-14 17:17:11,004 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': 'ACECF4CC2A212F6080D2584F682508CD', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1760473011, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'extendedTextMessage': {'text': 'Oi', 'previewType': 'NONE', 'contextInfo': {'entryPointConversionSource': 'global_search_new_chat', 'entryPointConversionApp': 'whatsapp', 'entryPointConversionDelaySeconds': 4051}, 'inviteLinkGroupTypeV2': 'DEFAULT'}, 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': '7jWnDXz4+s8BgEi6MpKs+GsVOPW5tQEzhVVBt+VqIgs='}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': 'ACECF4CC2A212F6080D2584F682508CD'}
2025-10-14 17:17:11,005 - INFO - whatsapp_bot - Sender number: 558186732159@s.whatsapp.net
2025-10-14 17:17:11,005 - INFO - whatsapp_bot - Message content object: {'extendedTextMessage': {'text': 'Oi', 'previewType': 'NONE', 'contextInfo': {'entryPointConversionSource': 'global_search_new_chat', 'entryPointConversionApp': 'whatsapp', 'entryPointConversionDelaySeconds': 4051}, 'inviteLinkGroupTypeV2': 'DEFAULT'}, 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': '7jWnDXz4+s8BgEi6MpKs+GsVOPW5tQEzhVVBt+VqIgs='}}
2025-10-14 17:17:11,005 - INFO - whatsapp_bot - Found extended text: Oi
2025-10-14 17:17:11,005 - INFO - whatsapp_bot - Safe sender ID: 558186732159_s_whatsapp_net
2025-10-14 17:17:11,005 - INFO - whatsapp_bot - Processing text message: 'Oi' from 558186732159@s.whatsapp.net
2025-10-14 17:17:11,008 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:17:11,009 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': 'ACECF4CC2A212F6080D2584F682508CD', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1760473011, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'extendedTextMessage': {'text': 'Oi', 'previewType': 'NONE', 'contextInfo': {'entryPointConversionSource': 'global_search_new_chat', 'entryPointConversionApp': 'whatsapp', 'entryPointConversionDelaySeconds': 4051}, 'inviteLinkGroupTypeV2': 'DEFAULT'}, 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': '7jWnDXz4+s8BgEi6MpKs+GsVOPW5tQEzhVVBt+VqIgs='}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': 'ACECF4CC2A212F6080D2584F682508CD'}}, 'timestamp': 1760473012652}
2025-10-14 17:17:11,009 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-14 17:17:11,009 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 17:17:11,009 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:17:11] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:17:11,014 - INFO - whatsapp_bot - Loaded conversation history for 558186732159_s_whatsapp_net
2025-10-14 17:17:11,014 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): Oi...
2025-10-14 17:17:11,931 - INFO - whatsapp_bot - Sending 1 message chunks to 558186732159@s.whatsapp.net
2025-10-14 17:17:12,106 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:17:12,112 - INFO - whatsapp_bot - Ignoring self-sent message: A59BFBD76A5952A73F2F7816BE2EC6C8
2025-10-14 17:17:12,112 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:17:12] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:17:12,594 - INFO - whatsapp_bot - Text message sent to 558186732159@s.whatsapp.net.
2025-10-14 17:17:12,594 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558186732159@s.whatsapp.net
2025-10-14 17:17:12,595 - INFO - whatsapp_bot - Saved conversation history for 558186732159_s_whatsapp_net
2025-10-14 17:17:12,595 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 17:17:12,596 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:17:12] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:17:14,163 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:17:14,166 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-14 17:17:14,166 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 17:17:14,166 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:17:14] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:17:14,393 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:17:14,399 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB040E81430368F8124E6
2025-10-14 17:17:14,399 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:17:14] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:17:23,695 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:17:23,695 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC9B424C53C53870435E3006DD11A2E1', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1760473025, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Que horas t aberto?', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': '4srw1hasarCO2ulUBNFZECFHSVovCRTcZJlc3n99gQE='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC9B424C53C53870435E3006DD11A2E1'}}, 'timestamp': 1760473025344}
2025-10-14 17:17:23,695 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:17:23,696 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC9B424C53C53870435E3006DD11A2E1', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1760473025, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Que horas t aberto?', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': '4srw1hasarCO2ulUBNFZECFHSVovCRTcZJlc3n99gQE='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC9B424C53C53870435E3006DD11A2E1'}
2025-10-14 17:17:23,696 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC9B424C53C53870435E3006DD11A2E1', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1760473025, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Que horas t aberto?', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': '4srw1hasarCO2ulUBNFZECFHSVovCRTcZJlc3n99gQE='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC9B424C53C53870435E3006DD11A2E1'}}, 'timestamp': 1760473025342}
2025-10-14 17:17:23,696 - INFO - whatsapp_bot - Sender number: 558199045078@s.whatsapp.net
2025-10-14 17:17:23,696 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-14 17:17:23,696 - INFO - whatsapp_bot - Message content object: {'conversation': 'Que horas t aberto?', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': '4srw1hasarCO2ulUBNFZECFHSVovCRTcZJlc3n99gQE='}}
2025-10-14 17:17:23,696 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 17:17:23,697 - INFO - whatsapp_bot - Found conversation text: Que horas t aberto?
2025-10-14 17:17:23,697 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:17:23] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:17:23,697 - INFO - whatsapp_bot - Safe sender ID: 558199045078_s_whatsapp_net
2025-10-14 17:17:23,698 - INFO - whatsapp_bot - Processing text message: 'Que horas t aberto?' from 558199045078@s.whatsapp.net
2025-10-14 17:17:23,704 - INFO - whatsapp_bot - Loaded conversation history for 558199045078_s_whatsapp_net
2025-10-14 17:17:23,705 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): Que horas t aberto?...
2025-10-14 17:17:25,638 - INFO - whatsapp_bot - Sending 5 message chunks to 558199045078@s.whatsapp.net
2025-10-14 17:17:25,638 - INFO - whatsapp_bot - Sending chunk 1/5: Para te dar a informao mais precisa sobre o hor...
2025-10-14 17:17:26,255 - INFO - whatsapp_bot - Text message sent to 558199045078@s.whatsapp.net.
2025-10-14 17:17:26,256 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558199045078@s.whatsapp.net
2025-10-14 17:17:26,256 - INFO - whatsapp_bot - Waiting 6.1 seconds before next chunk...
2025-10-14 17:17:27,172 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:17:27,173 - INFO - whatsapp_bot - Received webhook data: {'event': 'message.sent', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'jid': '558199045078@s.whatsapp.net', 'msgId': 6969204, 'success': True, 'result': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB08D09E28B796DB355B1'}, 'message': {'extendedTextMessage': {'text': 'Para te dar a informao mais precisa sobre o horrio de funcionamento da GGDISK tica, preciso\nsaber qual unidade voc est procurando.'}}, 'messageTimestamp': '1760473028', 'status': 'PENDING'}}, 'timestamp': 1760473028873}
2025-10-14 17:17:27,173 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-14 17:17:27,173 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 17:17:27,173 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:17:27] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:17:27,391 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:17:27,391 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB08D09E28B796DB355B1', 'msgId': 6969204}, 'message': {'extendedTextMessage': {'text': 'Para te dar a informao mais precisa sobre o horrio de funcionamento da GGDISK tica, preciso\nsaber qual unidade voc est procurando.'}}, 'messageTimestamp': {'low': 1760473028, 'high': 0, 'unsigned': True}, 'status': 1, 'remoteJid': '558199045078@s.whatsapp.net', 'id': '3EB08D09E28B796DB355B1'}}, 'timestamp': 1760473029032}
2025-10-14 17:17:27,391 - INFO - whatsapp_bot - Processing message info: {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB08D09E28B796DB355B1', 'msgId': 6969204}, 'message': {'extendedTextMessage': {'text': 'Para te dar a informao mais precisa sobre o horrio de funcionamento da GGDISK tica, preciso\nsaber qual unidade voc est procurando.'}}, 'messageTimestamp': {'low': 1760473028, 'high': 0, 'unsigned': True}, 'status': 1, 'remoteJid': '558199045078@s.whatsapp.net', 'id': '3EB08D09E28B796DB355B1'}
2025-10-14 17:17:27,392 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB08D09E28B796DB355B1
2025-10-14 17:17:27,392 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:17:27] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:17:32,402 - INFO - whatsapp_bot - Sending chunk 2/5: Voc pode me dizer qual  a cidade e o bairro da G...
2025-10-14 17:17:32,978 - INFO - whatsapp_bot - Text message sent to 558199045078@s.whatsapp.net.
2025-10-14 17:17:32,978 - INFO - whatsapp_bot - Successfully sent chunk 2 to 558199045078@s.whatsapp.net
2025-10-14 17:17:32,978 - INFO - whatsapp_bot - Waiting 5.7 seconds before next chunk...
2025-10-14 17:17:34,273 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:17:34,274 - INFO - whatsapp_bot - Received webhook data: {'event': 'message.sent', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'jid': '558199045078@s.whatsapp.net', 'msgId': 6969221, 'success': True, 'result': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB00CAEE72BFC1BFD8723'}, 'message': {'extendedTextMessage': {'text': 'Voc pode me dizer qual  a cidade e o bairro da GGDISK tica que voc tem interesse? Assim, posso\nverificar o horrio de funcionamento para voc.'}}, 'messageTimestamp': '1760473035', 'status': 'PENDING'}}, 'timestamp': 1760473035920}
2025-10-14 17:17:34,274 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-14 17:17:34,274 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 17:17:34,274 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:17:34] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:17:34,423 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:17:34,423 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB00CAEE72BFC1BFD8723', 'msgId': 6969221}, 'message': {'extendedTextMessage': {'text': 'Voc pode me dizer qual  a cidade e o bairro da GGDISK tica que voc tem interesse? Assim, posso\nverificar o horrio de funcionamento para voc.'}}, 'messageTimestamp': {'low': 1760473035, 'high': 0, 'unsigned': True}, 'status': 1, 'remoteJid': '558199045078@s.whatsapp.net', 'id': '3EB00CAEE72BFC1BFD8723'}}, 'timestamp': 1760473036078}
2025-10-14 17:17:34,423 - INFO - whatsapp_bot - Processing message info: {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB00CAEE72BFC1BFD8723', 'msgId': 6969221}, 'message': {'extendedTextMessage': {'text': 'Voc pode me dizer qual  a cidade e o bairro da GGDISK tica que voc tem interesse? Assim, posso\nverificar o horrio de funcionamento para voc.'}}, 'messageTimestamp': {'low': 1760473035, 'high': 0, 'unsigned': True}, 'status': 1, 'remoteJid': '558199045078@s.whatsapp.net', 'id': '3EB00CAEE72BFC1BFD8723'}
2025-10-14 17:17:34,423 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB00CAEE72BFC1BFD8723
2025-10-14 17:17:34,424 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:17:34] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:17:37,859 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:17:37,860 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': 'ACE320D331973EC95D0A4ECA332843B3', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1760473039, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'conversation': 'Preciso fazer um oramento', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'sfHrjo6ScuM7fTa57ezTq9Ww55kAOWcXiC6bnd9Sp00='}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': 'ACE320D331973EC95D0A4ECA332843B3'}}, 'timestamp': 1760473039567}
2025-10-14 17:17:37,860 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:17:37,860 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-14 17:17:37,860 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': 'ACE320D331973EC95D0A4ECA332843B3', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1760473039, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'conversation': 'Preciso fazer um oramento', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'sfHrjo6ScuM7fTa57ezTq9Ww55kAOWcXiC6bnd9Sp00='}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': 'ACE320D331973EC95D0A4ECA332843B3'}}, 'timestamp': 1760473039567}
2025-10-14 17:17:37,860 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 17:17:37,860 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': 'ACE320D331973EC95D0A4ECA332843B3', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1760473039, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'conversation': 'Preciso fazer um oramento', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'sfHrjo6ScuM7fTa57ezTq9Ww55kAOWcXiC6bnd9Sp00='}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': 'ACE320D331973EC95D0A4ECA332843B3'}
2025-10-14 17:17:37,860 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:17:37] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:17:37,861 - INFO - whatsapp_bot - Sender number: 558186732159@s.whatsapp.net
2025-10-14 17:17:37,861 - INFO - whatsapp_bot - Message content object: {'conversation': 'Preciso fazer um oramento', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'sfHrjo6ScuM7fTa57ezTq9Ww55kAOWcXiC6bnd9Sp00='}}
2025-10-14 17:17:37,861 - INFO - whatsapp_bot - Found conversation text: Preciso fazer um oramento
2025-10-14 17:17:37,861 - INFO - whatsapp_bot - Safe sender ID: 558186732159_s_whatsapp_net
2025-10-14 17:17:37,862 - INFO - whatsapp_bot - Processing text message: 'Preciso fazer um oramento' from 558186732159@s.whatsapp.net
2025-10-14 17:17:37,869 - INFO - whatsapp_bot - Loaded conversation history for 558186732159_s_whatsapp_net
2025-10-14 17:17:37,869 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): Preciso fazer um oramento...
2025-10-14 17:17:38,658 - INFO - whatsapp_bot - Sending chunk 3/5: Se preferir, voc tambm pode:

* **Consultar o Go...
2025-10-14 17:17:39,221 - INFO - whatsapp_bot - Sending 1 message chunks to 558186732159@s.whatsapp.net
2025-10-14 17:17:39,221 - INFO - whatsapp_bot - Sending chunk 1/1: Entendi! Para te ajudar com o oramento, preciso d...
2025-10-14 17:17:39,230 - INFO - whatsapp_bot - Text message sent to 558199045078@s.whatsapp.net.
2025-10-14 17:17:39,231 - INFO - whatsapp_bot - Successfully sent chunk 3 to 558199045078@s.whatsapp.net
2025-10-14 17:17:39,231 - INFO - whatsapp_bot - Waiting 5.8 seconds before next chunk...
2025-10-14 17:17:40,705 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:17:40,705 - INFO - whatsapp_bot - Received webhook data: {'event': 'message.sent', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'jid': '558199045078@s.whatsapp.net', 'msgId': 6969235, 'success': True, 'result': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB0B67E3F56B33D9785FF'}, 'message': {'extendedTextMessage': {'text': 'Se preferir, voc tambm pode:\n\n* **Consultar o Google Maps:** Procure por "GGDISK tica" no Google Maps e veja os horrios de'}}, 'messageTimestamp': '1760473042', 'status': 'PENDING'}}, 'timestamp': 1760473042409}
2025-10-14 17:17:40,705 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-14 17:17:40,705 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 17:17:40,705 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:17:40] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:17:40,935 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:17:40,935 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB0B67E3F56B33D9785FF', 'msgId': 6969235}, 'message': {'extendedTextMessage': {'text': 'Se preferir, voc tambm pode:\n\n* **Consultar o Google Maps:** Procure por "GGDISK tica" no Google Maps e veja os horrios de'}}, 'messageTimestamp': {'low': 1760473042, 'high': 0, 'unsigned': True}, 'status': 1, 'remoteJid': '558199045078@s.whatsapp.net', 'id': '3EB0B67E3F56B33D9785FF'}}, 'timestamp': 1760473042584}
2025-10-14 17:17:40,935 - INFO - whatsapp_bot - Processing message info: {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB0B67E3F56B33D9785FF', 'msgId': 6969235}, 'message': {'extendedTextMessage': {'text': 'Se preferir, voc tambm pode:\n\n* **Consultar o Google Maps:** Procure por "GGDISK tica" no Google Maps e veja os horrios de'}}, 'messageTimestamp': {'low': 1760473042, 'high': 0, 'unsigned': True}, 'status': 1, 'remoteJid': '558199045078@s.whatsapp.net', 'id': '3EB0B67E3F56B33D9785FF'}
2025-10-14 17:17:40,936 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB0B67E3F56B33D9785FF
2025-10-14 17:17:40,936 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:17:40] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:17:44,998 - INFO - whatsapp_bot - Sending chunk 4/5: funcionamento da unidade mais prxima de voc.
* *...
2025-10-14 17:17:45,362 - INFO - whatsapp_bot - Text message sent to 558186732159@s.whatsapp.net.
2025-10-14 17:17:45,362 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558186732159@s.whatsapp.net
2025-10-14 17:17:45,363 - INFO - whatsapp_bot - Saved conversation history for 558186732159_s_whatsapp_net
2025-10-14 17:17:45,363 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 17:17:45,363 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:17:45] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:17:46,624 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:17:46,628 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-14 17:17:46,628 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 17:17:46,628 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:17:46] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:17:46,934 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:17:46,942 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB03A8A2D6909A62010BC
2025-10-14 17:17:46,942 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:17:46] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:17:51,138 - INFO - whatsapp_bot - Text message sent to 558199045078@s.whatsapp.net.
2025-10-14 17:17:51,138 - INFO - whatsapp_bot - Successfully sent chunk 4 to 558199045078@s.whatsapp.net
2025-10-14 17:17:51,138 - INFO - whatsapp_bot - Waiting 6.4 seconds before next chunk...
2025-10-14 17:17:52,734 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:17:52,735 - INFO - whatsapp_bot - Received webhook data: {'event': 'message.sent', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'jid': '558199045078@s.whatsapp.net', 'msgId': 6969265, 'success': True, 'result': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB089E85B422607C17B2D'}, 'message': {'extendedTextMessage': {'text': 'funcionamento da unidade mais prxima de voc.\n* **Visitar o site da GGDISK tica:** Geralmente, o site oficial da loja tem informaes sobre os\nhorrios de funcionamento de todas as unidades.'}}, 'messageTimestamp': '1760473054', 'status': 'PENDING'}}, 'timestamp': 1760473054371}
2025-10-14 17:17:52,735 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-14 17:17:52,735 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 17:17:52,735 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:17:52] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:17:52,878 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:17:52,878 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB089E85B422607C17B2D', 'msgId': 6969265}, 'message': {'extendedTextMessage': {'text': 'funcionamento da unidade mais prxima de voc.\n* **Visitar o site da GGDISK tica:** Geralmente, o site oficial da loja tem informaes sobre os\nhorrios de funcionamento de todas as unidades.'}}, 'messageTimestamp': {'low': 1760473054, 'high': 0, 'unsigned': True}, 'status': 1, 'remoteJid': '558199045078@s.whatsapp.net', 'id': '3EB089E85B422607C17B2D'}}, 'timestamp': 1760473054528}
2025-10-14 17:17:52,879 - INFO - whatsapp_bot - Processing message info: {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB089E85B422607C17B2D', 'msgId': 6969265}, 'message': {'extendedTextMessage': {'text': 'funcionamento da unidade mais prxima de voc.\n* **Visitar o site da GGDISK tica:** Geralmente, o site oficial da loja tem informaes sobre os\nhorrios de funcionamento de todas as unidades.'}}, 'messageTimestamp': {'low': 1760473054, 'high': 0, 'unsigned': True}, 'status': 1, 'remoteJid': '558199045078@s.whatsapp.net', 'id': '3EB089E85B422607C17B2D'}
2025-10-14 17:17:52,879 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB089E85B422607C17B2D
2025-10-14 17:17:52,879 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:17:52] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:17:58,098 - INFO - whatsapp_bot - Text message sent to 558199045078@s.whatsapp.net.
2025-10-14 17:17:58,098 - INFO - whatsapp_bot - Successfully sent chunk 5 to 558199045078@s.whatsapp.net
2025-10-14 17:17:58,099 - INFO - whatsapp_bot - Saved conversation history for 558199045078_s_whatsapp_net
2025-10-14 17:17:58,099 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 17:17:58,100 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:17:58] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:17:59,150 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:17:59,154 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-14 17:17:59,154 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 17:17:59,155 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:17:59] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:17:59,370 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:17:59,376 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB0D42A194E322DAAD6F6
2025-10-14 17:17:59,376 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:17:59] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:18:29,723 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:18:29,723 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': 'AC3604CABEB6CE8AEB86D3B22DB0B105', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1760473091, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'conversation': 'Eu gostaria de ver', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': '7iMCTKkA0GaYjDohKiFV/gMor22I6fhlsyuqFv2DrhQ='}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': 'AC3604CABEB6CE8AEB86D3B22DB0B105'}}, 'timestamp': 1760473091325}
2025-10-14 17:18:29,724 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:18:29,724 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': 'AC3604CABEB6CE8AEB86D3B22DB0B105', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1760473091, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'conversation': 'Eu gostaria de ver', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': '7iMCTKkA0GaYjDohKiFV/gMor22I6fhlsyuqFv2DrhQ='}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': 'AC3604CABEB6CE8AEB86D3B22DB0B105'}
2025-10-14 17:18:29,724 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': 'AC3604CABEB6CE8AEB86D3B22DB0B105', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1760473091, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'conversation': 'Eu gostaria de ver', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': '7iMCTKkA0GaYjDohKiFV/gMor22I6fhlsyuqFv2DrhQ='}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': 'AC3604CABEB6CE8AEB86D3B22DB0B105'}}, 'timestamp': 1760473091324}
2025-10-14 17:18:29,724 - INFO - whatsapp_bot - Sender number: 558186732159@s.whatsapp.net
2025-10-14 17:18:29,724 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-14 17:18:29,725 - INFO - whatsapp_bot - Message content object: {'conversation': 'Eu gostaria de ver', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': '7iMCTKkA0GaYjDohKiFV/gMor22I6fhlsyuqFv2DrhQ='}}
2025-10-14 17:18:29,725 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 17:18:29,725 - INFO - whatsapp_bot - Found conversation text: Eu gostaria de ver
2025-10-14 17:18:29,725 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:18:29] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:18:29,725 - INFO - whatsapp_bot - Safe sender ID: 558186732159_s_whatsapp_net
2025-10-14 17:18:29,726 - INFO - whatsapp_bot - Processing text message: 'Eu gostaria de ver' from 558186732159@s.whatsapp.net
2025-10-14 17:18:29,733 - INFO - whatsapp_bot - Loaded conversation history for 558186732159_s_whatsapp_net
2025-10-14 17:18:29,733 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): Eu gostaria de ver...
2025-10-14 17:18:31,251 - INFO - whatsapp_bot - Sending 3 message chunks to 558186732159@s.whatsapp.net
2025-10-14 17:18:31,251 - INFO - whatsapp_bot - Sending chunk 1/3: timo! Para te mostrar as opes de armaes, prec...
2025-10-14 17:18:31,860 - INFO - whatsapp_bot - Text message sent to 558186732159@s.whatsapp.net.
2025-10-14 17:18:31,860 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558186732159@s.whatsapp.net
2025-10-14 17:18:31,860 - INFO - whatsapp_bot - Waiting 7.0 seconds before next chunk...
2025-10-14 17:18:34,197 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:18:34,198 - INFO - whatsapp_bot - Received webhook data: {'event': 'message.sent', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'jid': '558186732159@s.whatsapp.net', 'msgId': 6969373, 'success': True, 'result': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': True, 'id': '3EB05038D79BDDAFF20B6C'}, 'message': {'extendedTextMessage': {'text': 'timo! Para te mostrar as opes de armaes, preciso entender um pouco suas preferncias. Voc\nprefere:'}}, 'messageTimestamp': '1760473095', 'status': 'PENDING'}}, 'timestamp': 1760473095901}
2025-10-14 17:18:34,198 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-14 17:18:34,198 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 17:18:34,198 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:18:34] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:18:34,479 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:18:34,480 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': True, 'id': '3EB05038D79BDDAFF20B6C', 'msgId': 6969373}, 'message': {'extendedTextMessage': {'text': 'timo! Para te mostrar as opes de armaes, preciso entender um pouco suas preferncias. Voc\nprefere:'}}, 'messageTimestamp': {'low': 1760473095, 'high': 0, 'unsigned': True}, 'status': 2, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB05038D79BDDAFF20B6C'}}, 'timestamp': 1760473096127}
2025-10-14 17:18:34,480 - INFO - whatsapp_bot - Processing message info: {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': True, 'id': '3EB05038D79BDDAFF20B6C', 'msgId': 6969373}, 'message': {'extendedTextMessage': {'text': 'timo! Para te mostrar as opes de armaes, preciso entender um pouco suas preferncias. Voc\nprefere:'}}, 'messageTimestamp': {'low': 1760473095, 'high': 0, 'unsigned': True}, 'status': 2, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB05038D79BDDAFF20B6C'}
2025-10-14 17:18:34,480 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB05038D79BDDAFF20B6C
2025-10-14 17:18:34,481 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:18:34] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:18:38,848 - INFO - whatsapp_bot - Sending chunk 2/3: *   **Estilo:** Mais clssico, moderno, esportivo,...
2025-10-14 17:18:39,418 - INFO - whatsapp_bot - Text message sent to 558186732159@s.whatsapp.net.
2025-10-14 17:18:39,418 - INFO - whatsapp_bot - Successfully sent chunk 2 to 558186732159@s.whatsapp.net
2025-10-14 17:18:39,418 - INFO - whatsapp_bot - Waiting 5.3 seconds before next chunk...
2025-10-14 17:18:40,747 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:18:40,747 - INFO - whatsapp_bot - Received webhook data: {'event': 'message.sent', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'jid': '558186732159@s.whatsapp.net', 'msgId': 6969389, 'success': True, 'result': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': True, 'id': '3EB0047D8DCC2FDAAF6373'}, 'message': {'extendedTextMessage': {'text': '*   **Estilo:** Mais clssico, moderno, esportivo, retr?\n*   **Material:** Acetato (plstico), metal, ou outro?\n*   **Formato:** Redonda, quadrada, aviador, gatinho, etc.?'}}, 'messageTimestamp': '1760473102', 'status': 'PENDING'}}, 'timestamp': 1760473102399}
2025-10-14 17:18:40,748 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-14 17:18:40,748 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 17:18:40,748 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:18:40] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:18:41,016 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:18:41,017 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': True, 'id': '3EB0047D8DCC2FDAAF6373', 'msgId': 6969389}, 'message': {'extendedTextMessage': {'text': '*   **Estilo:** Mais clssico, moderno, esportivo, retr?\n*   **Material:** Acetato (plstico), metal, ou outro?\n*   **Formato:** Redonda, quadrada, aviador, gatinho, etc.?'}}, 'messageTimestamp': {'low': 1760473102, 'high': 0, 'unsigned': True}, 'status': 1, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB0047D8DCC2FDAAF6373'}}, 'timestamp': 1760473102658}
2025-10-14 17:18:41,017 - INFO - whatsapp_bot - Processing message info: {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': True, 'id': '3EB0047D8DCC2FDAAF6373', 'msgId': 6969389}, 'message': {'extendedTextMessage': {'text': '*   **Estilo:** Mais clssico, moderno, esportivo, retr?\n*   **Material:** Acetato (plstico), metal, ou outro?\n*   **Formato:** Redonda, quadrada, aviador, gatinho, etc.?'}}, 'messageTimestamp': {'low': 1760473102, 'high': 0, 'unsigned': True}, 'status': 1, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB0047D8DCC2FDAAF6373'}
2025-10-14 17:18:41,017 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB0047D8DCC2FDAAF6373
2025-10-14 17:18:41,018 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:18:41] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:18:44,692 - INFO - whatsapp_bot - Sending chunk 3/3: *   **Cor:** Tem alguma cor preferida?

Quanto mai...
2025-10-14 17:18:45,512 - INFO - whatsapp_bot - Text message sent to 558186732159@s.whatsapp.net.
2025-10-14 17:18:45,512 - INFO - whatsapp_bot - Successfully sent chunk 3 to 558186732159@s.whatsapp.net
2025-10-14 17:18:45,513 - INFO - whatsapp_bot - Saved conversation history for 558186732159_s_whatsapp_net
2025-10-14 17:18:45,513 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 17:18:45,513 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:18:45] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:18:46,433 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:18:46,436 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-14 17:18:46,436 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 17:18:46,436 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:18:46] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:18:46,735 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:18:46,741 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB01E5AE97DF24AECD8B5
2025-10-14 17:18:46,741 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:18:46] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:21:07,907 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:21:07,907 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': '3EB0C42687198284589255', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1760473249, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'conversation': 'formato redondo e cor verde', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': '3CkOo6QacBPLGw==', 'recipientTimestamp': '1757535415'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'SIsWWxxQNbd63OxKwLFEVHdz8Cc1Qt/1vkG46C0ssSk='}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB0C42687198284589255'}}, 'timestamp': 1760473249538}
2025-10-14 17:21:07,907 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': '3EB0C42687198284589255', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1760473249, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'conversation': 'formato redondo e cor verde', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': '3CkOo6QacBPLGw==', 'recipientTimestamp': '1757535415'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'SIsWWxxQNbd63OxKwLFEVHdz8Cc1Qt/1vkG46C0ssSk='}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB0C42687198284589255'}
2025-10-14 17:21:07,907 - INFO - whatsapp_bot - Sender number: 558186732159@s.whatsapp.net
2025-10-14 17:21:07,908 - INFO - whatsapp_bot - Message content object: {'conversation': 'formato redondo e cor verde', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': '3CkOo6QacBPLGw==', 'recipientTimestamp': '1757535415'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'SIsWWxxQNbd63OxKwLFEVHdz8Cc1Qt/1vkG46C0ssSk='}}
2025-10-14 17:21:07,908 - INFO - whatsapp_bot - Found conversation text: formato redondo e cor verde
2025-10-14 17:21:07,908 - INFO - whatsapp_bot - Safe sender ID: 558186732159_s_whatsapp_net
2025-10-14 17:21:07,908 - INFO - whatsapp_bot - Processing text message: 'formato redondo e cor verde' from 558186732159@s.whatsapp.net
2025-10-14 17:21:07,912 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:21:07,912 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': '3EB0C42687198284589255', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1760473249, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'conversation': 'formato redondo e cor verde', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': '3CkOo6QacBPLGw==', 'recipientTimestamp': '1757535415'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'SIsWWxxQNbd63OxKwLFEVHdz8Cc1Qt/1vkG46C0ssSk='}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB0C42687198284589255'}}, 'timestamp': 1760473249537}
2025-10-14 17:21:07,912 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-14 17:21:07,912 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 17:21:07,912 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:21:07] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:21:07,918 - INFO - whatsapp_bot - Loaded conversation history for 558186732159_s_whatsapp_net
2025-10-14 17:21:07,918 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): formato redondo e cor verde...
2025-10-14 17:21:10,075 - INFO - whatsapp_bot - Sending 6 message chunks to 558186732159@s.whatsapp.net
2025-10-14 17:21:10,661 - INFO - whatsapp_bot - Text message sent to 558186732159@s.whatsapp.net.
2025-10-14 17:21:10,661 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558186732159@s.whatsapp.net
2025-10-14 17:21:10,661 - INFO - whatsapp_bot - Waiting 5.9 seconds before next chunk...
2025-10-14 17:21:11,878 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:21:11,882 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-14 17:21:11,882 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 17:21:11,882 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:21:11] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:21:12,201 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:21:12,209 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB019A08476E78B9F4020
2025-10-14 17:21:12,209 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:21:12] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:21:16,526 - INFO - whatsapp_bot - Sending chunk 2/6: tipo um verde musgo? E quanto ao material, prefere...
2025-10-14 17:21:17,101 - INFO - whatsapp_bot - Text message sent to 558186732159@s.whatsapp.net.
2025-10-14 17:21:17,101 - INFO - whatsapp_bot - Successfully sent chunk 2 to 558186732159@s.whatsapp.net
2025-10-14 17:21:17,101 - INFO - whatsapp_bot - Waiting 5.2 seconds before next chunk...
2025-10-14 17:21:18,530 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:21:18,530 - INFO - whatsapp_bot - Received webhook data: {'event': 'message.sent', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'jid': '558186732159@s.whatsapp.net', 'msgId': 6969745, 'success': True, 'result': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': True, 'id': '3EB0A60B0173CBB0C12EF0'}, 'message': {'extendedTextMessage': {'text': 'tipo um verde musgo? E quanto ao material, prefere acetato (plstico) ou metal?\n\nEnquanto isso, vou te mostrar algumas opes que j se encaixam na sua descrio:'}}, 'messageTimestamp': '1760473260', 'status': 'PENDING'}}, 'timestamp': 1760473260181}
2025-10-14 17:21:18,530 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-14 17:21:18,530 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 17:21:18,530 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:21:18] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:21:18,807 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:21:18,808 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': True, 'id': '3EB0A60B0173CBB0C12EF0', 'msgId': 6969745}, 'message': {'extendedTextMessage': {'text': 'tipo um verde musgo? E quanto ao material, prefere acetato (plstico) ou metal?\n\nEnquanto isso, vou te mostrar algumas opes que j se encaixam na sua descrio:'}}, 'messageTimestamp': {'low': 1760473260, 'high': 0, 'unsigned': True}, 'status': 1, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB0A60B0173CBB0C12EF0'}}, 'timestamp': 1760473260455}
2025-10-14 17:21:18,808 - INFO - whatsapp_bot - Processing message info: {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': True, 'id': '3EB0A60B0173CBB0C12EF0', 'msgId': 6969745}, 'message': {'extendedTextMessage': {'text': 'tipo um verde musgo? E quanto ao material, prefere acetato (plstico) ou metal?\n\nEnquanto isso, vou te mostrar algumas opes que j se encaixam na sua descrio:'}}, 'messageTimestamp': {'low': 1760473260, 'high': 0, 'unsigned': True}, 'status': 1, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB0A60B0173CBB0C12EF0'}
2025-10-14 17:21:18,808 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB0A60B0173CBB0C12EF0
2025-10-14 17:21:18,809 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:21:18] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:21:22,306 - INFO - whatsapp_bot - Sending chunk 3/6: 
**Opo 1: Armao Redonda em Acetato Verde Musgo...
2025-10-14 17:21:22,888 - INFO - whatsapp_bot - Text message sent to 558186732159@s.whatsapp.net.
2025-10-14 17:21:22,888 - INFO - whatsapp_bot - Successfully sent chunk 3 to 558186732159@s.whatsapp.net
2025-10-14 17:21:22,888 - INFO - whatsapp_bot - Waiting 6.5 seconds before next chunk...
2025-10-14 17:21:24,407 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:21:24,407 - INFO - whatsapp_bot - Received webhook data: {'event': 'message.sent', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'jid': '558186732159@s.whatsapp.net', 'msgId': 6969760, 'success': True, 'result': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': True, 'id': '3EB0EDBD0A8AC17AC2F4E2'}, 'message': {'extendedTextMessage': {'text': '**Opo 1: Armao Redonda em Acetato Verde Musgo**'}}, 'messageTimestamp': '1760473266', 'status': 'PENDING'}}, 'timestamp': 1760473266058}
2025-10-14 17:21:24,407 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-14 17:21:24,407 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 17:21:24,407 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:21:24] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:21:24,678 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:21:24,678 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': True, 'id': '3EB0EDBD0A8AC17AC2F4E2', 'msgId': 6969760}, 'message': {'extendedTextMessage': {'text': '**Opo 1: Armao Redonda em Acetato Verde Musgo**'}}, 'messageTimestamp': {'low': 1760473266, 'high': 0, 'unsigned': True}, 'status': 1, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB0EDBD0A8AC17AC2F4E2'}}, 'timestamp': 1760473266326}
2025-10-14 17:21:24,678 - INFO - whatsapp_bot - Processing message info: {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': True, 'id': '3EB0EDBD0A8AC17AC2F4E2', 'msgId': 6969760}, 'message': {'extendedTextMessage': {'text': '**Opo 1: Armao Redonda em Acetato Verde Musgo**'}}, 'messageTimestamp': {'low': 1760473266, 'high': 0, 'unsigned': True}, 'status': 1, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB0EDBD0A8AC17AC2F4E2'}
2025-10-14 17:21:24,678 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB0EDBD0A8AC17AC2F4E2
2025-10-14 17:21:24,678 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:21:24] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:21:29,404 - INFO - whatsapp_bot - Sending chunk 4/6: [Aqui deveria ter um link ou uma descrio de uma ...
2025-10-14 17:21:29,981 - INFO - whatsapp_bot - Text message sent to 558186732159@s.whatsapp.net.
2025-10-14 17:21:29,981 - INFO - whatsapp_bot - Successfully sent chunk 4 to 558186732159@s.whatsapp.net
2025-10-14 17:21:29,982 - INFO - whatsapp_bot - Waiting 5.6 seconds before next chunk...
2025-10-14 17:21:31,410 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:21:31,410 - INFO - whatsapp_bot - Received webhook data: {'event': 'message.sent', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'jid': '558186732159@s.whatsapp.net', 'msgId': 6969777, 'success': True, 'result': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': True, 'id': '3EB080F2476C18AE1802A2'}, 'message': {'extendedTextMessage': {'text': '[Aqui deveria ter um link ou uma descrio de uma armao especfica com essas caractersticas]\n\n**Opo 2: Armao Redonda em Metal Verde gua**'}}, 'messageTimestamp': '1760473273', 'status': 'PENDING'}}, 'timestamp': 1760473273061}
2025-10-14 17:21:31,411 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-14 17:21:31,411 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 17:21:31,411 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:21:31] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:21:31,677 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:21:31,677 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': True, 'id': '3EB080F2476C18AE1802A2', 'msgId': 6969777}, 'message': {'extendedTextMessage': {'text': '[Aqui deveria ter um link ou uma descrio de uma armao especfica com essas caractersticas]\n\n**Opo 2: Armao Redonda em Metal Verde gua**'}}, 'messageTimestamp': {'low': 1760473273, 'high': 0, 'unsigned': True}, 'status': 1, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB080F2476C18AE1802A2'}}, 'timestamp': 1760473273332}
2025-10-14 17:21:31,677 - INFO - whatsapp_bot - Processing message info: {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': True, 'id': '3EB080F2476C18AE1802A2', 'msgId': 6969777}, 'message': {'extendedTextMessage': {'text': '[Aqui deveria ter um link ou uma descrio de uma armao especfica com essas caractersticas]\n\n**Opo 2: Armao Redonda em Metal Verde gua**'}}, 'messageTimestamp': {'low': 1760473273, 'high': 0, 'unsigned': True}, 'status': 1, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB080F2476C18AE1802A2'}
2025-10-14 17:21:31,677 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB080F2476C18AE1802A2
2025-10-14 17:21:31,677 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:21:31] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:21:35,568 - INFO - whatsapp_bot - Sending chunk 5/6: 
[Aqui deveria ter um link ou uma descrio de uma...
2025-10-14 17:21:36,140 - INFO - whatsapp_bot - Text message sent to 558186732159@s.whatsapp.net.
2025-10-14 17:21:36,140 - INFO - whatsapp_bot - Successfully sent chunk 5 to 558186732159@s.whatsapp.net
2025-10-14 17:21:36,140 - INFO - whatsapp_bot - Waiting 5.0 seconds before next chunk...
2025-10-14 17:21:37,305 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:21:37,305 - INFO - whatsapp_bot - Received webhook data: {'event': 'message.sent', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'jid': '558186732159@s.whatsapp.net', 'msgId': 6969786, 'success': True, 'result': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': True, 'id': '3EB0E6518C63B25FAE81E6'}, 'message': {'extendedTextMessage': {'text': '[Aqui deveria ter um link ou uma descrio de uma armao especfica com essas caractersticas]'}}, 'messageTimestamp': '1760473278', 'status': 'PENDING'}}, 'timestamp': 1760473278953}
2025-10-14 17:21:37,305 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-14 17:21:37,305 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 17:21:37,305 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:21:37] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:21:37,563 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:21:37,564 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': True, 'id': '3EB0E6518C63B25FAE81E6', 'msgId': 6969786}, 'message': {'extendedTextMessage': {'text': '[Aqui deveria ter um link ou uma descrio de uma armao especfica com essas caractersticas]'}}, 'messageTimestamp': {'low': 1760473278, 'high': 0, 'unsigned': True}, 'status': 1, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB0E6518C63B25FAE81E6'}}, 'timestamp': 1760473279219}
2025-10-14 17:21:37,564 - INFO - whatsapp_bot - Processing message info: {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': True, 'id': '3EB0E6518C63B25FAE81E6', 'msgId': 6969786}, 'message': {'extendedTextMessage': {'text': '[Aqui deveria ter um link ou uma descrio de uma armao especfica com essas caractersticas]'}}, 'messageTimestamp': {'low': 1760473278, 'high': 0, 'unsigned': True}, 'status': 1, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB0E6518C63B25FAE81E6'}
2025-10-14 17:21:37,564 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB0E6518C63B25FAE81E6
2025-10-14 17:21:37,565 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:21:37] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:21:41,162 - INFO - whatsapp_bot - Sending chunk 6/6: Me diga o que voc acha dessas opes e se te agra...
2025-10-14 17:21:41,756 - INFO - whatsapp_bot - Text message sent to 558186732159@s.whatsapp.net.
2025-10-14 17:21:41,756 - INFO - whatsapp_bot - Successfully sent chunk 6 to 558186732159@s.whatsapp.net
2025-10-14 17:21:41,757 - INFO - whatsapp_bot - Saved conversation history for 558186732159_s_whatsapp_net
2025-10-14 17:21:41,758 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 17:21:41,758 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:21:41] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:21:43,162 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:21:43,165 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-14 17:21:43,165 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-14 17:21:43,165 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:21:43] "POST /webhook HTTP/1.1" 200 -
2025-10-14 17:21:43,490 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-14 17:21:43,497 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB0C7290E2F4D84B4340A
2025-10-14 17:21:43,497 - INFO - werkzeug - 127.0.0.1 - - [14/Oct/2025 17:21:43] "POST /webhook HTTP/1.1" 200 -
2025-10-15 15:52:44,432 - INFO - whatsapp_bot - WaSenderAPI client initialized successfully with retry support
2025-10-15 15:52:44,433 - INFO - whatsapp_bot - Gemini API client initialized successfully
2025-10-15 15:52:44,434 - ERROR - whatsapp_bot - An unexpected error occurred while loading persona: 'charmap' codec can't decode byte 0x8d in position 1092: character maps to <undefined>. Using default persona.
2025-10-15 15:52:44,434 - INFO - whatsapp_bot - Using persona 'Assistant'
2025-10-15 15:52:44,434 - INFO - whatsapp_bot - Gemini client initialized with model: gemini-2.0-flash
2025-10-15 15:52:44,435 - INFO - whatsapp_bot - ======================================================
2025-10-15 15:52:44,435 - INFO - whatsapp_bot -   WhatsApp Gemini Chatbot Starting
2025-10-15 15:52:44,435 - INFO - whatsapp_bot - ======================================================
2025-10-15 15:52:44,436 - INFO - whatsapp_bot - Persona: Assistant
2025-10-15 15:52:44,436 - INFO - whatsapp_bot - Gemini Model: gemini-2.0-flash
2025-10-15 15:52:44,436 - INFO - whatsapp_bot - Conversations Directory: conversations
2025-10-15 15:52:44,436 - INFO - whatsapp_bot - WaSender API Client: Initialized
2025-10-15 15:52:44,436 - INFO - whatsapp_bot - Gemini API Client: Initialized
2025-10-15 15:52:44,436 - INFO - whatsapp_bot - Starting Flask server on port 5001...
2025-10-15 15:52:44,436 - INFO - whatsapp_bot - ======================================================
2025-10-15 15:52:44,446 - INFO - werkzeug - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5001
 * Running on http://192.168.68.119:5001
2025-10-15 15:52:44,447 - INFO - werkzeug - [33mPress CTRL+C to quit[0m
2025-10-15 15:53:30,471 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 15:53:30,473 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': '3F11F4275A76C95E17F2', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1760554390, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'extendedTextMessage': {'text': 'Boa tarde, qual endereo da tica', 'contextInfo': {'expiration': 0, 'ephemeralSettingTimestamp': '0', 'disappearingMode': {'initiator': 'CHANGED_IN_CHAT'}}}, 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': '3F11F4275A76C95E17F2'}}, 'timestamp': 1760554390322}
2025-10-15 15:53:30,473 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': '3F11F4275A76C95E17F2', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1760554390, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'extendedTextMessage': {'text': 'Boa tarde, qual endereo da tica', 'contextInfo': {'expiration': 0, 'ephemeralSettingTimestamp': '0', 'disappearingMode': {'initiator': 'CHANGED_IN_CHAT'}}}, 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': '3F11F4275A76C95E17F2'}
2025-10-15 15:53:30,474 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 15:53:30,474 - INFO - whatsapp_bot - Sender number: 558199045078@s.whatsapp.net
2025-10-15 15:53:30,474 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': '3F11F4275A76C95E17F2', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1760554390, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'extendedTextMessage': {'text': 'Boa tarde, qual endereo da tica', 'contextInfo': {'expiration': 0, 'ephemeralSettingTimestamp': '0', 'disappearingMode': {'initiator': 'CHANGED_IN_CHAT'}}}, 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': '3F11F4275A76C95E17F2'}}, 'timestamp': 1760554390321}
2025-10-15 15:53:30,474 - INFO - whatsapp_bot - Message content object: {'extendedTextMessage': {'text': 'Boa tarde, qual endereo da tica', 'contextInfo': {'expiration': 0, 'ephemeralSettingTimestamp': '0', 'disappearingMode': {'initiator': 'CHANGED_IN_CHAT'}}}, 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2}}
2025-10-15 15:53:30,474 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-15 15:53:30,475 - INFO - whatsapp_bot - Found extended text: Boa tarde, qual endereo da tica
2025-10-15 15:53:30,475 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 15:53:30,475 - INFO - whatsapp_bot - Safe sender ID: 558199045078_s_whatsapp_net
2025-10-15 15:53:30,475 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 15:53:30] "POST /webhook HTTP/1.1" 200 -
2025-10-15 15:53:30,476 - INFO - whatsapp_bot - Processing text message: 'Boa tarde, qual endereo da tica' from 558199045078@s.whatsapp.net
2025-10-15 15:53:30,476 - INFO - whatsapp_bot - Loaded conversation history for 558199045078_s_whatsapp_net
2025-10-15 15:53:30,476 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): Boa tarde, qual endereo da tica...
2025-10-15 15:53:31,681 - INFO - whatsapp_bot - Gemini reply: Boa tarde! 
 
 Nosso endereo  Rua XV de Novembro, 123.
2025-10-15 15:53:31,682 - INFO - whatsapp_bot - Sending 1 message chunks to 558199045078@s.whatsapp.net
2025-10-15 15:53:31,682 - INFO - whatsapp_bot - Sending chunk 1/1: Boa tarde! 

 Nosso endereo  Rua XV de Novembro,...
2025-10-15 15:53:32,791 - INFO - whatsapp_bot - Text message sent to 558199045078@s.whatsapp.net.
2025-10-15 15:53:32,791 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558199045078@s.whatsapp.net
2025-10-15 15:53:32,793 - INFO - whatsapp_bot - Saved conversation history for 558199045078_s_whatsapp_net
2025-10-15 15:53:32,793 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 15:53:32,793 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 15:53:32] "POST /webhook HTTP/1.1" 200 -
2025-10-15 15:53:34,214 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 15:53:34,214 - INFO - whatsapp_bot - Received webhook data: {'event': 'message.sent', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'jid': '558199045078@s.whatsapp.net', 'msgId': 7106792, 'success': True, 'result': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB0CBD23C7A646B43EEEE'}, 'message': {'extendedTextMessage': {'text': 'Boa tarde! \n\n Nosso endereo  Rua XV de Novembro, 123.'}}, 'messageTimestamp': '1760554394', 'status': 'PENDING'}}, 'timestamp': 1760554394167}
2025-10-15 15:53:34,214 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-15 15:53:34,214 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 15:53:34,215 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 15:53:34] "POST /webhook HTTP/1.1" 200 -
2025-10-15 15:53:34,351 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 15:53:34,352 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB0CBD23C7A646B43EEEE', 'msgId': 7106792}, 'message': {'extendedTextMessage': {'text': 'Boa tarde! \n\n Nosso endereo  Rua XV de Novembro, 123.'}}, 'messageTimestamp': {'low': 1760554394, 'high': 0, 'unsigned': True}, 'status': 1, 'remoteJid': '558199045078@s.whatsapp.net', 'id': '3EB0CBD23C7A646B43EEEE'}}, 'timestamp': 1760554394305}
2025-10-15 15:53:34,352 - INFO - whatsapp_bot - Processing message info: {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB0CBD23C7A646B43EEEE', 'msgId': 7106792}, 'message': {'extendedTextMessage': {'text': 'Boa tarde! \n\n Nosso endereo  Rua XV de Novembro, 123.'}}, 'messageTimestamp': {'low': 1760554394, 'high': 0, 'unsigned': True}, 'status': 1, 'remoteJid': '558199045078@s.whatsapp.net', 'id': '3EB0CBD23C7A646B43EEEE'}
2025-10-15 15:53:34,352 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB0CBD23C7A646B43EEEE
2025-10-15 15:53:34,353 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 15:53:34] "POST /webhook HTTP/1.1" 200 -
2025-10-15 15:55:10,758 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 15:55:10,758 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': 'ACFF8A7E0A643EE0D77507D9B8E4DA93', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1760554490, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'conversation': 'Me passa o contato de josimar', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'jyTjIbC/rlygK829PxAyNW6sFVgyvPSf8CWKmxVMVH0='}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': 'ACFF8A7E0A643EE0D77507D9B8E4DA93'}}, 'timestamp': 1760554490597}
2025-10-15 15:55:10,759 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-15 15:55:10,759 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 15:55:10,759 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 15:55:10] "POST /webhook HTTP/1.1" 200 -
2025-10-15 15:55:10,761 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 15:55:10,761 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': 'ACFF8A7E0A643EE0D77507D9B8E4DA93', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1760554490, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'conversation': 'Me passa o contato de josimar', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'jyTjIbC/rlygK829PxAyNW6sFVgyvPSf8CWKmxVMVH0='}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': 'ACFF8A7E0A643EE0D77507D9B8E4DA93'}}, 'timestamp': 1760554490598}
2025-10-15 15:55:10,761 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': 'ACFF8A7E0A643EE0D77507D9B8E4DA93', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1760554490, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'conversation': 'Me passa o contato de josimar', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'jyTjIbC/rlygK829PxAyNW6sFVgyvPSf8CWKmxVMVH0='}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': 'ACFF8A7E0A643EE0D77507D9B8E4DA93'}
2025-10-15 15:55:10,762 - INFO - whatsapp_bot - Sender number: 558186732159@s.whatsapp.net
2025-10-15 15:55:10,762 - INFO - whatsapp_bot - Message content object: {'conversation': 'Me passa o contato de josimar', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'jyTjIbC/rlygK829PxAyNW6sFVgyvPSf8CWKmxVMVH0='}}
2025-10-15 15:55:10,762 - INFO - whatsapp_bot - Found conversation text: Me passa o contato de josimar
2025-10-15 15:55:10,762 - INFO - whatsapp_bot - Safe sender ID: 558186732159_s_whatsapp_net
2025-10-15 15:55:10,762 - INFO - whatsapp_bot - Processing text message: 'Me passa o contato de josimar' from 558186732159@s.whatsapp.net
2025-10-15 15:55:10,763 - INFO - whatsapp_bot - Loaded conversation history for 558186732159_s_whatsapp_net
2025-10-15 15:55:10,763 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): Me passa o contato de josimar...
2025-10-15 15:55:11,845 - INFO - whatsapp_bot - Sending 2 message chunks to 558186732159@s.whatsapp.net
2025-10-15 15:55:12,471 - INFO - whatsapp_bot - Text message sent to 558186732159@s.whatsapp.net.
2025-10-15 15:55:12,471 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558186732159@s.whatsapp.net
2025-10-15 15:55:12,471 - INFO - whatsapp_bot - Waiting 5.7 seconds before next chunk...
2025-10-15 15:55:13,709 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 15:55:13,713 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-15 15:55:13,713 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 15:55:13,714 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 15:55:13] "POST /webhook HTTP/1.1" 200 -
2025-10-15 15:55:14,024 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 15:55:14,030 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB09D0485C5A0B26EA82E
2025-10-15 15:55:14,030 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 15:55:14] "POST /webhook HTTP/1.1" 200 -
2025-10-15 15:55:18,206 - INFO - whatsapp_bot - Sending chunk 2/2: 
 Tenho alguns contatos com esse nome....
2025-10-15 15:55:18,787 - INFO - whatsapp_bot - Text message sent to 558186732159@s.whatsapp.net.
2025-10-15 15:55:18,787 - INFO - whatsapp_bot - Successfully sent chunk 2 to 558186732159@s.whatsapp.net
2025-10-15 15:55:18,788 - INFO - whatsapp_bot - Saved conversation history for 558186732159_s_whatsapp_net
2025-10-15 15:55:18,788 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 15:55:18,788 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 15:55:18] "POST /webhook HTTP/1.1" 200 -
2025-10-15 15:55:19,887 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 15:55:19,888 - INFO - whatsapp_bot - Received webhook data: {'event': 'message.sent', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'jid': '558186732159@s.whatsapp.net', 'msgId': 7107060, 'success': True, 'result': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': True, 'id': '3EB093C9A9AB7E9F610A36'}, 'message': {'extendedTextMessage': {'text': 'Tenho alguns contatos com esse nome.'}}, 'messageTimestamp': '1760554499', 'status': 'PENDING'}}, 'timestamp': 1760554499843}
2025-10-15 15:55:19,888 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-15 15:55:19,888 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 15:55:19,888 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 15:55:19] "POST /webhook HTTP/1.1" 200 -
2025-10-15 15:55:20,189 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 15:55:20,189 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': True, 'id': '3EB093C9A9AB7E9F610A36', 'msgId': 7107060}, 'message': {'extendedTextMessage': {'text': 'Tenho alguns contatos com esse nome.'}}, 'messageTimestamp': {'low': 1760554499, 'high': 0, 'unsigned': True}, 'status': 1, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB093C9A9AB7E9F610A36'}}, 'timestamp': 1760554500094}
2025-10-15 15:55:20,189 - INFO - whatsapp_bot - Processing message info: {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': True, 'id': '3EB093C9A9AB7E9F610A36', 'msgId': 7107060}, 'message': {'extendedTextMessage': {'text': 'Tenho alguns contatos com esse nome.'}}, 'messageTimestamp': {'low': 1760554499, 'high': 0, 'unsigned': True}, 'status': 1, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB093C9A9AB7E9F610A36'}
2025-10-15 15:55:20,189 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB093C9A9AB7E9F610A36
2025-10-15 15:55:20,189 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 15:55:20] "POST /webhook HTTP/1.1" 200 -
2025-10-15 15:55:28,407 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 15:55:28,408 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': 'AC73F32F2409673DF5216819D73F7EB6', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1760554508, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'conversation': 'Um de seus consultores da otica', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'xDgDFRA5e7n9SnU+uu2HCu5ppVs9c1cngeVbXyzPUrI='}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': 'AC73F32F2409673DF5216819D73F7EB6'}}, 'timestamp': 1760554508313}
2025-10-15 15:55:28,408 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': 'AC73F32F2409673DF5216819D73F7EB6', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1760554508, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'conversation': 'Um de seus consultores da otica', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'xDgDFRA5e7n9SnU+uu2HCu5ppVs9c1cngeVbXyzPUrI='}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': 'AC73F32F2409673DF5216819D73F7EB6'}
2025-10-15 15:55:28,408 - INFO - whatsapp_bot - Sender number: 558186732159@s.whatsapp.net
2025-10-15 15:55:28,408 - INFO - whatsapp_bot - Message content object: {'conversation': 'Um de seus consultores da otica', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'xDgDFRA5e7n9SnU+uu2HCu5ppVs9c1cngeVbXyzPUrI='}}
2025-10-15 15:55:28,409 - INFO - whatsapp_bot - Found conversation text: Um de seus consultores da otica
2025-10-15 15:55:28,409 - INFO - whatsapp_bot - Safe sender ID: 558186732159_s_whatsapp_net
2025-10-15 15:55:28,409 - INFO - whatsapp_bot - Processing text message: 'Um de seus consultores da otica' from 558186732159@s.whatsapp.net
2025-10-15 15:55:28,415 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 15:55:28,415 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': 'AC73F32F2409673DF5216819D73F7EB6', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1760554508, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'conversation': 'Um de seus consultores da otica', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'xDgDFRA5e7n9SnU+uu2HCu5ppVs9c1cngeVbXyzPUrI='}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': 'AC73F32F2409673DF5216819D73F7EB6'}}, 'timestamp': 1760554508312}
2025-10-15 15:55:28,416 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-15 15:55:28,416 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 15:55:28,416 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 15:55:28] "POST /webhook HTTP/1.1" 200 -
2025-10-15 15:55:28,417 - INFO - whatsapp_bot - Loaded conversation history for 558186732159_s_whatsapp_net
2025-10-15 15:55:28,417 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): Um de seus consultores da otica...
2025-10-15 15:55:29,209 - INFO - whatsapp_bot - Sending 1 message chunks to 558186732159@s.whatsapp.net
2025-10-15 15:55:29,787 - INFO - whatsapp_bot - Text message sent to 558186732159@s.whatsapp.net.
2025-10-15 15:55:29,787 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558186732159@s.whatsapp.net
2025-10-15 15:55:29,788 - INFO - whatsapp_bot - Saved conversation history for 558186732159_s_whatsapp_net
2025-10-15 15:55:29,788 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 15:55:29,788 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 15:55:29] "POST /webhook HTTP/1.1" 200 -
2025-10-15 15:55:30,984 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 15:55:30,986 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-15 15:55:30,987 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 15:55:30,987 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 15:55:30] "POST /webhook HTTP/1.1" 200 -
2025-10-15 15:55:31,244 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 15:55:31,251 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB0BB46D51731CA7AF46D
2025-10-15 15:55:31,251 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 15:55:31] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:05:20,809 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:05:20,810 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': 'AC52EE5EA7858A8B607DECCE7B1DEF90', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1760555100, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'conversation': 'Onde vocs ficam?', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': '9UiF+VibMDsS+DgeOcUHzeQxXtYvPjIahXVyd5TaVAc='}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': 'AC52EE5EA7858A8B607DECCE7B1DEF90'}}, 'timestamp': 1760555100665}
2025-10-15 16:05:20,810 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-15 16:05:20,810 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 16:05:20,811 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:05:20] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:05:20,812 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:05:20,812 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': 'AC52EE5EA7858A8B607DECCE7B1DEF90', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1760555100, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'conversation': 'Onde vocs ficam?', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': '9UiF+VibMDsS+DgeOcUHzeQxXtYvPjIahXVyd5TaVAc='}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': 'AC52EE5EA7858A8B607DECCE7B1DEF90'}}, 'timestamp': 1760555100666}
2025-10-15 16:05:20,812 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': 'AC52EE5EA7858A8B607DECCE7B1DEF90', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1760555100, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'conversation': 'Onde vocs ficam?', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': '9UiF+VibMDsS+DgeOcUHzeQxXtYvPjIahXVyd5TaVAc='}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': 'AC52EE5EA7858A8B607DECCE7B1DEF90'}
2025-10-15 16:05:20,813 - INFO - whatsapp_bot - Sender number: 558186732159@s.whatsapp.net
2025-10-15 16:05:20,813 - INFO - whatsapp_bot - Message content object: {'conversation': 'Onde vocs ficam?', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': '9UiF+VibMDsS+DgeOcUHzeQxXtYvPjIahXVyd5TaVAc='}}
2025-10-15 16:05:20,813 - INFO - whatsapp_bot - Found conversation text: Onde vocs ficam?
2025-10-15 16:05:20,813 - INFO - whatsapp_bot - Safe sender ID: 558186732159_s_whatsapp_net
2025-10-15 16:05:20,813 - INFO - whatsapp_bot - Processing text message: 'Onde vocs ficam?' from 558186732159@s.whatsapp.net
2025-10-15 16:05:20,821 - INFO - whatsapp_bot - Loaded conversation history for 558186732159_s_whatsapp_net
2025-10-15 16:05:20,821 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): Onde vocs ficam?...
2025-10-15 16:05:22,161 - INFO - whatsapp_bot - Sending 2 message chunks to 558186732159@s.whatsapp.net
2025-10-15 16:05:22,161 - INFO - whatsapp_bot - Sending chunk 1/2: Estamos localizados na Rua Augusta, 1234, 
Consola...
2025-10-15 16:05:22,816 - INFO - whatsapp_bot - Text message sent to 558186732159@s.whatsapp.net.
2025-10-15 16:05:22,816 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558186732159@s.whatsapp.net
2025-10-15 16:05:22,816 - INFO - whatsapp_bot - Waiting 5.7 seconds before next chunk...
2025-10-15 16:05:24,212 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:05:24,216 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-15 16:05:24,216 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 16:05:24,217 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:05:24] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:05:24,532 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:05:24,538 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB05879630FD3A6751D74
2025-10-15 16:05:24,539 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:05:24] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:05:29,072 - INFO - whatsapp_bot - Text message sent to 558186732159@s.whatsapp.net.
2025-10-15 16:05:29,072 - INFO - whatsapp_bot - Successfully sent chunk 2 to 558186732159@s.whatsapp.net
2025-10-15 16:05:29,073 - INFO - whatsapp_bot - Saved conversation history for 558186732159_s_whatsapp_net
2025-10-15 16:05:29,073 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 16:05:29,073 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:05:29] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:05:30,325 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:05:30,329 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-15 16:05:30,329 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 16:05:30,329 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:05:30] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:05:30,645 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:05:30,652 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB02146CE6447DACD66D4
2025-10-15 16:05:30,652 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:05:30] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:06:45,020 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:06:45,021 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': '3EB06A03305E17FB8D6CF9', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1760555184, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'conversation': 'onde a GGDISK Otica de boa viagem fica?', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'VHb6h3O5Cl/WDpVd3m9HAtFaxNFpACiowHaQCiMEEC8='}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB06A03305E17FB8D6CF9'}}, 'timestamp': 1760555184882}
2025-10-15 16:06:45,021 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:06:45,021 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-15 16:06:45,021 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': '3EB06A03305E17FB8D6CF9', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1760555184, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'conversation': 'onde a GGDISK Otica de boa viagem fica?', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'VHb6h3O5Cl/WDpVd3m9HAtFaxNFpACiowHaQCiMEEC8='}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB06A03305E17FB8D6CF9'}}, 'timestamp': 1760555184884}
2025-10-15 16:06:45,021 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 16:06:45,022 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': '3EB06A03305E17FB8D6CF9', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1760555184, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'conversation': 'onde a GGDISK Otica de boa viagem fica?', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'VHb6h3O5Cl/WDpVd3m9HAtFaxNFpACiowHaQCiMEEC8='}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB06A03305E17FB8D6CF9'}
2025-10-15 16:06:45,022 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:06:45] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:06:45,022 - INFO - whatsapp_bot - Sender number: 558186732159@s.whatsapp.net
2025-10-15 16:06:45,022 - INFO - whatsapp_bot - Message content object: {'conversation': 'onde a GGDISK Otica de boa viagem fica?', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'VHb6h3O5Cl/WDpVd3m9HAtFaxNFpACiowHaQCiMEEC8='}}
2025-10-15 16:06:45,022 - INFO - whatsapp_bot - Found conversation text: onde a GGDISK Otica de boa viagem fica?
2025-10-15 16:06:45,022 - INFO - whatsapp_bot - Safe sender ID: 558186732159_s_whatsapp_net
2025-10-15 16:06:45,023 - INFO - whatsapp_bot - Processing text message: 'onde a GGDISK Otica de boa viagem fica?' from 558186732159@s.whatsapp.net
2025-10-15 16:06:45,030 - INFO - whatsapp_bot - Loaded conversation history for 558186732159_s_whatsapp_net
2025-10-15 16:06:45,030 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): onde a GGDISK Otica de boa viagem fica?...
2025-10-15 16:06:45,941 - INFO - whatsapp_bot - Sending 1 message chunks to 558186732159@s.whatsapp.net
2025-10-15 16:06:45,942 - INFO - whatsapp_bot - Sending chunk 1/1: A GGDISK tica de Boa Viagem
fica na Avenida Boa V...
2025-10-15 16:06:46,514 - INFO - whatsapp_bot - Text message sent to 558186732159@s.whatsapp.net.
2025-10-15 16:06:46,514 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558186732159@s.whatsapp.net
2025-10-15 16:06:46,515 - INFO - whatsapp_bot - Saved conversation history for 558186732159_s_whatsapp_net
2025-10-15 16:06:46,515 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 16:06:46,515 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:06:46] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:06:47,830 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:06:47,833 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-15 16:06:47,833 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 16:06:47,833 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:06:47] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:06:48,117 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:06:48,124 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB01635E0C7B0562270E0
2025-10-15 16:06:48,124 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:06:48] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:11:27,776 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:11:27,776 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': True, 'id': 'A5DDFCE2B49F9FA1BB57A0DF84C9B34E'}, 'messageTimestamp': 1760555467, 'pushName': 'GGDISK tica', 'broadcast': False, 'status': 2, 'message': {'contactMessage': {'displayName': 'GGDISK tica  Watsap Aflitos', 'vcard': 'BEGIN:VCARD\nVERSION:3.0\nN:Aflitos;GGDISK tica;Watsap;;\nFN:GGDISK tica  Watsap Aflitos\nORG:GGDISK tica Ltda\nTITLE:\nitem1.TEL;waid=558132427811:+55 81 3242-7811\nitem1.X-ABLabel:Celular\nX-WA-BIZ-DESCRIPTION:tica\nX-WA-BIZ-NAME:GGDISK tica  Watsap Aflitos\nEND:VCARD'}}, 'verifiedBizName': 'GGDISK tica', 'remoteJid': '558186732159@s.whatsapp.net', 'id': 'A5DDFCE2B49F9FA1BB57A0DF84C9B34E'}}, 'timestamp': 1760555467676}
2025-10-15 16:11:27,776 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': True, 'id': 'A5DDFCE2B49F9FA1BB57A0DF84C9B34E'}, 'messageTimestamp': 1760555467, 'pushName': 'GGDISK tica', 'broadcast': False, 'status': 2, 'message': {'contactMessage': {'displayName': 'GGDISK tica  Watsap Aflitos', 'vcard': 'BEGIN:VCARD\nVERSION:3.0\nN:Aflitos;GGDISK tica;Watsap;;\nFN:GGDISK tica  Watsap Aflitos\nORG:GGDISK tica Ltda\nTITLE:\nitem1.TEL;waid=558132427811:+55 81 3242-7811\nitem1.X-ABLabel:Celular\nX-WA-BIZ-DESCRIPTION:tica\nX-WA-BIZ-NAME:GGDISK tica  Watsap Aflitos\nEND:VCARD'}}, 'verifiedBizName': 'GGDISK tica', 'remoteJid': '558186732159@s.whatsapp.net', 'id': 'A5DDFCE2B49F9FA1BB57A0DF84C9B34E'}
2025-10-15 16:11:27,776 - INFO - whatsapp_bot - Ignoring self-sent message: A5DDFCE2B49F9FA1BB57A0DF84C9B34E
2025-10-15 16:11:27,777 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:11:27] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:19:53,685 - INFO - whatsapp_bot - WaSenderAPI client initialized successfully with retry support
2025-10-15 16:19:53,686 - INFO - whatsapp_bot - Gemini API client initialized successfully
2025-10-15 16:19:53,687 - INFO - whatsapp_bot - Successfully loaded persona: Pedro
2025-10-15 16:19:53,687 - INFO - whatsapp_bot - Loaded 17 few-shot examples
2025-10-15 16:19:53,687 - INFO - whatsapp_bot - Interactive menu: Enabled
2025-10-15 16:19:53,687 - INFO - whatsapp_bot - Using persona 'Pedro' with 17 training examples
2025-10-15 16:19:53,687 - INFO - whatsapp_bot - Gemini client initialized with model: gemini-2.0-flash
2025-10-15 16:19:53,687 - INFO - whatsapp_bot - Few-shot learning: Enabled (17 examples)
2025-10-15 16:19:53,688 - INFO - whatsapp_bot - ======================================================
2025-10-15 16:19:53,689 - INFO - whatsapp_bot -   WhatsApp Gemini Chatbot Starting
2025-10-15 16:19:53,689 - INFO - whatsapp_bot - ======================================================
2025-10-15 16:19:53,689 - INFO - whatsapp_bot - Persona: Pedro
2025-10-15 16:19:53,689 - INFO - whatsapp_bot - Gemini Model: gemini-2.0-flash
2025-10-15 16:19:53,689 - INFO - whatsapp_bot - Conversations Directory: conversations
2025-10-15 16:19:53,689 - INFO - whatsapp_bot - WaSender API Client: Initialized
2025-10-15 16:19:53,689 - INFO - whatsapp_bot - Gemini API Client: Initialized
2025-10-15 16:19:53,690 - INFO - whatsapp_bot - Starting Flask server on port 5001...
2025-10-15 16:19:53,690 - INFO - whatsapp_bot - ======================================================
2025-10-15 16:19:53,697 - INFO - werkzeug - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5001
 * Running on http://192.168.68.119:5001
2025-10-15 16:19:53,698 - INFO - werkzeug - [33mPress CTRL+C to quit[0m
2025-10-15 16:20:10,748 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:20:10,749 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'ACB3D91F2AACEB0E785FA9B1F4B2C170', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1760555990, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Boa tarde', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'kwj1yQ2uFgxGilRyRepGfHU8AREPQEFplE4HtF9ZA7c='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'ACB3D91F2AACEB0E785FA9B1F4B2C170'}}, 'timestamp': 1760555990671}
2025-10-15 16:20:10,749 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:20:10,749 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'ACB3D91F2AACEB0E785FA9B1F4B2C170', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1760555990, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Boa tarde', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'kwj1yQ2uFgxGilRyRepGfHU8AREPQEFplE4HtF9ZA7c='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'ACB3D91F2AACEB0E785FA9B1F4B2C170'}
2025-10-15 16:20:10,749 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'ACB3D91F2AACEB0E785FA9B1F4B2C170', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1760555990, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Boa tarde', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'kwj1yQ2uFgxGilRyRepGfHU8AREPQEFplE4HtF9ZA7c='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'ACB3D91F2AACEB0E785FA9B1F4B2C170'}}, 'timestamp': 1760555990669}
2025-10-15 16:20:10,749 - INFO - whatsapp_bot - Sender number: 558199045078@s.whatsapp.net
2025-10-15 16:20:10,750 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-15 16:20:10,750 - INFO - whatsapp_bot - Message content object: {'conversation': 'Boa tarde', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'kwj1yQ2uFgxGilRyRepGfHU8AREPQEFplE4HtF9ZA7c='}}
2025-10-15 16:20:10,750 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 16:20:10,750 - INFO - whatsapp_bot - Found conversation text: Boa tarde
2025-10-15 16:20:10,751 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:20:10] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:20:10,751 - INFO - whatsapp_bot - Safe sender ID: 558199045078_s_whatsapp_net
2025-10-15 16:20:10,751 - INFO - whatsapp_bot - Processing text message: 'Boa tarde' from 558199045078@s.whatsapp.net
2025-10-15 16:20:10,751 - INFO - whatsapp_bot - Loaded conversation history for 558199045078_s_whatsapp_net
2025-10-15 16:20:10,752 - INFO - whatsapp_bot - Greeting detected, showing menu to 558199045078@s.whatsapp.net
2025-10-15 16:20:10,752 - INFO - whatsapp_bot - Sending 5 message chunks to 558199045078@s.whatsapp.net
2025-10-15 16:20:11,406 - INFO - whatsapp_bot - Text message sent to 558199045078@s.whatsapp.net.
2025-10-15 16:20:11,406 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558199045078@s.whatsapp.net
2025-10-15 16:20:11,406 - INFO - whatsapp_bot - Waiting 6.5 seconds before next chunk...
2025-10-15 16:20:12,720 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:20:12,720 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': 'ACE83DB703FFC0CEA70DE0174AEF8E38', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1760555992, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'conversation': 'Onde fica a otica?', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'bWn0YAM9qmYIbZUltI6MvtizIscDaL1IAwejGol0iRs='}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': 'ACE83DB703FFC0CEA70DE0174AEF8E38'}}, 'timestamp': 1760555992671}
2025-10-15 16:20:12,720 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-15 16:20:12,720 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 16:20:12,720 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:20:12] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:20:12,753 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:20:12,754 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': 'ACE83DB703FFC0CEA70DE0174AEF8E38', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1760555992, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'conversation': 'Onde fica a otica?', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'bWn0YAM9qmYIbZUltI6MvtizIscDaL1IAwejGol0iRs='}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': 'ACE83DB703FFC0CEA70DE0174AEF8E38'}}, 'timestamp': 1760555992672}
2025-10-15 16:20:12,754 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': 'ACE83DB703FFC0CEA70DE0174AEF8E38', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1760555992, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'conversation': 'Onde fica a otica?', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'bWn0YAM9qmYIbZUltI6MvtizIscDaL1IAwejGol0iRs='}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': 'ACE83DB703FFC0CEA70DE0174AEF8E38'}
2025-10-15 16:20:12,754 - INFO - whatsapp_bot - Sender number: 558186732159@s.whatsapp.net
2025-10-15 16:20:12,754 - INFO - whatsapp_bot - Message content object: {'conversation': 'Onde fica a otica?', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'bWn0YAM9qmYIbZUltI6MvtizIscDaL1IAwejGol0iRs='}}
2025-10-15 16:20:12,755 - INFO - whatsapp_bot - Found conversation text: Onde fica a otica?
2025-10-15 16:20:12,755 - INFO - whatsapp_bot - Safe sender ID: 558186732159_s_whatsapp_net
2025-10-15 16:20:12,755 - INFO - whatsapp_bot - Processing text message: 'Onde fica a otica?' from 558186732159@s.whatsapp.net
2025-10-15 16:20:12,755 - INFO - whatsapp_bot - Loaded conversation history for 558186732159_s_whatsapp_net
2025-10-15 16:20:12,755 - INFO - whatsapp_bot - Using Gemini AI for response
2025-10-15 16:20:12,756 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): Onde fica a otica?...
2025-10-15 16:20:12,958 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:20:12,962 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-15 16:20:12,962 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 16:20:12,962 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:20:12] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:20:13,085 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:20:13,092 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB05E9D0BB2BDCE23EAE7
2025-10-15 16:20:13,092 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:20:13] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:20:14,279 - INFO - whatsapp_bot - Sending 1 message chunks to 558186732159@s.whatsapp.net
2025-10-15 16:20:14,280 - INFO - whatsapp_bot - Sending chunk 1/1: A GGDISK tica fica localizada na Av. Conselheiro ...
2025-10-15 16:20:17,412 - INFO - whatsapp_bot - Text message sent to 558186732159@s.whatsapp.net.
2025-10-15 16:20:17,412 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558186732159@s.whatsapp.net
2025-10-15 16:20:17,413 - INFO - whatsapp_bot - Saved conversation history for 558186732159_s_whatsapp_net
2025-10-15 16:20:17,413 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 16:20:17,413 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:20:17] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:20:17,903 - INFO - whatsapp_bot - Sending chunk 2/5: 
*Escolha uma opo:*
...
2025-10-15 16:20:18,399 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:20:18,403 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-15 16:20:18,404 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 16:20:18,404 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:20:18] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:20:18,715 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:20:18,721 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB0398ED4091831133E17
2025-10-15 16:20:18,722 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:20:18] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:20:23,054 - INFO - whatsapp_bot - Text message sent to 558199045078@s.whatsapp.net.
2025-10-15 16:20:23,055 - INFO - whatsapp_bot - Successfully sent chunk 2 to 558199045078@s.whatsapp.net
2025-10-15 16:20:23,055 - INFO - whatsapp_bot - Waiting 6.8 seconds before next chunk...
2025-10-15 16:20:24,470 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:20:24,470 - INFO - whatsapp_bot - Received webhook data: {'event': 'message.sent', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'jid': '558199045078@s.whatsapp.net', 'msgId': 7110578, 'success': True, 'result': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB04428427081FEABEA38'}, 'message': {'extendedTextMessage': {'text': '*Escolha uma opo:*'}}, 'messageTimestamp': '1760556004', 'status': 'PENDING'}}, 'timestamp': 1760556004395}
2025-10-15 16:20:24,470 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-15 16:20:24,470 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 16:20:24,470 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:20:24] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:20:24,600 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:20:24,600 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB04428427081FEABEA38', 'msgId': 7110578}, 'message': {'extendedTextMessage': {'text': '*Escolha uma opo:*'}}, 'messageTimestamp': {'low': 1760556004, 'high': 0, 'unsigned': True}, 'status': 1, 'remoteJid': '558199045078@s.whatsapp.net', 'id': '3EB04428427081FEABEA38'}}, 'timestamp': 1760556004524}
2025-10-15 16:20:24,600 - INFO - whatsapp_bot - Processing message info: {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB04428427081FEABEA38', 'msgId': 7110578}, 'message': {'extendedTextMessage': {'text': '*Escolha uma opo:*'}}, 'messageTimestamp': {'low': 1760556004, 'high': 0, 'unsigned': True}, 'status': 1, 'remoteJid': '558199045078@s.whatsapp.net', 'id': '3EB04428427081FEABEA38'}
2025-10-15 16:20:24,600 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB04428427081FEABEA38
2025-10-15 16:20:24,600 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:20:24] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:20:30,487 - INFO - whatsapp_bot - Text message sent to 558199045078@s.whatsapp.net.
2025-10-15 16:20:30,487 - INFO - whatsapp_bot - Successfully sent chunk 3 to 558199045078@s.whatsapp.net
2025-10-15 16:20:30,487 - INFO - whatsapp_bot - Waiting 5.1 seconds before next chunk...
2025-10-15 16:20:32,446 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:20:32,450 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-15 16:20:32,450 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 16:20:32,450 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:20:32] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:20:32,514 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:20:32,520 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB000C91BFC83CB5FCC33
2025-10-15 16:20:32,520 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:20:32] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:20:36,201 - INFO - whatsapp_bot - Text message sent to 558199045078@s.whatsapp.net.
2025-10-15 16:20:36,201 - INFO - whatsapp_bot - Successfully sent chunk 4 to 558199045078@s.whatsapp.net
2025-10-15 16:20:36,202 - INFO - whatsapp_bot - Waiting 6.1 seconds before next chunk...
2025-10-15 16:20:37,592 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:20:37,595 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-15 16:20:37,595 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 16:20:37,595 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:20:37] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:20:37,711 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:20:37,718 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB030208E505DD3BB4BD4
2025-10-15 16:20:37,718 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:20:37] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:20:42,859 - INFO - whatsapp_bot - Text message sent to 558199045078@s.whatsapp.net.
2025-10-15 16:20:42,859 - INFO - whatsapp_bot - Successfully sent chunk 5 to 558199045078@s.whatsapp.net
2025-10-15 16:20:42,860 - INFO - whatsapp_bot - Saved conversation history for 558199045078_s_whatsapp_net
2025-10-15 16:20:42,860 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 16:20:42,860 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:20:42] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:20:44,615 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:20:44,619 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-15 16:20:44,619 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 16:20:44,619 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:20:44] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:20:44,803 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:20:44,811 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB0831BBC8E2E12EA5288
2025-10-15 16:20:44,812 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:20:44] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:20:51,384 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:20:51,385 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC738715AF33018DDC3B186982BDA61C', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1760556031, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': '1', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'AKNpkzIGq2NkVO0yLcuMBr2HQaiJ64YCNaNJnB8X1jM='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC738715AF33018DDC3B186982BDA61C'}}, 'timestamp': 1760556031313}
2025-10-15 16:20:51,385 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC738715AF33018DDC3B186982BDA61C', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1760556031, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': '1', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'AKNpkzIGq2NkVO0yLcuMBr2HQaiJ64YCNaNJnB8X1jM='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC738715AF33018DDC3B186982BDA61C'}
2025-10-15 16:20:51,386 - INFO - whatsapp_bot - Sender number: 558199045078@s.whatsapp.net
2025-10-15 16:20:51,386 - INFO - whatsapp_bot - Message content object: {'conversation': '1', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'AKNpkzIGq2NkVO0yLcuMBr2HQaiJ64YCNaNJnB8X1jM='}}
2025-10-15 16:20:51,386 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:20:51,387 - INFO - whatsapp_bot - Found conversation text: 1
2025-10-15 16:20:51,387 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC738715AF33018DDC3B186982BDA61C', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1760556031, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': '1', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'AKNpkzIGq2NkVO0yLcuMBr2HQaiJ64YCNaNJnB8X1jM='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC738715AF33018DDC3B186982BDA61C'}}, 'timestamp': 1760556031310}
2025-10-15 16:20:51,387 - INFO - whatsapp_bot - Safe sender ID: 558199045078_s_whatsapp_net
2025-10-15 16:20:51,387 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-15 16:20:51,387 - INFO - whatsapp_bot - Processing text message: '1' from 558199045078@s.whatsapp.net
2025-10-15 16:20:51,387 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 16:20:51,388 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:20:51] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:20:51,396 - INFO - whatsapp_bot - Loaded conversation history for 558199045078_s_whatsapp_net
2025-10-15 16:20:51,396 - INFO - whatsapp_bot - Menu option 1 selected by 558199045078@s.whatsapp.net
2025-10-15 16:20:51,397 - INFO - whatsapp_bot - Sending 4 message chunks to 558199045078@s.whatsapp.net
2025-10-15 16:20:51,972 - INFO - whatsapp_bot - Text message sent to 558199045078@s.whatsapp.net.
2025-10-15 16:20:51,972 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558199045078@s.whatsapp.net
2025-10-15 16:20:51,972 - INFO - whatsapp_bot - Waiting 6.4 seconds before next chunk...
2025-10-15 16:20:53,404 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:20:53,407 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-15 16:20:53,408 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 16:20:53,408 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:20:53] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:20:53,583 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:20:53,590 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB0074E4884A7CE94D1FC
2025-10-15 16:20:53,590 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:20:53] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:20:58,346 - INFO - whatsapp_bot - Sending chunk 2/4: Nossa frente fica voltada para a Av. Domingos Ferr...
2025-10-15 16:20:58,920 - INFO - whatsapp_bot - Text message sent to 558199045078@s.whatsapp.net.
2025-10-15 16:20:58,920 - INFO - whatsapp_bot - Successfully sent chunk 2 to 558199045078@s.whatsapp.net
2025-10-15 16:20:58,920 - INFO - whatsapp_bot - Waiting 5.6 seconds before next chunk...
2025-10-15 16:21:01,005 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:21:01,009 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-15 16:21:01,009 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 16:21:01,009 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:21:01] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:21:01,130 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:21:01,137 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB068DF3A3CA904FA85D8
2025-10-15 16:21:01,137 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:21:01] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:21:04,490 - INFO - whatsapp_bot - Sending chunk 3/4: Segunda a Sexta: 9h s 18h
Sbado: 9h s 12h
Domin...
2025-10-15 16:21:05,071 - INFO - whatsapp_bot - Text message sent to 558199045078@s.whatsapp.net.
2025-10-15 16:21:05,071 - INFO - whatsapp_bot - Successfully sent chunk 3 to 558199045078@s.whatsapp.net
2025-10-15 16:21:05,071 - INFO - whatsapp_bot - Waiting 6.5 seconds before next chunk...
2025-10-15 16:21:06,907 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:21:06,907 - INFO - whatsapp_bot - Received webhook data: {'event': 'message.sent', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'jid': '558199045078@s.whatsapp.net', 'msgId': 7110656, 'success': True, 'result': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB08600A874481702BC69'}, 'message': {'extendedTextMessage': {'text': 'Segunda a Sexta: 9h s 18h\nSbado: 9h s 12h\nDomingo: Fechado'}}, 'messageTimestamp': '1760556046', 'status': 'PENDING'}}, 'timestamp': 1760556046833}
2025-10-15 16:21:06,908 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-15 16:21:06,908 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 16:21:06,908 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:21:06] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:21:07,038 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:21:07,038 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB08600A874481702BC69', 'msgId': 7110656}, 'message': {'extendedTextMessage': {'text': 'Segunda a Sexta: 9h s 18h\nSbado: 9h s 12h\nDomingo: Fechado'}}, 'messageTimestamp': {'low': 1760556046, 'high': 0, 'unsigned': True}, 'status': 1, 'remoteJid': '558199045078@s.whatsapp.net', 'id': '3EB08600A874481702BC69'}}, 'timestamp': 1760556046962}
2025-10-15 16:21:07,038 - INFO - whatsapp_bot - Processing message info: {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB08600A874481702BC69', 'msgId': 7110656}, 'message': {'extendedTextMessage': {'text': 'Segunda a Sexta: 9h s 18h\nSbado: 9h s 12h\nDomingo: Fechado'}}, 'messageTimestamp': {'low': 1760556046, 'high': 0, 'unsigned': True}, 'status': 1, 'remoteJid': '558199045078@s.whatsapp.net', 'id': '3EB08600A874481702BC69'}
2025-10-15 16:21:07,038 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB08600A874481702BC69
2025-10-15 16:21:07,039 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:21:07] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:21:11,595 - INFO - whatsapp_bot - Sending chunk 4/4: 
Posso ajudar com mais alguma coisa? Digite o nme...
2025-10-15 16:21:12,174 - INFO - whatsapp_bot - Text message sent to 558199045078@s.whatsapp.net.
2025-10-15 16:21:12,174 - INFO - whatsapp_bot - Successfully sent chunk 4 to 558199045078@s.whatsapp.net
2025-10-15 16:21:12,175 - INFO - whatsapp_bot - Saved conversation history for 558199045078_s_whatsapp_net
2025-10-15 16:21:12,175 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 16:21:12,176 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:21:12] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:21:13,526 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:21:13,530 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-15 16:21:13,530 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 16:21:13,530 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:21:13] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:21:13,690 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:21:13,696 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB0F668100FFC685172D3
2025-10-15 16:21:13,697 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:21:13] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:21:27,189 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:21:27,189 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'ACD1FB2B87D71D16BB3B9B959414F14B', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1760556067, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': '3', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'sgfkg53sem73RkN94iw2rDhzjhFw8EWVH/iPBn7XOLo='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'ACD1FB2B87D71D16BB3B9B959414F14B'}}, 'timestamp': 1760556067122}
2025-10-15 16:21:27,189 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'ACD1FB2B87D71D16BB3B9B959414F14B', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1760556067, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': '3', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'sgfkg53sem73RkN94iw2rDhzjhFw8EWVH/iPBn7XOLo='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'ACD1FB2B87D71D16BB3B9B959414F14B'}
2025-10-15 16:21:27,189 - INFO - whatsapp_bot - Sender number: 558199045078@s.whatsapp.net
2025-10-15 16:21:27,189 - INFO - whatsapp_bot - Message content object: {'conversation': '3', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'sgfkg53sem73RkN94iw2rDhzjhFw8EWVH/iPBn7XOLo='}}
2025-10-15 16:21:27,190 - INFO - whatsapp_bot - Found conversation text: 3
2025-10-15 16:21:27,190 - INFO - whatsapp_bot - Safe sender ID: 558199045078_s_whatsapp_net
2025-10-15 16:21:27,190 - INFO - whatsapp_bot - Processing text message: '3' from 558199045078@s.whatsapp.net
2025-10-15 16:21:27,193 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:21:27,193 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'ACD1FB2B87D71D16BB3B9B959414F14B', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1760556067, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': '3', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'sgfkg53sem73RkN94iw2rDhzjhFw8EWVH/iPBn7XOLo='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'ACD1FB2B87D71D16BB3B9B959414F14B'}}, 'timestamp': 1760556067120}
2025-10-15 16:21:27,193 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-15 16:21:27,193 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 16:21:27,193 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:21:27] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:21:27,198 - INFO - whatsapp_bot - Loaded conversation history for 558199045078_s_whatsapp_net
2025-10-15 16:21:27,199 - INFO - whatsapp_bot - Menu option 3 selected by 558199045078@s.whatsapp.net
2025-10-15 16:21:27,199 - INFO - whatsapp_bot - Sending 3 message chunks to 558199045078@s.whatsapp.net
2025-10-15 16:21:27,772 - INFO - whatsapp_bot - Text message sent to 558199045078@s.whatsapp.net.
2025-10-15 16:21:27,772 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558199045078@s.whatsapp.net
2025-10-15 16:21:27,772 - INFO - whatsapp_bot - Waiting 6.7 seconds before next chunk...
2025-10-15 16:21:29,252 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:21:29,255 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-15 16:21:29,255 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 16:21:29,255 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:21:29] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:21:29,452 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:21:29,459 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB089B70F30E4B5CB9628
2025-10-15 16:21:29,459 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:21:29] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:21:34,455 - INFO - whatsapp_bot - Sending chunk 2/3:  *Jailson* - (81) 99750-7161
 *Josimar* - (81) 9...
2025-10-15 16:21:35,028 - INFO - whatsapp_bot - Text message sent to 558199045078@s.whatsapp.net.
2025-10-15 16:21:35,028 - INFO - whatsapp_bot - Successfully sent chunk 2 to 558199045078@s.whatsapp.net
2025-10-15 16:21:35,028 - INFO - whatsapp_bot - Waiting 5.8 seconds before next chunk...
2025-10-15 16:21:36,904 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:21:36,904 - INFO - whatsapp_bot - Received webhook data: {'event': 'message.sent', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'jid': '558199045078@s.whatsapp.net', 'msgId': 7110731, 'success': True, 'result': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB031967C357122DDB772'}, 'message': {'extendedTextMessage': {'text': ' *Jailson* - (81) 99750-7161\n *Josimar* - (81) 99974-5545'}}, 'messageTimestamp': '1760556076', 'status': 'PENDING'}}, 'timestamp': 1760556076784}
2025-10-15 16:21:36,904 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-15 16:21:36,904 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 16:21:36,905 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:21:36] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:21:36,980 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:21:36,980 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB031967C357122DDB772', 'msgId': 7110731}, 'message': {'extendedTextMessage': {'text': ' *Jailson* - (81) 99750-7161\n *Josimar* - (81) 99974-5545'}}, 'messageTimestamp': {'low': 1760556076, 'high': 0, 'unsigned': True}, 'status': 1, 'remoteJid': '558199045078@s.whatsapp.net', 'id': '3EB031967C357122DDB772'}}, 'timestamp': 1760556076909}
2025-10-15 16:21:36,981 - INFO - whatsapp_bot - Processing message info: {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB031967C357122DDB772', 'msgId': 7110731}, 'message': {'extendedTextMessage': {'text': ' *Jailson* - (81) 99750-7161\n *Josimar* - (81) 99974-5545'}}, 'messageTimestamp': {'low': 1760556076, 'high': 0, 'unsigned': True}, 'status': 1, 'remoteJid': '558199045078@s.whatsapp.net', 'id': '3EB031967C357122DDB772'}
2025-10-15 16:21:36,981 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB031967C357122DDB772
2025-10-15 16:21:36,981 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:21:36] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:21:40,811 - INFO - whatsapp_bot - Sending chunk 3/3: Eles vo te ajudar com todas as opes disponveis...
2025-10-15 16:21:41,389 - INFO - whatsapp_bot - Text message sent to 558199045078@s.whatsapp.net.
2025-10-15 16:21:41,389 - INFO - whatsapp_bot - Successfully sent chunk 3 to 558199045078@s.whatsapp.net
2025-10-15 16:21:41,390 - INFO - whatsapp_bot - Saved conversation history for 558199045078_s_whatsapp_net
2025-10-15 16:21:41,391 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 16:21:41,391 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:21:41] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:21:42,939 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:21:42,942 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-15 16:21:42,942 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 16:21:42,942 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:21:42] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:21:43,132 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:21:43,139 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB00B72CAB9FE35152149
2025-10-15 16:21:43,139 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:21:43] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:22:35,363 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:22:35,363 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC24A43C59FAA0CF8B9A9F79D035FF00', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1760556135, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Jailson', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'SQPxBG6VBrlIkkD+dgfgxrStVF82oNWvwi8LjHpis4Y='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC24A43C59FAA0CF8B9A9F79D035FF00'}}, 'timestamp': 1760556135294}
2025-10-15 16:22:35,364 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:22:35,364 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC24A43C59FAA0CF8B9A9F79D035FF00', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1760556135, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Jailson', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'SQPxBG6VBrlIkkD+dgfgxrStVF82oNWvwi8LjHpis4Y='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC24A43C59FAA0CF8B9A9F79D035FF00'}
2025-10-15 16:22:35,364 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': False, 'id': 'AC24A43C59FAA0CF8B9A9F79D035FF00', 'senderLid': '21182845849754@lid'}, 'messageTimestamp': 1760556135, 'pushName': 'Vinicius Pereira', 'broadcast': False, 'message': {'conversation': 'Jailson', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'SQPxBG6VBrlIkkD+dgfgxrStVF82oNWvwi8LjHpis4Y='}}, 'remoteJid': '558199045078@s.whatsapp.net', 'id': 'AC24A43C59FAA0CF8B9A9F79D035FF00'}}, 'timestamp': 1760556135293}
2025-10-15 16:22:35,364 - INFO - whatsapp_bot - Sender number: 558199045078@s.whatsapp.net
2025-10-15 16:22:35,364 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-15 16:22:35,364 - INFO - whatsapp_bot - Message content object: {'conversation': 'Jailson', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': '/DoA8ECtFAcnNg==', 'senderTimestamp': '1759694939', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'SQPxBG6VBrlIkkD+dgfgxrStVF82oNWvwi8LjHpis4Y='}}
2025-10-15 16:22:35,365 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 16:22:35,365 - INFO - whatsapp_bot - Found conversation text: Jailson
2025-10-15 16:22:35,365 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:22:35] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:22:35,365 - INFO - whatsapp_bot - Safe sender ID: 558199045078_s_whatsapp_net
2025-10-15 16:22:35,365 - INFO - whatsapp_bot - Processing text message: 'Jailson' from 558199045078@s.whatsapp.net
2025-10-15 16:22:35,375 - INFO - whatsapp_bot - Loaded conversation history for 558199045078_s_whatsapp_net
2025-10-15 16:22:35,375 - INFO - whatsapp_bot - Using Gemini AI for response
2025-10-15 16:22:35,376 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): Jailson...
2025-10-15 16:22:36,534 - INFO - whatsapp_bot - Sending 2 message chunks to 558199045078@s.whatsapp.net
2025-10-15 16:22:36,534 - INFO - whatsapp_bot - Sending chunk 1/2: Perfeito! Vou notificar o Jailson agora mesmo sobr...
2025-10-15 16:22:37,116 - INFO - whatsapp_bot - Text message sent to 558199045078@s.whatsapp.net.
2025-10-15 16:22:37,116 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558199045078@s.whatsapp.net
2025-10-15 16:22:37,116 - INFO - whatsapp_bot - Waiting 5.3 seconds before next chunk...
2025-10-15 16:22:38,275 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:22:38,276 - INFO - whatsapp_bot - Received webhook data: {'event': 'message.sent', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'jid': '558199045078@s.whatsapp.net', 'msgId': 7110868, 'success': True, 'result': {'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB0330AC53AF4E51DE566'}, 'message': {'extendedTextMessage': {'text': 'Perfeito! Vou notificar o Jailson agora mesmo sobre seu interesse. Ele entrar em contato com voc\nem breve!'}}, 'messageTimestamp': '1760556138', 'status': 'PENDING'}}, 'timestamp': 1760556138238}
2025-10-15 16:22:38,276 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-15 16:22:38,276 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 16:22:38,276 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:22:38] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:22:38,476 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:22:38,476 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB0330AC53AF4E51DE566', 'msgId': 7110868}, 'message': {'extendedTextMessage': {'text': 'Perfeito! Vou notificar o Jailson agora mesmo sobre seu interesse. Ele entrar em contato com voc\nem breve!'}}, 'messageTimestamp': {'low': 1760556138, 'high': 0, 'unsigned': True}, 'status': 1, 'remoteJid': '558199045078@s.whatsapp.net', 'id': '3EB0330AC53AF4E51DE566'}}, 'timestamp': 1760556138370}
2025-10-15 16:22:38,476 - INFO - whatsapp_bot - Processing message info: {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '558199045078@s.whatsapp.net', 'fromMe': True, 'id': '3EB0330AC53AF4E51DE566', 'msgId': 7110868}, 'message': {'extendedTextMessage': {'text': 'Perfeito! Vou notificar o Jailson agora mesmo sobre seu interesse. Ele entrar em contato com voc\nem breve!'}}, 'messageTimestamp': {'low': 1760556138, 'high': 0, 'unsigned': True}, 'status': 1, 'remoteJid': '558199045078@s.whatsapp.net', 'id': '3EB0330AC53AF4E51DE566'}
2025-10-15 16:22:38,477 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB0330AC53AF4E51DE566
2025-10-15 16:22:38,477 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:22:38] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:22:42,445 - INFO - whatsapp_bot - Sending chunk 2/2: Aproveitando, posso ajudar com mais alguma informa...
2025-10-15 16:22:43,027 - INFO - whatsapp_bot - Text message sent to 558199045078@s.whatsapp.net.
2025-10-15 16:22:43,028 - INFO - whatsapp_bot - Successfully sent chunk 2 to 558199045078@s.whatsapp.net
2025-10-15 16:22:43,029 - INFO - whatsapp_bot - Saved conversation history for 558199045078_s_whatsapp_net
2025-10-15 16:22:43,029 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 16:22:43,029 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:22:43] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:22:44,952 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:22:44,955 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-15 16:22:44,956 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-15 16:22:44,956 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:22:44] "POST /webhook HTTP/1.1" 200 -
2025-10-15 16:22:45,132 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-15 16:22:45,139 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB062FE71017DCB46E795
2025-10-15 16:22:45,139 - INFO - werkzeug - 127.0.0.1 - - [15/Oct/2025 16:22:45] "POST /webhook HTTP/1.1" 200 -
2025-10-18 15:45:24,107 - INFO - whatsapp_bot - WaSenderAPI client initialized successfully with retry support
2025-10-18 15:45:24,108 - INFO - whatsapp_bot - Gemini API client initialized successfully
2025-10-18 15:45:24,109 - INFO - whatsapp_bot - Successfully loaded persona: Pedro
2025-10-18 15:45:24,109 - INFO - whatsapp_bot - Loaded 17 few-shot examples
2025-10-18 15:45:24,109 - INFO - whatsapp_bot - Interactive menu: Enabled
2025-10-18 15:45:24,109 - INFO - whatsapp_bot - Using persona 'Pedro' with 17 training examples
2025-10-18 15:45:24,109 - INFO - whatsapp_bot - Gemini client initialized with model: gemini-2.0-flash
2025-10-18 15:45:24,109 - INFO - whatsapp_bot - Few-shot learning: Enabled (17 examples)
2025-10-18 15:45:24,110 - INFO - whatsapp_bot - ======================================================
2025-10-18 15:45:24,110 - INFO - whatsapp_bot -   WhatsApp Gemini Chatbot Starting
2025-10-18 15:45:24,110 - INFO - whatsapp_bot - ======================================================
2025-10-18 15:45:24,111 - INFO - whatsapp_bot - Persona: Pedro
2025-10-18 15:45:24,111 - INFO - whatsapp_bot - Gemini Model: gemini-2.0-flash
2025-10-18 15:45:24,111 - INFO - whatsapp_bot - Conversations Directory: conversations
2025-10-18 15:45:24,111 - INFO - whatsapp_bot - WaSender API Client: Initialized
2025-10-18 15:45:24,111 - INFO - whatsapp_bot - Gemini API Client: Initialized
2025-10-18 15:45:24,111 - INFO - whatsapp_bot - Starting Flask server on port 5001...
2025-10-18 15:45:24,111 - INFO - whatsapp_bot - ======================================================
2025-10-18 15:45:24,133 - INFO - werkzeug - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5001
 * Running on http://192.168.68.119:5001
2025-10-18 15:45:24,133 - INFO - werkzeug - [33mPress CTRL+C to quit[0m
2025-10-18 15:45:40,955 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-18 15:45:40,955 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': '3EB051CB6B8B595B3F8E70', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1760813115, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'conversation': 'at que hrs voces esto a?', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'HUZW0MRJ1ZOK7UISE5P43qwfNf+MVOMTEQyZQQQxXkY='}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB051CB6B8B595B3F8E70'}}, 'timestamp': 1760813115953}
2025-10-18 15:45:40,956 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-18 15:45:40,956 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-18 15:45:40,956 - INFO - werkzeug - 127.0.0.1 - - [18/Oct/2025 15:45:40] "POST /webhook HTTP/1.1" 200 -
2025-10-18 15:45:40,958 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-18 15:45:40,959 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': '3EB051CB6B8B595B3F8E70', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1760813115, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'conversation': 'at que hrs voces esto a?', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'HUZW0MRJ1ZOK7UISE5P43qwfNf+MVOMTEQyZQQQxXkY='}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB051CB6B8B595B3F8E70'}}, 'timestamp': 1760813115954}
2025-10-18 15:45:40,959 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': '3EB051CB6B8B595B3F8E70', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1760813115, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'conversation': 'at que hrs voces esto a?', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'HUZW0MRJ1ZOK7UISE5P43qwfNf+MVOMTEQyZQQQxXkY='}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB051CB6B8B595B3F8E70'}
2025-10-18 15:45:40,959 - INFO - whatsapp_bot - Sender number: 558186732159@s.whatsapp.net
2025-10-18 15:45:40,959 - INFO - whatsapp_bot - Message content object: {'conversation': 'at que hrs voces esto a?', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'HUZW0MRJ1ZOK7UISE5P43qwfNf+MVOMTEQyZQQQxXkY='}}
2025-10-18 15:45:40,960 - INFO - whatsapp_bot - Found conversation text: at que hrs voces esto a?
2025-10-18 15:45:40,960 - INFO - whatsapp_bot - Safe sender ID: 558186732159_s_whatsapp_net
2025-10-18 15:45:40,960 - INFO - whatsapp_bot - Processing text message: 'at que hrs voces esto a?' from 558186732159@s.whatsapp.net
2025-10-18 15:45:40,969 - INFO - whatsapp_bot - Loaded conversation history for 558186732159_s_whatsapp_net
2025-10-18 15:45:40,970 - INFO - whatsapp_bot - Using Gemini AI for response
2025-10-18 15:45:40,970 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): at que hrs voces esto a?...
2025-10-18 15:45:42,394 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-18 15:45:42,394 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': True, 'id': 'A50B5C0221FD75B2DA7AC57035A0EBF6'}, 'messageTimestamp': 1760813117, 'pushName': 'GGDISK tica', 'broadcast': False, 'status': 2, 'message': {'conversation': 'A GGDISK tica agradece sua mensagem. No estamos em horrio de atendimento , mas responderemos assim que possvel.\nAt mais!'}, 'verifiedBizName': 'GGDISK tica', 'remoteJid': '558186732159@s.whatsapp.net', 'id': 'A50B5C0221FD75B2DA7AC57035A0EBF6'}}, 'timestamp': 1760813117482}
2025-10-18 15:45:42,394 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': True, 'id': 'A50B5C0221FD75B2DA7AC57035A0EBF6'}, 'messageTimestamp': 1760813117, 'pushName': 'GGDISK tica', 'broadcast': False, 'status': 2, 'message': {'conversation': 'A GGDISK tica agradece sua mensagem. No estamos em horrio de atendimento , mas responderemos assim que possvel.\nAt mais!'}, 'verifiedBizName': 'GGDISK tica', 'remoteJid': '558186732159@s.whatsapp.net', 'id': 'A50B5C0221FD75B2DA7AC57035A0EBF6'}
2025-10-18 15:45:42,394 - INFO - whatsapp_bot - Ignoring self-sent message: A50B5C0221FD75B2DA7AC57035A0EBF6
2025-10-18 15:45:42,395 - INFO - werkzeug - 127.0.0.1 - - [18/Oct/2025 15:45:42] "POST /webhook HTTP/1.1" 200 -
2025-10-18 15:45:42,726 - INFO - whatsapp_bot - Sending 1 message chunks to 558186732159@s.whatsapp.net
2025-10-18 15:45:43,892 - INFO - whatsapp_bot - Text message sent to 558186732159@s.whatsapp.net.
2025-10-18 15:45:43,893 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558186732159@s.whatsapp.net
2025-10-18 15:45:43,894 - INFO - whatsapp_bot - Saved conversation history for 558186732159_s_whatsapp_net
2025-10-18 15:45:43,894 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-18 15:45:43,894 - INFO - werkzeug - 127.0.0.1 - - [18/Oct/2025 15:45:43] "POST /webhook HTTP/1.1" 200 -
2025-10-18 15:45:46,239 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-18 15:45:46,241 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-18 15:45:46,242 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-18 15:45:46,242 - INFO - werkzeug - 127.0.0.1 - - [18/Oct/2025 15:45:46] "POST /webhook HTTP/1.1" 200 -
2025-10-18 15:45:46,721 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-18 15:45:46,728 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB044FB169AB52D5EAC7A
2025-10-18 15:45:46,728 - INFO - werkzeug - 127.0.0.1 - - [18/Oct/2025 15:45:46] "POST /webhook HTTP/1.1" 200 -
2025-10-18 15:46:38,167 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-18 15:46:38,168 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': True, 'id': 'A585C0CDA515174D8A2A5394A8684C92'}, 'messageTimestamp': 1760813173, 'pushName': 'GGDISK tica', 'broadcast': False, 'status': 2, 'message': {'conversation': 'Mas hoje  sbado'}, 'verifiedBizName': 'GGDISK tica', 'remoteJid': '558186732159@s.whatsapp.net', 'id': 'A585C0CDA515174D8A2A5394A8684C92'}}, 'timestamp': 1760813173196}
2025-10-18 15:46:38,168 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': True, 'id': 'A585C0CDA515174D8A2A5394A8684C92'}, 'messageTimestamp': 1760813173, 'pushName': 'GGDISK tica', 'broadcast': False, 'status': 2, 'message': {'conversation': 'Mas hoje  sbado'}, 'verifiedBizName': 'GGDISK tica', 'remoteJid': '558186732159@s.whatsapp.net', 'id': 'A585C0CDA515174D8A2A5394A8684C92'}
2025-10-18 15:46:38,168 - INFO - whatsapp_bot - Ignoring self-sent message: A585C0CDA515174D8A2A5394A8684C92
2025-10-18 15:46:38,168 - INFO - werkzeug - 127.0.0.1 - - [18/Oct/2025 15:46:38] "POST /webhook HTTP/1.1" 200 -
2025-10-18 15:46:46,526 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-18 15:46:46,527 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': '3EB0E55AF2E1BD4C9E76A9', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1760813181, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'conversation': 'Mas hoje  sbado', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'I2W5c9dl+MEyqodHcHXY9a6JQGJMPjlHrmDYVg5mQPA='}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB0E55AF2E1BD4C9E76A9'}}, 'timestamp': 1760813181542}
2025-10-18 15:46:46,527 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-18 15:46:46,527 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-18 15:46:46,528 - INFO - werkzeug - 127.0.0.1 - - [18/Oct/2025 15:46:46] "POST /webhook HTTP/1.1" 200 -
2025-10-18 15:46:46,543 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-18 15:46:46,543 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': '3EB0E55AF2E1BD4C9E76A9', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1760813181, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'conversation': 'Mas hoje  sbado', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'I2W5c9dl+MEyqodHcHXY9a6JQGJMPjlHrmDYVg5mQPA='}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB0E55AF2E1BD4C9E76A9'}}, 'timestamp': 1760813181544}
2025-10-18 15:46:46,544 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '558186732159@s.whatsapp.net', 'fromMe': False, 'id': '3EB0E55AF2E1BD4C9E76A9', 'senderLid': '62337188896831@lid'}, 'messageTimestamp': 1760813181, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'conversation': 'Mas hoje  sbado', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'I2W5c9dl+MEyqodHcHXY9a6JQGJMPjlHrmDYVg5mQPA='}}, 'remoteJid': '558186732159@s.whatsapp.net', 'id': '3EB0E55AF2E1BD4C9E76A9'}
2025-10-18 15:46:46,544 - INFO - whatsapp_bot - Sender number: 558186732159@s.whatsapp.net
2025-10-18 15:46:46,544 - INFO - whatsapp_bot - Message content object: {'conversation': 'Mas hoje  sbado', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': 'v5vz3vgADxiAeA==', 'recipientTimestamp': '1760468038'}, 'deviceListMetadataVersion': 2, 'messageSecret': 'I2W5c9dl+MEyqodHcHXY9a6JQGJMPjlHrmDYVg5mQPA='}}
2025-10-18 15:46:46,544 - INFO - whatsapp_bot - Found conversation text: Mas hoje  sbado
2025-10-18 15:46:46,544 - INFO - whatsapp_bot - Safe sender ID: 558186732159_s_whatsapp_net
2025-10-18 15:46:46,545 - INFO - whatsapp_bot - Processing text message: 'Mas hoje  sbado' from 558186732159@s.whatsapp.net
2025-10-18 15:46:46,552 - INFO - whatsapp_bot - Loaded conversation history for 558186732159_s_whatsapp_net
2025-10-18 15:46:46,552 - INFO - whatsapp_bot - Using Gemini AI for response
2025-10-18 15:46:46,552 - INFO - whatsapp_bot - Sending prompt to Gemini (system persona active): Mas hoje  sbado...
2025-10-18 15:46:47,430 - INFO - whatsapp_bot - Sending 1 message chunks to 558186732159@s.whatsapp.net
2025-10-18 15:46:47,430 - INFO - whatsapp_bot - Sending chunk 1/1: Ops, tem razo! Aos sbados, funcionamos das 9h s...
2025-10-18 15:46:47,999 - INFO - whatsapp_bot - Text message sent to 558186732159@s.whatsapp.net.
2025-10-18 15:46:47,999 - INFO - whatsapp_bot - Successfully sent chunk 1 to 558186732159@s.whatsapp.net
2025-10-18 15:46:48,000 - INFO - whatsapp_bot - Saved conversation history for 558186732159_s_whatsapp_net
2025-10-18 15:46:48,000 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-18 15:46:48,000 - INFO - werkzeug - 127.0.0.1 - - [18/Oct/2025 15:46:48] "POST /webhook HTTP/1.1" 200 -
2025-10-18 15:46:49,438 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-18 15:46:49,441 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-18 15:46:49,442 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-18 15:46:49,442 - INFO - werkzeug - 127.0.0.1 - - [18/Oct/2025 15:46:49] "POST /webhook HTTP/1.1" 200 -
2025-10-18 15:46:49,842 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-18 15:46:49,850 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB074F83EBA66083062CD
2025-10-18 15:46:49,850 - INFO - werkzeug - 127.0.0.1 - - [18/Oct/2025 15:46:49] "POST /webhook HTTP/1.1" 200 -
2025-10-18 16:25:43,064 - INFO - whatsapp_bot - WaSenderAPI client initialized successfully with retry support
2025-10-18 16:25:43,064 - INFO - whatsapp_bot - Gemini API client initialized successfully
2025-10-18 16:25:43,065 - INFO - whatsapp_bot - Successfully loaded persona: Pedro
2025-10-18 16:25:43,065 - INFO - whatsapp_bot - Loaded 17 few-shot examples
2025-10-18 16:25:43,066 - INFO - whatsapp_bot - Interactive menu: Enabled
2025-10-18 16:25:43,066 - INFO - whatsapp_bot - Using persona 'Pedro' with 17 training examples
2025-10-18 16:25:43,066 - INFO - whatsapp_bot - Gemini client initialized with model: gemini-2.0-flash
2025-10-18 16:25:43,066 - INFO - whatsapp_bot - Few-shot learning: Enabled (17 examples)
2025-10-18 16:25:43,067 - INFO - whatsapp_bot - ======================================================
2025-10-18 16:25:43,067 - INFO - whatsapp_bot -   WhatsApp Gemini Chatbot Starting
2025-10-18 16:25:43,067 - INFO - whatsapp_bot - ======================================================
2025-10-18 16:25:43,067 - INFO - whatsapp_bot - Persona: Pedro
2025-10-18 16:25:43,068 - INFO - whatsapp_bot - Gemini Model: gemini-2.0-flash
2025-10-18 16:25:43,068 - INFO - whatsapp_bot - Conversations Directory: conversations
2025-10-18 16:25:43,068 - INFO - whatsapp_bot - WaSender API Client: Initialized
2025-10-18 16:25:43,068 - INFO - whatsapp_bot - Gemini API Client: Initialized
2025-10-18 16:25:43,068 - INFO - whatsapp_bot - Starting Flask server on port 5001...
2025-10-18 16:25:43,068 - INFO - whatsapp_bot - ======================================================
2025-10-18 16:25:43,075 - INFO - werkzeug - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5001
 * Running on http://192.168.68.119:5001
2025-10-18 16:25:43,075 - INFO - werkzeug - [33mPress CTRL+C to quit[0m
2025-10-18 16:27:02,994 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-18 16:27:02,995 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '120363404721021632@g.us', 'fromMe': False, 'id': '3EB05DD9C0A899955D5194', 'participant': '62337188896831@lid', 'participantPn': '558186732159@s.whatsapp.net'}, 'messageTimestamp': 1760815597, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'conversation': 'Oi', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': 'B2a4Q6+mEoRg6Q==', 'recipientTimestamp': '1760814617'}, 'deviceListMetadataVersion': 2, 'messageSecret': '/WIXQLLZkMU9puw/UzVkAQBOVCSygaXoba5jXPvgIDI='}}, 'remoteJid': '120363404721021632@g.us', 'id': '3EB05DD9C0A899955D5194'}}, 'timestamp': 1760815598046}
2025-10-18 16:27:02,995 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-18 16:27:02,995 - INFO - whatsapp_bot - Processing message info: {'key': {'remoteJid': '120363404721021632@g.us', 'fromMe': False, 'id': '3EB05DD9C0A899955D5194', 'participant': '62337188896831@lid', 'participantPn': '558186732159@s.whatsapp.net'}, 'messageTimestamp': 1760815597, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'conversation': 'Oi', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': 'B2a4Q6+mEoRg6Q==', 'recipientTimestamp': '1760814617'}, 'deviceListMetadataVersion': 2, 'messageSecret': '/WIXQLLZkMU9puw/UzVkAQBOVCSygaXoba5jXPvgIDI='}}, 'remoteJid': '120363404721021632@g.us', 'id': '3EB05DD9C0A899955D5194'}
2025-10-18 16:27:02,995 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'key': {'remoteJid': '120363404721021632@g.us', 'fromMe': False, 'id': '3EB05DD9C0A899955D5194', 'participant': '62337188896831@lid', 'participantPn': '558186732159@s.whatsapp.net'}, 'messageTimestamp': 1760815597, 'pushName': 'Pedro Henrique', 'broadcast': False, 'message': {'conversation': 'Oi', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': 'B2a4Q6+mEoRg6Q==', 'recipientTimestamp': '1760814617'}, 'deviceListMetadataVersion': 2, 'messageSecret': '/WIXQLLZkMU9puw/UzVkAQBOVCSygaXoba5jXPvgIDI='}}, 'remoteJid': '120363404721021632@g.us', 'id': '3EB05DD9C0A899955D5194'}}, 'timestamp': 1760815598045}
2025-10-18 16:27:02,996 - INFO - whatsapp_bot - Sender number: 120363404721021632@g.us
2025-10-18 16:27:02,996 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-18 16:27:02,996 - INFO - whatsapp_bot - Message content object: {'conversation': 'Oi', 'messageContextInfo': {'deviceListMetadata': {'senderKeyHash': 'G7oknoAjKO0GHQ==', 'senderTimestamp': '1760407916', 'senderAccountType': 'E2EE', 'receiverAccountType': 'E2EE', 'recipientKeyHash': 'B2a4Q6+mEoRg6Q==', 'recipientTimestamp': '1760814617'}, 'deviceListMetadataVersion': 2, 'messageSecret': '/WIXQLLZkMU9puw/UzVkAQBOVCSygaXoba5jXPvgIDI='}}
2025-10-18 16:27:02,996 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-18 16:27:02,996 - INFO - whatsapp_bot - Found conversation text: Oi
2025-10-18 16:27:02,997 - INFO - werkzeug - 127.0.0.1 - - [18/Oct/2025 16:27:02] "POST /webhook HTTP/1.1" 200 -
2025-10-18 16:27:02,997 - INFO - whatsapp_bot - Safe sender ID: 120363404721021632_g_us
2025-10-18 16:27:02,997 - INFO - whatsapp_bot - Processing text message: 'Oi' from 120363404721021632@g.us
2025-10-18 16:27:02,997 - INFO - whatsapp_bot - Loaded conversation history for 120363404721021632_g_us
2025-10-18 16:27:02,997 - INFO - whatsapp_bot - Greeting detected, showing menu to 120363404721021632@g.us
2025-10-18 16:27:02,998 - INFO - whatsapp_bot - Sending 5 message chunks to 120363404721021632@g.us
2025-10-18 16:27:03,510 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-18 16:27:03,511 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.received', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '120363404721021632@g.us', 'fromMe': False, 'id': '3EB05DD9C0A899955D5194'}, 'message': {'conversation': 'Oi'}, 'messageTimestamp': {'low': 1760815591, 'high': 0, 'unsigned': True}, 'participant': '62337188896831@lid', 'messageSecret': {'0': 253, '1': 98, '2': 23, '3': 64, '4': 178, '5': 217, '6': 144, '7': 197, '8': 61, '9': 166, '10': 236, '11': 63, '12': 83, '13': 53, '14': 100, '15': 1, '16': 0, '17': 78, '18': 84, '19': 36, '20': 178, '21': 129, '22': 165, '23': 232, '24': 109, '25': 174, '26': 99, '27': 92, '28': 251, '29': 224, '30': 32, '31': 50}, 'reportingTokenInfo': {'reportingTag': 'AQzCLKpbbfGgDb8HLfTqtQZbQz8='}, 'isMentionedInStatus': False, 'remoteJid': '120363404721021632@g.us', 'id': '3EB05DD9C0A899955D5194'}}, 'timestamp': 1760815598650}
2025-10-18 16:27:03,511 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: messages.received
2025-10-18 16:27:03,511 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-18 16:27:03,512 - INFO - werkzeug - 127.0.0.1 - - [18/Oct/2025 16:27:03] "POST /webhook HTTP/1.1" 200 -
2025-10-18 16:27:03,557 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-18 16:27:03,558 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '120363404721021632@g.us', 'fromMe': False, 'id': '3EB05DD9C0A899955D5194'}, 'message': {'conversation': 'Oi'}, 'messageTimestamp': {'low': 1760815591, 'high': 0, 'unsigned': True}, 'participant': '62337188896831@lid', 'messageSecret': {'0': 253, '1': 98, '2': 23, '3': 64, '4': 178, '5': 217, '6': 144, '7': 197, '8': 61, '9': 166, '10': 236, '11': 63, '12': 83, '13': 53, '14': 100, '15': 1, '16': 0, '17': 78, '18': 84, '19': 36, '20': 178, '21': 129, '22': 165, '23': 232, '24': 109, '25': 174, '26': 99, '27': 92, '28': 251, '29': 224, '30': 32, '31': 50}, 'reportingTokenInfo': {'reportingTag': 'AQzCLKpbbfGgDb8HLfTqtQZbQz8='}, 'isMentionedInStatus': False, 'remoteJid': '120363404721021632@g.us', 'id': '3EB05DD9C0A899955D5194'}}, 'timestamp': 1760815598652}
2025-10-18 16:27:03,558 - INFO - whatsapp_bot - Processing message info: {'messageStubParameters': [], 'labels': [], 'userReceipt': [], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '120363404721021632@g.us', 'fromMe': False, 'id': '3EB05DD9C0A899955D5194'}, 'message': {'conversation': 'Oi'}, 'messageTimestamp': {'low': 1760815591, 'high': 0, 'unsigned': True}, 'participant': '62337188896831@lid', 'messageSecret': {'0': 253, '1': 98, '2': 23, '3': 64, '4': 178, '5': 217, '6': 144, '7': 197, '8': 61, '9': 166, '10': 236, '11': 63, '12': 83, '13': 53, '14': 100, '15': 1, '16': 0, '17': 78, '18': 84, '19': 36, '20': 178, '21': 129, '22': 165, '23': 232, '24': 109, '25': 174, '26': 99, '27': 92, '28': 251, '29': 224, '30': 32, '31': 50}, 'reportingTokenInfo': {'reportingTag': 'AQzCLKpbbfGgDb8HLfTqtQZbQz8='}, 'isMentionedInStatus': False, 'remoteJid': '120363404721021632@g.us', 'id': '3EB05DD9C0A899955D5194'}
2025-10-18 16:27:03,558 - INFO - whatsapp_bot - Sender number: 120363404721021632@g.us
2025-10-18 16:27:03,559 - INFO - whatsapp_bot - Message content object: {'conversation': 'Oi'}
2025-10-18 16:27:03,559 - INFO - whatsapp_bot - Found conversation text: Oi
2025-10-18 16:27:03,559 - INFO - whatsapp_bot - Safe sender ID: 120363404721021632_g_us
2025-10-18 16:27:03,559 - INFO - whatsapp_bot - Processing text message: 'Oi' from 120363404721021632@g.us
2025-10-18 16:27:03,559 - INFO - whatsapp_bot - Loaded conversation history for 120363404721021632_g_us
2025-10-18 16:27:03,559 - INFO - whatsapp_bot - Greeting detected, showing menu to 120363404721021632@g.us
2025-10-18 16:27:03,559 - INFO - whatsapp_bot - Sending 5 message chunks to 120363404721021632@g.us
2025-10-18 16:27:03,650 - INFO - whatsapp_bot - Text message sent to 120363404721021632@g.us.
2025-10-18 16:27:03,650 - INFO - whatsapp_bot - Successfully sent chunk 1 to 120363404721021632@g.us
2025-10-18 16:27:03,650 - INFO - whatsapp_bot - Waiting 6.9 seconds before next chunk...
2025-10-18 16:27:06,431 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-18 16:27:06,434 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-18 16:27:06,434 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-18 16:27:06,435 - INFO - werkzeug - 127.0.0.1 - - [18/Oct/2025 16:27:06] "POST /webhook HTTP/1.1" 200 -
2025-10-18 16:27:06,943 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-18 16:27:06,951 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB01438F7684F76C762CB
2025-10-18 16:27:06,951 - INFO - werkzeug - 127.0.0.1 - - [18/Oct/2025 16:27:06] "POST /webhook HTTP/1.1" 200 -
2025-10-18 16:27:08,700 - INFO - whatsapp_bot - Text message sent to 120363404721021632@g.us.
2025-10-18 16:27:08,700 - INFO - whatsapp_bot - Successfully sent chunk 1 to 120363404721021632@g.us
2025-10-18 16:27:08,700 - INFO - whatsapp_bot - Waiting 5.6 seconds before next chunk...
2025-10-18 16:27:10,537 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-18 16:27:10,541 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-18 16:27:10,541 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-18 16:27:10,541 - INFO - werkzeug - 127.0.0.1 - - [18/Oct/2025 16:27:10] "POST /webhook HTTP/1.1" 200 -
2025-10-18 16:27:10,596 - INFO - whatsapp_bot - Sending chunk 2/5: 
*Escolha uma opo:*
...
2025-10-18 16:27:11,043 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-18 16:27:11,050 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB068956119E9C9835B2C
2025-10-18 16:27:11,051 - INFO - werkzeug - 127.0.0.1 - - [18/Oct/2025 16:27:11] "POST /webhook HTTP/1.1" 200 -
2025-10-18 16:27:13,746 - INFO - whatsapp_bot - Text message sent to 120363404721021632@g.us.
2025-10-18 16:27:13,746 - INFO - whatsapp_bot - Successfully sent chunk 2 to 120363404721021632@g.us
2025-10-18 16:27:13,746 - INFO - whatsapp_bot - Waiting 6.9 seconds before next chunk...
2025-10-18 16:27:14,260 - INFO - whatsapp_bot - Sending chunk 2/5: 
*Escolha uma opo:*
...
2025-10-18 16:27:15,546 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-18 16:27:15,546 - INFO - whatsapp_bot - Received webhook data: {'event': 'message.sent', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'jid': '120363404721021632@g.us', 'msgId': 7507332, 'success': True, 'result': {'key': {'remoteJid': '120363404721021632@g.us', 'fromMe': True, 'id': '3EB02C3C7D89D6B3C3069C'}, 'message': {'extendedTextMessage': {'text': '*Escolha uma opo:*'}}, 'messageTimestamp': '1760815610', 'status': 'PENDING', 'participant': '558187232588:25@s.whatsapp.net'}}, 'timestamp': 1760815610690}
2025-10-18 16:27:15,546 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-18 16:27:15,546 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-18 16:27:15,546 - INFO - werkzeug - 127.0.0.1 - - [18/Oct/2025 16:27:15] "POST /webhook HTTP/1.1" 200 -
2025-10-18 16:27:16,064 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-18 16:27:16,064 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'messageStubParameters': [], 'labels': [], 'userReceipt': [{'userJid': '138392453009566@lid', 'readTimestamp': 1760815611}], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '120363404721021632@g.us', 'fromMe': True, 'id': '3EB02C3C7D89D6B3C3069C', 'msgId': 7507332}, 'message': {'extendedTextMessage': {'text': '*Escolha uma opo:*'}}, 'messageTimestamp': {'low': 1760815610, 'high': 0, 'unsigned': True}, 'status': 1, 'participant': '558187232588:25@s.whatsapp.net', 'remoteJid': '120363404721021632@g.us', 'id': '3EB02C3C7D89D6B3C3069C'}}, 'timestamp': 1760815611206}
2025-10-18 16:27:16,064 - INFO - whatsapp_bot - Processing message info: {'messageStubParameters': [], 'labels': [], 'userReceipt': [{'userJid': '138392453009566@lid', 'readTimestamp': 1760815611}], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '120363404721021632@g.us', 'fromMe': True, 'id': '3EB02C3C7D89D6B3C3069C', 'msgId': 7507332}, 'message': {'extendedTextMessage': {'text': '*Escolha uma opo:*'}}, 'messageTimestamp': {'low': 1760815610, 'high': 0, 'unsigned': True}, 'status': 1, 'participant': '558187232588:25@s.whatsapp.net', 'remoteJid': '120363404721021632@g.us', 'id': '3EB02C3C7D89D6B3C3069C'}
2025-10-18 16:27:16,064 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB02C3C7D89D6B3C3069C
2025-10-18 16:27:16,064 - INFO - werkzeug - 127.0.0.1 - - [18/Oct/2025 16:27:16] "POST /webhook HTTP/1.1" 200 -
2025-10-18 16:27:19,406 - INFO - whatsapp_bot - Text message sent to 120363404721021632@g.us.
2025-10-18 16:27:19,406 - INFO - whatsapp_bot - Successfully sent chunk 2 to 120363404721021632@g.us
2025-10-18 16:27:19,406 - INFO - whatsapp_bot - Waiting 6.5 seconds before next chunk...
2025-10-18 16:27:21,151 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-18 16:27:21,151 - INFO - whatsapp_bot - Received webhook data: {'event': 'message.sent', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'jid': '120363404721021632@g.us', 'msgId': 7507349, 'success': True, 'result': {'key': {'remoteJid': '120363404721021632@g.us', 'fromMe': True, 'id': '3EB0679704287396D6C9A7'}, 'message': {'extendedTextMessage': {'text': '*Escolha uma opo:*'}}, 'messageTimestamp': '1760815616', 'status': 'PENDING', 'participant': '558187232588:25@s.whatsapp.net'}}, 'timestamp': 1760815616288}
2025-10-18 16:27:21,152 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-18 16:27:21,152 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-18 16:27:21,152 - INFO - werkzeug - 127.0.0.1 - - [18/Oct/2025 16:27:21] "POST /webhook HTTP/1.1" 200 -
2025-10-18 16:27:21,633 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-18 16:27:21,633 - INFO - whatsapp_bot - Received webhook data: {'event': 'messages.upsert', 'sessionId': '808842e8a437883a22839d496f152d54442c4ead4df38c10365484483f249662', 'data': {'messages': {'messageStubParameters': [], 'labels': [], 'userReceipt': [{'userJid': '138392453009566@lid', 'readTimestamp': 1760815616}], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '120363404721021632@g.us', 'fromMe': True, 'id': '3EB0679704287396D6C9A7', 'msgId': 7507349}, 'message': {'extendedTextMessage': {'text': '*Escolha uma opo:*'}}, 'messageTimestamp': {'low': 1760815616, 'high': 0, 'unsigned': True}, 'status': 1, 'participant': '558187232588:25@s.whatsapp.net', 'remoteJid': '120363404721021632@g.us', 'id': '3EB0679704287396D6C9A7'}}, 'timestamp': 1760815616777}
2025-10-18 16:27:21,633 - INFO - whatsapp_bot - Processing message info: {'messageStubParameters': [], 'labels': [], 'userReceipt': [{'userJid': '138392453009566@lid', 'readTimestamp': 1760815616}], 'reactions': [], 'pollUpdates': [], 'eventResponses': [], 'statusMentions': [], 'messageAddOns': [], 'statusMentionSources': [], 'supportAiCitations': [], 'key': {'remoteJid': '120363404721021632@g.us', 'fromMe': True, 'id': '3EB0679704287396D6C9A7', 'msgId': 7507349}, 'message': {'extendedTextMessage': {'text': '*Escolha uma opo:*'}}, 'messageTimestamp': {'low': 1760815616, 'high': 0, 'unsigned': True}, 'status': 1, 'participant': '558187232588:25@s.whatsapp.net', 'remoteJid': '120363404721021632@g.us', 'id': '3EB0679704287396D6C9A7'}
2025-10-18 16:27:21,633 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB0679704287396D6C9A7
2025-10-18 16:27:21,634 - INFO - werkzeug - 127.0.0.1 - - [18/Oct/2025 16:27:21] "POST /webhook HTTP/1.1" 200 -
2025-10-18 16:27:24,855 - INFO - whatsapp_bot - Text message sent to 120363404721021632@g.us.
2025-10-18 16:27:24,855 - INFO - whatsapp_bot - Successfully sent chunk 3 to 120363404721021632@g.us
2025-10-18 16:27:24,855 - INFO - whatsapp_bot - Waiting 6.4 seconds before next chunk...
2025-10-18 16:27:26,481 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-18 16:27:26,484 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-18 16:27:26,484 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-18 16:27:26,485 - INFO - werkzeug - 127.0.0.1 - - [18/Oct/2025 16:27:26] "POST /webhook HTTP/1.1" 200 -
2025-10-18 16:27:26,999 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-18 16:27:27,006 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB0932BC882B654B51619
2025-10-18 16:27:27,006 - INFO - werkzeug - 127.0.0.1 - - [18/Oct/2025 16:27:27] "POST /webhook HTTP/1.1" 200 -
2025-10-18 16:27:31,099 - INFO - whatsapp_bot - Text message sent to 120363404721021632@g.us.
2025-10-18 16:27:31,099 - INFO - whatsapp_bot - Successfully sent chunk 3 to 120363404721021632@g.us
2025-10-18 16:27:31,099 - INFO - whatsapp_bot - Waiting 5.6 seconds before next chunk...
2025-10-18 16:27:32,520 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-18 16:27:32,524 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-18 16:27:32,524 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-18 16:27:32,524 - INFO - werkzeug - 127.0.0.1 - - [18/Oct/2025 16:27:32] "POST /webhook HTTP/1.1" 200 -
2025-10-18 16:27:32,975 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-18 16:27:32,986 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB05A9EE2C9A9F85C7CC3
2025-10-18 16:27:32,987 - INFO - werkzeug - 127.0.0.1 - - [18/Oct/2025 16:27:32] "POST /webhook HTTP/1.1" 200 -
2025-10-18 16:27:36,418 - INFO - whatsapp_bot - Text message sent to 120363404721021632@g.us.
2025-10-18 16:27:36,419 - INFO - whatsapp_bot - Successfully sent chunk 4 to 120363404721021632@g.us
2025-10-18 16:27:36,419 - INFO - whatsapp_bot - Waiting 6.2 seconds before next chunk...
2025-10-18 16:27:38,031 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-18 16:27:38,034 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-18 16:27:38,034 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-18 16:27:38,034 - INFO - werkzeug - 127.0.0.1 - - [18/Oct/2025 16:27:38] "POST /webhook HTTP/1.1" 200 -
2025-10-18 16:27:38,547 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-18 16:27:38,553 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB082124F938C4B7B4DCE
2025-10-18 16:27:38,553 - INFO - werkzeug - 127.0.0.1 - - [18/Oct/2025 16:27:38] "POST /webhook HTTP/1.1" 200 -
2025-10-18 16:27:41,948 - INFO - whatsapp_bot - Text message sent to 120363404721021632@g.us.
2025-10-18 16:27:41,948 - INFO - whatsapp_bot - Successfully sent chunk 4 to 120363404721021632@g.us
2025-10-18 16:27:41,948 - INFO - whatsapp_bot - Waiting 6.2 seconds before next chunk...
2025-10-18 16:27:43,660 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-18 16:27:43,663 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-18 16:27:43,664 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-18 16:27:43,664 - INFO - werkzeug - 127.0.0.1 - - [18/Oct/2025 16:27:43] "POST /webhook HTTP/1.1" 200 -
2025-10-18 16:27:44,163 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-18 16:27:44,170 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB024D7CEF2A52EEF2B27
2025-10-18 16:27:44,170 - INFO - werkzeug - 127.0.0.1 - - [18/Oct/2025 16:27:44] "POST /webhook HTTP/1.1" 200 -
2025-10-18 16:27:47,833 - INFO - whatsapp_bot - Text message sent to 120363404721021632@g.us.
2025-10-18 16:27:47,834 - INFO - whatsapp_bot - Successfully sent chunk 5 to 120363404721021632@g.us
2025-10-18 16:27:47,834 - INFO - whatsapp_bot - Saved conversation history for 120363404721021632_g_us
2025-10-18 16:27:47,835 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-18 16:27:47,835 - INFO - werkzeug - 127.0.0.1 - - [18/Oct/2025 16:27:47] "POST /webhook HTTP/1.1" 200 -
2025-10-18 16:27:50,085 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-18 16:27:50,088 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-18 16:27:50,088 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-18 16:27:50,088 - INFO - werkzeug - 127.0.0.1 - - [18/Oct/2025 16:27:50] "POST /webhook HTTP/1.1" 200 -
2025-10-18 16:27:50,622 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-18 16:27:50,630 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB039D873FA90C5E8B047
2025-10-18 16:27:50,630 - INFO - werkzeug - 127.0.0.1 - - [18/Oct/2025 16:27:50] "POST /webhook HTTP/1.1" 200 -
2025-10-18 16:27:54,453 - INFO - whatsapp_bot - Text message sent to 120363404721021632@g.us.
2025-10-18 16:27:54,453 - INFO - whatsapp_bot - Successfully sent chunk 5 to 120363404721021632@g.us
2025-10-18 16:27:54,461 - INFO - whatsapp_bot - Saved conversation history for 120363404721021632_g_us
2025-10-18 16:27:54,461 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-18 16:27:54,461 - INFO - werkzeug - 127.0.0.1 - - [18/Oct/2025 16:27:54] "POST /webhook HTTP/1.1" 200 -
2025-10-18 16:27:55,370 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-18 16:27:55,373 - WARNING - whatsapp_bot - Webhook data doesn't match expected format. Event: message.sent
2025-10-18 16:27:55,373 - INFO - whatsapp_bot - === WEBHOOK PROCESSING COMPLETE ===
2025-10-18 16:27:55,374 - INFO - werkzeug - 127.0.0.1 - - [18/Oct/2025 16:27:55] "POST /webhook HTTP/1.1" 200 -
2025-10-18 16:27:55,871 - INFO - whatsapp_bot - === WEBHOOK CALLED ===
2025-10-18 16:27:55,878 - INFO - whatsapp_bot - Ignoring self-sent message: 3EB093BAA4DA8507FA8513
2025-10-18 16:27:55,878 - INFO - werkzeug - 127.0.0.1 - - [18/Oct/2025 16:27:55] "POST /webhook HTTP/1.1" 200 -
